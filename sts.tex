\subsection{Взаимная аутентификация схемой ЭП}
\selectlanguage{russian}

\emph{Протокол STS (Station-to-Station)}\index{протокол!Station-to-Station} предназначен для систем мобильной связи. Он использует идеи протокола Диффи~---~Хеллмана\index{протокол!Диффи~---~Хеллмана} и криптосистемы RSA\index{криптосистема!RSA}. Особенностью протокола является использование механизма электронной подписи\index{электронная подпись} для взаимной аутентификации сторон\index{аутентификация!взаимная}.

Здесь открытые общедоступные данные:
    \[ p, ~ g, ~ \PK_A, ~ \PK_B. \]

Каждая из сторон $A$ и $B$ обладает долговременной парой ключей: закрытым ключом для создания электронной подписи $\SK$ и открытым ключом для проверки подписи $\PK$:
\[ \begin{array}{ll}
    A: & ~ \SK_A, ~~ \PK_A, \\
    B: & ~ \SK_B, ~~ \PK_B. \\
\end{array} \]

Протокол состоит из трёх раундов обмена информацией между сторонами $A$ и $B$.
\begin{enumerate}
    \item Сторона $A$ создаёт секретное случайное число $2 \leq x \leq p-1$ и отправляет $B$:
            \[ A \rightarrow B: ~ g^x \mod p. \]
    \item Сторона $B$ создаёт секретное случайное число $2 \leq y \leq p-1$, вычисляет общий секретный ключ:
            \[ K = (g^x)^y = g^{xy} \mod p, \]
        с помощью которого создаёт шифрованное сообщение $E_K(S_B(g^x, g^y))$ для аутентификации, и отправляет $A$:
            \[ A \leftarrow B: ~ \left( g^y \mod p, ~~ E_K( S_B( g^x, g^y)) \right). \]
    \item Сторона $A$ с помощью $x, g^y \mod p$ вычисляет общий секретный ключ:
            \[ K = (g^y)^x \mod p = g^{xy} \mod p \]
        и расшифровывает сообщение:
            \[ D_K( E_K( S_B( g^x, g^y))) = S_B( g^x, g^y). \]
            Затем аутентифицирует сторону $B$, проверяя подпись $S_B$ открытым ключом $\PK_B$. Вычисляет и пересылает стороне $B$ сообщение:
            \[ A \rightarrow B: ~ E_K( S_A( g^x, g^y)). \]
    \item Сторона $B$ расшифровывает принятое сообщение:
            \[ D_K( E_K( S_A( g^x, g^y))) = S_A( g^x, g^y) \]
        и осуществляет аутентификацию, выполняя проверку подписи $S_A$ с помощью открытого ключа $\PK_A$.
\end{enumerate}
