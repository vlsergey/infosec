\subsection{Взаимная аутентификации схемой ЭЦП}
\selectlanguage{russian}

\textbf{Протокол STS (Station-To-Station)}\index{протокол!Station-To-Station} предназначен для систем мобильной связи. Он использует идеи протокола Диффи--Хеллмана и идеи системы RSA.

Здесь открытые общедоступные данные
    \[ p, ~ g, ~ \PK_A, ~ \PK_B. \]
Каждая из сторон $A$ и $B$ обладает долговременной парой ключей: секретным ключом подписания $\SK$ и открытым ключом проверки подписи $\PK$ для \emph{схемы ЭЦП}.
\[ \begin{array}{ll}
    A: & ~ \SK_A, ~~ \PK_A, \\
    B: & ~ \SK_B, ~~ \PK_B. \\
\end{array} \]
Подписи к сообщению $m$ сторон $A$ и $B$ имеют вид:
\[ \begin{array}{ll}
    A: & ~ S_A(m) = \textrm{ЭЦП}_{\SK_A}(H(m)), \\
    B: & ~ S_B(m) = \textrm{ЭЦП}_{\SK_B}(H(m)), \\
\end{array} \]
$H(m)$ -- криптографическая хэш-функция от сообщения $m$.

Протокол состоит из трех раундов обмена информацией между сторонами $A$ и $B$.
\begin{enumerate}
    \item Сторона $A$ создает секретное случайное число $2 \leq x \leq p-1$ и отправляет $B$:
            \[ A \rightarrow B: ~ g^x \mod p. \]
    \item Сторона $B$ создает секретное случайное число $2 \leq y \leq p-1$, вычисляет общий секретный ключ
            \[ K = (g^x)^y = g^{xy} \mod p, \]
        с помощью которого создает шифрованное сообщение $E_K(S_B(g^x, g^y))$ для аутентификации и отправляет $A$:
            \[ A \leftarrow B: ~ \left( g^y \mod p, ~~ E_K( S_B( g^x, g^y)) \right). \]
    \item Сторона $A$ с помощью $x, g^y \mod p$ вычисляет общий секретный ключ
            \[ K = (g^y)^x \mod p = g^{xy} \mod p \]
        и расшифровывает сообщение
            \[ D_K( E_K( S_B( g^x, g^y))) = S_B( g^x, g^y). \]
            Затем аутентифицирует сторону $B$, проверяя подпись $S_B$ открытым ключом $\PK_B$. Вычисляет и пересылает стороне $B$ сообщение:
            \[ A \rightarrow B: ~ E_K( S_A( g^x, g^y)). \]
    \item Сторона $B$ расшифровывает принятое сообщение
            \[ D_K( E_K( S_A( g^x, g^y))) = S_A( g^x, g^y) \]
        и осуществляет аутентификацию, выполняя проверку подписи $S_A$ с помощью открытого ключа $\PK_A$.
\end{enumerate}
