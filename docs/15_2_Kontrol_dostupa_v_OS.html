<!DOCTYPE html SYSTEM "about:legacy-compat">
<html><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><style type="text/css"> 
div.toc-item-h2 {
  padding-left: 2em;
}
div.toc-item-h3 {
  padding-left: 4em;
}
div.toc-item-h4 {
  padding-left: 6em;
}
div.toc-item-h5 {
  padding-left: 8em;
}
div.toc-item-h6 {
  padding-left: 10em;
}
</style><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" rel="stylesheet"><style type="text/css"> 
span.small {
  font-size: 90%
}
span.tiny {
  font-size: 50%
}
</style><style type="text/css"> 
div.mathjax {
  padding-top: .5em;
  padding-bottom: .5em;
}
</style></head><body><div class="container"><h2 data-command-name="section" id="15_2_Контроль_доступа_в_ОС">15.2. Контроль доступа в ОС</h2><h3 data-command-name="subsection" id="15_2_1_Windows">15.2.1. Windows</h3><!--%http://www.gentlesecurity.com/blog/andr/cracking_windows_access_control.pdf--><!--%http://msdn.microsoft.com/en-us/library/bb250462(VS.85).aspx#upm_ovwim--><!--%http://msdn.microsoft.com/en-us/library/bb625963.aspx--><!--%http://msdn.microsoft.com/en-us/library/bb625964.aspx--><p>Операционные системы Windows, вплоть до Windows Vista, использовали только дискреционную модель безопасности. Владелец файла имел возможность изменить права доступа или разрешить доступ другому пользователю.</p><p>Начиная с Windows Vista, в дополнение к стандартной дискреционной модели субъекты и объекты стали обладать мандатным уровнем доступа, устанавливаемым администратором (или по умолчанию системой для новых созданных объектов) и имеющим приоритет над стандартным дискреционным доступом, который может менять владелец.</p><p>В Vista мандатный уровень доступа предназначен в большей степени для обеспечения <em>целостности</em> и устойчивости системы, чем для обеспечения секретности.</p><p>Уровень доступа объекта (англ. <span lang="en"><i>integrity level</i></span> в терминологии Windows) помечается шестнадцатеричным числом в диапазоне от <tt>0</tt> до <tt>0x4000</tt>, большее число означает более высокий уровень доступа. В Vista определены 5 базовых уровней:</p><ul><li>ненадёжный (Untrusted, <tt>0x0000</tt>);</li><li>низкий (Low Integrity, <tt>0x1000</tt>);</li><li>средний (Medium Integrity, <tt>0x2000</tt>);</li><li>высокий (High Integrity, <tt>0x3000</tt>);</li><li>системный (System Integrity, <tt>0x4000</tt>).</li></ul><p>Дополнительно объекты имеют три атрибута, которые, если они установлены, запрещают доступ субъектов с более низким уровнем доступа к ним: cубъекты с более низким уровнем доступа не могут:</p><ul><li>читать (англ. <span lang="en"><i>no read-up</i></span>);</li><li>изменять (англ. <span lang="en"><i>no write-up</i></span>);</li><li>исполнять (англ. <span lang="en"><i>no execute-up</i></span>).</li></ul><p>объекты с более высоким уровнем доступа. Для всех объектов по умолчанию установлен атрибут запрета записи объектов с более высоким уровнем доступа, чем имеет субъект (no write-up).</p><p>Субъекты имеют два атрибута:</p><ul><li>запрет записи объектов с более высоким уровнем доступа, чем у субъекта (no write-up, эквивалентно аналогичному атрибуту объекта);</li><li>установка уровня доступа созданного процесса-потомка как минимума от уровня доступа родительского процесса (субъекта) и исполняемого файла (объекта файловой системы).</li></ul><p>Оба атрибута установлены по умолчанию.</p><p>Все пользовательские данные и процессы по умолчанию имеют средний уровень доступа, а системные файлы &ndash; системный. Например, если в Internet Explorer, который в защищённом (англ. <span lang="en"><i>protected</i></span>) режиме запускается с низким уровнем доступа, обнаружится уязвимость, злоумышленник не будет иметь возможности изменить системные данные на диске, даже если браузер запущен администратором.</p><p>Уровень доступа процесса соответствует уровню доступа пользователя (процесса), который запустил процесс. Например, пользователи LocalSystem, LocalService, NetworkService получают системный уровень, администраторы &ndash; высокий, обычные пользователи системы &ndash; средний, остальные (англ. <span lang="en"><i>everyone</i></span>) &ndash; низкий.</p><p>По каким-то причинам, вероятно, для целей совместимости с ранее разработанными программами и/или для упрощения разработки и настройки новых сторонних программ других производителей, субъекты с системным, высоким и средним уровнями доступа создают объекты или владеют объектами со <em>средним</em> уровнем доступа. И только субъекты с низким уровнем доступа создают объекты с низким уровнем доступа. Это означает, что системный процесс может владеть файлом или создать файл со средним уровнем доступа, и другой процесс с более низким уровнем доступа, например средним, может получить доступ к файлу, в том числе и на запись. Это нарушает принцип запрета записи в объекты, созданные субъектами с более высоким уровнем доступа.</p><h3 data-command-name="subsection" id="15_2_2_Linux">15.2.2. Linux</h3><p>Стандартная ОС Unix обеспечивает дискреционную модель контроля доступа на следующей основе.</p><ul><li>Каждый субъект (процесс) и объект (файл) имеют владельца, пользователя и группу, которые могут изменять доступ к данному объекту для себя, других пользователей и групп.</li><li>Каждый объект (файл) имеет атрибуты доступа на чтение (r), запись (w) и исполнение (x) для трёх типов пользователей: владельца-пользователя (u), владельца-группы (g), остальных пользователей (o) &ndash; (u=rwx, g=rwx, o=rwx).</li><li>Субъект может входить в несколько групп.</li></ul><p>В 2000 г. Агентство Национальной Безопасности США (NSA) выпустило набор изменений SELinux с открытым исходным кодом к ядру ОС Linux версии 2.4. Начиная с версии ядра 2.6, SELinux входит как часть стандартного ядра. SELinux реализует комбинацию ролевой, мандатной и дискреционной моделей контроля доступа, которые могут быть изменены только администратором системы (и/или администратором безопасности). По сути, SELinux приписывает каждому субъекту одну или несколько ролей, и для каждой роли указано, к объектам с какими атрибутами они могут иметь доступ и какого вида.</p><p>Основная проблема ролевых систем контроля доступа &ndash; очень большой список описания ролей и атрибутов объектов, что увеличивает сложность системы и приводит к регулярным ошибкам в таблицах описания контроля доступа.</p><nav aria-label="Page navigation example"><ul class="pagination justify-content-center"><li class="page-item"><a class="page-link" href="Glava_15_Programmnie_ujazvimosti.html">&#129080; Glava_15_Programmnie_ujazvimosti</a></li><li class="page-item"><a class="page-link" href="15_3_Vidi_programmnih_ujazvimostey.html">15_3_Vidi_programmnih_ujazvimostey &#129082;</a></li></ul></nav></div><script>
window.MathJax = {
  loader: {
    load: ['[tex]/tagformat'],
  },
  options: {
    processHtmlClass: 'mathjax'
  },
  tex: {
    packages: {
      '[+]': ['base', 'ams', 'physics', 'textcomp']
    },
    inlineMath: [['$', '$']],
  },
};
</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script async="yes" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></body></html>