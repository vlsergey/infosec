<!DOCTYPE html SYSTEM "about:legacy-compat">
<html><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><style type="text/css"> 
div.toc-item-h2 {
  padding-left: 2em;
}
div.toc-item-h3 {
  padding-left: 4em;
}
div.toc-item-h4 {
  padding-left: 6em;
}
div.toc-item-h5 {
  padding-left: 8em;
}
div.toc-item-h6 {
  padding-left: 10em;
}
</style><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" rel="stylesheet"><style type="text/css"> 
span.small {
  font-size: 90%
}
span.tiny {
  font-size: 50%
}
</style><style type="text/css"> 
div.mathjax {
  padding-top: .5em;
  padding-bottom: .5em;
}
</style></head><body><div class="container"><h2 data-command-name="section" id="14_2_Энтропия_и_криптостойкость_паролей">14.2. Энтропия и криптостойкость <command name="protect"></command><line-break></line-break> паролей</h2><p>Стандартный набор символов паролей, которые можно набрать на клавиатуре, используя английские буквы и небуквенные символы, состоит из <span class="mathjax">$D=94$</span> символов. При длине пароля <span class="mathjax">$L$</span> символов и предположении равновероятного использования символов энтропия паролей равна</p><div class="mathjax" style="text-align: center;">$$ H = L \log_2 D. $$</div><p>Клод Шеннон (англ. <span lang="en"><i>Claude Elwood Shannon</i></span>), исследуя энтропию символов английского текста, изучал вероятность успешного предсказания людьми следующего символа по первым нескольким символам слов или текста. В результате Шеннон получил оценку энтропии первого символа <span class="mathjax">$s_1$</span> текста порядка <span class="mathjax">$H(s_1) \approx 4{,}6$</span>&ndash;<span class="mathjax">$4{,}7$</span> бит/символ и оценки энтропий последующих символов, постепенно уменьшающиеся до <span class="mathjax">$H(s_9) \approx 1{,}5$</span> бит/символ для 9-го символа. Энтропия для длинных текстов художественных произведений получила оценку <span class="mathjax">$H(s_\infty) \approx 0{,}4$</span> бит/символ.</p><p>Статистические исследования баз паролей показывают, что в англоязычных текстах наиболее часто используются буквы &laquo;a&raquo;, &laquo;e&raquo;, &laquo;o&raquo;, &laquo;r&raquo; и цифра &laquo;1&raquo;.</p><p>NIST (Национальный институт стандартов и технологий США, англ. <span lang="en"><i>National Institute of Standards and Technology</i></span>)  использует следующие рекомендации для оценки энтропии паролей<a name="N108601"><!--энтропия!пароля--></a>, создаваемых людьми.</p><ol><li>Энтропия первого символа <span class="mathjax">$H(s_1) = 4$</span> бит/символ.</li><li>Энтропия со 2-го по 8-й символы <span class="mathjax">$H(s_{i}) = 2$</span> бит/символ, <span class="mathjax">$2 \leq i \leq 8$</span>.</li><li>Энтропия с 9-го по 20-й символы <span class="mathjax">$H(s_{i}) = 1{,}5$</span> бит/символ, <span class="mathjax">$9 \leq i \leq 20$</span>.</li><li>Энтропия с 21-го символа <span class="mathjax">$H(s_{i}) = 1$</span> бит/символ, <span class="mathjax">$i \geq 21$</span>.</li><li>Проверка композиции на использование символов разных регистров и небуквенных символов добавляет до 6-ти бит энтропии пароля.</li><li>Словарная проверка на слова и часто используемые пароли добавляет до 6 бит энтропии для коротких паролей. Для 20-символьных и более длинных паролей прибавка к энтропии &ndash; 0 бит.</li></ol><p>Для оценки энтропии пароля нужно сложить энтропии символов <span class="mathjax">$H(s_i)$</span> и сделать дополнительные надбавки, если пароль удовлетворяет тестам на композицию и отсутствует в словаре.</p><figure style="margin-left: auto; margin-right: auto; display: flex; flex-wrap: wrap; align-items: baseline; justify-content: center; width: fit-content; height: fit-content; "><command name="renewcommand"><argument required="true"><command name="arraystretch"></command></argument><argument required="true">1.25</argument></command><table style="border-collapse: collapse;"><colgroup><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"></colgroup><tr style="border-top: solid thin;"><td rowspan="2" style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="parbox"><argument required="true">1.5cm</argument><argument required="true"><command name="medskip"></command><command name="medskip"></command><command name="medskip"></command><command name="centering"><argument required="true"><command name="footnotesize"></command>Длина пароля, символы</argument></command></argument></command></td><td colspan="3" style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="parbox"><argument required="true">4.5cm</argument><argument required="true"><command name="medskip"></command><command name="centering"><argument required="true"><command name="footnotesize"></command>Энтропия паролей пользователей по критериям NIST</argument></command></argument></command></td><td rowspan="2" style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="parbox"><argument required="true">2cm</argument><argument required="true"><command name="centering"><argument required="true"><command name="footnotesize"></command><command name="medskip"></command><command name="medskip"></command>Энтропия случайных равновероятных паролей</argument></command></argument></command></td></tr><tr style="border-bottom: solid thin;"></tr><tr style="border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">&nbsp;</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="parbox"><argument required="true">1.5cm</argument><argument required="true"><command name="centering"><argument required="true"><command name="footnotesize"></command><command name="medskip"></command><command name="medskip"></command>Без проверок</argument></command></argument></command></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="parbox"><argument required="true">1.5cm</argument><argument required="true"><command name="centering"><argument required="true"><command name="footnotesize"></command><command name="medskip"></command><command name="medskip"></command>Словарная проверка</argument></command></argument></command></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="parbox"><argument required="true">1.5cm</argument><argument required="true"><command name="centering"><argument required="true"><span class="tiny"></span><command name="medskip"></command>Словарная и композиционная проверка</argument></command></argument></command></td></tr><tr style="border-bottom: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4ex</td></tr><tr style="border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">10</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">14</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">16</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">26.3</td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">6</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">14</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">20</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">23</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">39.5</td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">8</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">18</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">24</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">30</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">52.7</td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">10</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">21</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">26</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">32</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">65.9</td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">12</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">24</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">28</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">34</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">79.0</td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">16</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">30</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">32</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">38</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">105.4</td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">20</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">36</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">36</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">42</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">131.7</td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">24</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">40</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">40</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">46</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">158.0</td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">30</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">46</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">46</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">52</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">197.2</td></tr><tr style="border-bottom: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">40</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">56</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">56</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">62</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">263.4</td></tr></table><figcaption style="flex-basis: 100%; text-align: center;">Таблица 14.1 &mdash; Оценка NIST предполагаемой энтропии паролей<a name="#tab:password-entropy"></a></figcaption></figure><p>В таблице<span class="nonbreaking-interword-space"> </span><a href="#tab:password-entropy">[tab:password-entropy]</a> приведена оценка NIST на величину энтропии пользовательских паролей в зависимости от их длины, и приведено сравнение с энтропией случайных паролей с равномерным распределением символов из набора в <span class="mathjax">$D=94$</span> символов клавиатуры. Вероятное число попыток для подбора пароля составляет <span class="mathjax">$O(2^H)$</span>. Из таблицы видно, что по критериям NIST энтропия реальных паролей в 2--4 раза меньше энтропии случайных паролей с равномерным распределением символов.</p><p><span style="font-variant: small-caps;"><b>Пример.</b></span> 
Оценим общее количество существующих паролей. Население Земли &ndash; 7 млрд. Предположим, что всё население использует компьютеры и Интернет, и у каждого человека по 10 паролей. Общее количество существующих паролей &ndash; <span class="mathjax">$7 \cdot 10^{10} \approx 2^{36}$</span>.</p><p>Имея доступ к наиболее массовым интернет-сервисам с количеством пользователей десятки и сотни миллионов, в которых пароли часто хранятся в открытом виде из-за необходимости обновления ПО и, в частности, выполнения аутентификации, мы:</p><ol><li>имеем базу паролей существенной части пользователей сети Интернет;</li><li>можем статистически построить правила генерирования паролей.</li></ol><p>Даже если пароль хранится в защищённом виде, то при вводе, как правило, он в открытом для сервиса виде пересылается по Интернету, и все преобразования пароля для аутентификации осуществляет интернет-сервис, а не веб-браузер. Следовательно, интернет-сервис периодически имеет доступ к исходному паролю.</p><p>В 2002 г. был подобран ключ для 64-битного блочного шифра RC5 сетью персональных компьютеров <tt>distributed.net</tt>, выполнявших вычисления в фоновом режиме. Суммарное время вычислений всех компьютеров &ndash; 1757 дней, было проверено 83 пространства всех ключей. Это означает, что пароли с оценочной энтропией менее 64 бит, то есть <em>все пароли</em> до 40 символов по критериям NIST, могут быть подобраны в настоящее время. Конечно, с оговорками на то, что 1) нет ограничений на количество и частоту попыток аутентификаций, 2) алгоритм генерации вероятных паролей эффективен.</p><p>Строго говоря, использование даже 40-символьного пароля для аутентификации или в качестве ключа блочного шифрования является небезопасным.</p><h4 data-command-name="subsubsection" id="Число_паролей">Число паролей</h4><p>Приведём различные оценки числа паролей, выбираемых людьми. Чаще всего такие пароли основаны на словах или закономерностях естественного языка. В английском языке всего около <span class="mathjax">$1\ 000\ 000 \approx 2^{20}$</span> слов, включая термины.</p><!--%http://www.springerlink.com/content/bh216312577r6w64/fulltext.pdf--><!--%http://www.antimoon.com/forum/2004/4797.htm--><p>Используемые слоги английского языка имеют вид V, CV, VC, CVV, VCC, CVC, CCV, CVCC, CVCCC, CCVCC, CCCVCC, где C &ndash; согласная (consonant), V &ndash; гласная (vowel). 70 слогов имеют структуру VC или CVC. Общее число слогов <span class="mathjax">$S = 8000 \dots 12000$</span>. Средняя длина слога &ndash; 3 буквы.</p><p>Предполагая равновероятное распределение слогов английского языка, для числа паролей из <span class="mathjax">$r$</span> слогов получим верхнюю оценку</p><div class="mathjax" style="text-align: center;">$$ N_1 = S^r = 2^{13 r} \approx 2^{4.3 L_1}. $$</div><p>Средняя длина паролей составит:</p><div class="mathjax" style="text-align: center;">$$ L_1 \approx 3 r. $$</div><p>Теперь предположим, что пароли могут состоять только из 2--3 буквенных слогов вида CV, VC, CVV, VCC, CVC, CCV с равновероятным распределением символов. Подсчитаем число паролей <span class="mathjax">$N_2$</span>, которые могут быть построены из <span class="mathjax">$r$</span> таких слогов. В английском алфавите число гласных букв <span class="mathjax">$n_v = 10$</span>, согласных <span class="mathjax">$n_c = 16$</span>, <span class="mathjax">$n = n_v + n_c = 26$</span>. Верхняя оценка числа <span class="mathjax">$r$</span>-слоговых паролей:</p><div class="mathjax" style="text-align: center;">$$ N_2 = (n_c n_v + n_v n_c + n_c n_v n_v + n_v n_c n_c + n_c n_v n_c + n_c n_c n_v)^r \approx $$</div><div class="mathjax" style="text-align: center;">$$ \approx \left( n_c n_v(3 n_c + n_v) \right)^r, $$</div><div class="mathjax" style="text-align: center;">$$ N_2 \approx \left( \frac{n^3}{2} \right)^r \approx 2^{13 r} \approx 2^{4.3 L_2}. $$</div><p>Средняя длина паролей:</p><div class="mathjax" style="text-align: center;">$$ L_2 = \frac{n_c n_v(2 + 2 + 3 n_v + 3 n_c + 3 n_c + 3 n_c)}{n_c n_v (1 + 1 + n_v + n_c + n_c + n_c)} \cdot r \approx 3 r. $$</div><p>Как видно, в обоих предположениях получились одинаковые оценки для числа и длины паролей.</p><p>Подсчитаем верхние оценки числа паролей из <span class="mathjax">$L$</span> символов, предполагая равномерное распределение символов из алфавита мощностью <span class="mathjax">$D$</span> символов: a) <span class="mathjax">$D_1 = 26$</span> строчных букв, б) все <span class="mathjax">$D_2 = 94$</span> печатных символа клавиатуры (латиница и небуквенные символы):</p><div class="mathjax" style="text-align: center;">$$ N_3 = D_1^L \approx 2^{4.7 L}, $$</div><div class="mathjax" style="text-align: center;">$$ N_4 = D_2^L \approx 2^{6.6 L}. $$</div><figure style="margin-left: auto; margin-right: auto; display: flex; flex-wrap: wrap; align-items: baseline; justify-content: center; width: fit-content; height: fit-content; "><command name="renewcommand"><argument required="true"><command name="arraystretch"></command></argument><argument required="true">1.25</argument></command><table style="border-collapse: collapse;"><colgroup><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"></colgroup><tr style="border-bottom: solid thin;border-top: solid thin;"><td rowspan="2" style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="parbox"><argument required="true">1.5cm</argument><argument required="true"><command name="footnotesize"></command><command name="centering"></command><command name="medskip"></command><command name="medskip"></command><command name="medskip"></command>Длина пароля</argument></command></td><td colspan="3" style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="footnotesize"></command>Число паролей</td></tr><tr style="border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="parbox"><argument required="true">2cm</argument><argument required="true"><command name="footnotesize"></command><command name="centering"></command><command name="medskip"></command>На основе слоговой композиции</argument></command></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="parbox"><argument required="true">2cm</argument><argument required="true"><command name="footnotesize"></command><command name="centering"></command><command name="medskip"></command>Алфавит <span class="mathjax">$D=26$</span> символов</argument></command></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="parbox"><argument required="true">2cm</argument><argument required="true"><command name="footnotesize"></command><command name="centering"></command><command name="medskip"></command>Алфавит <span class="mathjax">$D=94$</span> символа</argument></command></td></tr><tr style="border-bottom: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3.5ex</td></tr><tr style="border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">6</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{26}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{28}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{39}$</span></td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">9</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{39}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{42}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{59}$</span></td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">12</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{52}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{56}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{79}$</span></td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">15</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{65}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{71}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{98}$</span></td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">21</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{91}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{99}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{137}$</span></td></tr><tr style="border-bottom: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">39</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{169}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{183}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{256}$</span></td></tr></table><figcaption style="flex-basis: 100%; text-align: center;">Таблица 14.2 &mdash; Различные верхние оценки числа паролей<a name="#tab:password-number"></a></figcaption></figure><p>Из таблицы<span class="nonbreaking-interword-space"> </span><a href="#tab:password-number">[tab:password-number]</a> видно, что при доступном объёме вычислений в <span class="mathjax">$2^{60}$</span>&nbsp;&ndash;&nbsp;<span class="mathjax">$2^{70}$</span> операций, пароли вплоть до 15-ти символов, построенные на словах, слогах, изменениях слов, вставках цифр, небольшом изменении регистров и других простейших модификациях, в настоящее время могут быть найдены полным перебором как на вычислительном кластере, так и на персональном компьютере.</p><p>Для достижения криптостойкости паролей, сравнимой со 128- или 256-битовым секретным ключом, требуется выбирать пароль из 20 и 40 символов соответственно, что, как правило, не реализуется из-за сложности запоминания и возможных ошибок при вводе.</p><!--%Подсчитаем число паролей $N_1$, которые могут могут построены из $r$ ~ 2-3 буквенных слогов: $cv, vc, ccv, cvc, vcc$, где $c$ - - согласная, $v$ - - гласная. В английском алфавите $n_v = 10, n_c = 16, n = n_v + n_c = 26$. Число паролей--><!--%    \[ N_1 = \left( n_v n_c (1 + 1 + n_c + n_c + n_c) \right)^r \approx 3^r n_v^r n_c^{2r}. \]--><!--%Средняя длина паролей--><!--%    \[ L = r \left( \frac{2 + 2 + 3 n_c + 3 n_c + 3 n_c}{1 + 1 + n_c + n_c + n_c} \right) \approx 3r. \]--><!--%--><!--%%Учтем, что $b \leq r$ символов могут быть заглавными: $N_1 \rightarrow N_2 < N_1 \binom{L}{b} \left( \frac{n}{n_v} \right)^b$. Вставим $d$ цифр в случайные места: $N_2 \rightarrow N_3 = N_2 (10 (1 + L))^d \approx N_2 (10 L)^d$.--><!--%%--><!--%%Общее число паролей--><!--%%    \[ N = N_3 = 3^r 10^r 16^{2r} \binom{3r}{b} 2.6^b \left(10 \cdot 3 r \right)^d. \]--><!--%%--><!--%%\begin{table}[!ht]--><!--%%    \centering--><!--%%    \small--><!--%%    \begin{tabular}{|c|c|c|c|c||cr|}--><!--%%        \hline--><!--%%        \parbox{1.3cm}{Слогов, $r$} & \parbox{1.8cm}{Заглавных букв, $b$} & \parbox{1.5cm}{Вставок цифр, $d$} & \parbox{2.8cm}{Средняя длина пароля, $L+d$} & \parbox{3cm}{Верхняя оценка числа паролей $N$} & \multicolumn{2}{|c|}{\parbox{3.2cm}{Число всех паролей}} \\--><!--%%        \hline--><!--%%        $2$ & $0$ & $0$ & $6$ & $2^{26}$ & $2^{36}$ & a-z \\--><!--%%        $2$ & $2$ & $0$ & $6$ & $2^{32}$ & $2^{48}$ & A-Z, a-z \\--><!--%%        $2$ & $2$ & $2$ & $8$ & $2^{45}$ & $2^{48}$ & A-Z, a-z, 0-9 \\--><!--%%        \hline--><!--%%        $3$ & $0$ & $0$ & $9$ & $2^{39}$ & $2^{54}$ & a-z \\--><!--%%        $3$ & $3$ & $0$ & $9$ & $2^{49}$ & $2^{54}$ & A-Z, a-z \\--><!--%%        $3$ & $3$ & $2$ & $11$ & $2^{63}$ & $2^{65}$ & A-Z, a-z, 0-9 \\--><!--%%        \hline--><!--%%        $4$ & $0$ & $0$ & $12$ & $2^{52}$ & $2^{93}$ & a-z \\--><!--%%        $4$ & $3$ & $0$ & $12$ & $2^{64}$ & $2^{186}$ & A-Z, a-z \\--><!--%%        $4$ & $3$ & $2$ & $14$ & $2^{78}$ & $2^{222}$ & A-Z, a-z, 0-9 \\--><!--%%        \hline--><!--%%    \end{tabular}--><!--%%    \caption{Сравнение верхней оценки числа паролей, построенных на слогах, со всем доступным множеством паролей.}--><!--%%    \label{tab:password-number}--><!--%%\end{table}--><!--%--><!--%Учтем, что $b$ символов в пароле могут быть взяты не из 26-символьного алфавита строчных букв, а из всего алфавита в $D=94$ печатных символа клавиатуры (латиница и небуквенные символы):--><!--%\[--><!--%    \begin{array}{ll}--><!--%    b=1 & N_1 \rightarrow N_2 = \frac{n_v}{n_v+n_c} 3^r n_v^{r-1} n_c^{2r} \cdot L. \]--><!--%--><!--%    \[ N_1 \rightarrow N_2 < N_1 \binom{L}{b} \left( \frac{D}{n_v} \right)^b. \]--><!--%--><!--%--><!--%--><!--%Общее число паролей--><!--%    \[ N < 3^r n_v^r n_c^{2r} \binom{L}{b} \left( \frac{D}{n_v} \right)^b = 3^r 10^r 16^{2r} \binom{3r}{b} \left( \frac{94}{10} \right)^b. \]--><!--%--><!--%\begin{table}[!ht]--><!--%    \centering--><!--%    \small--><!--%    \begin{tabular}{|c|c|c|c||cr|}--><!--%        \hline--><!--%        \parbox{1.5cm}{Слогов, $r$} & \parbox{3cm}{Средняя длина пароля, $L$} & \parbox{3cm}{Символов из всего алфавита, $b$} & \parbox{3cm}{Верхняя оценка числа паролей $N$} & \multicolumn{2}{|c|}{\parbox{3.2cm}{Число всех паролей, $D^L$}} \\--><!--%        \hline--><!--%        \multirow{3}{*}{2} & \multirow{3}{*}{6} & $0$ & $2^{26}$ & $2^{28}$ & a-z \\--><!--%        & & $1$ & $2^{32}$ & $2^{34}$ & A-Z, a-z \\--><!--%        & & $3$ & $2^{40}$ & $2^{39}$ & Весь алфавит \\--><!--%        \hline--><!--%        \multirow{3}{*}{3} & \multirow{3}{*}{9} & $0$ & $2^{39}$ & $2^{42}$ & a-z \\--><!--%        & & $2$ & $2^{50}$ & $2^{51}$ & A-Z, a-z \\--><!--%        & & $4$ & $2^{59}$ & $2^{59}$ & Весь алфавит \\--><!--%        \hline--><!--%        \multirow{3}{*}{4} & \multirow{3}{*}{12} & $0$ & $2^{52}$ & $2^{56}$ & a-z \\--><!--%        & & $3$ & $2^{69}$ & $2^{68}$ & A-Z, a-z \\--><!--%        & & $6$ & $2^{81}$ & $2^{77}$ & Весь алфавит \\--><!--%        \hline--><!--%    \end{tabular}--><!--%    \caption{Сравнение верхней оценки числа паролей, построенных на слогах, со всем доступным множеством паролей в алфавите из $D$ символов.}--><!--%    \label{tab:password-number}--><!--%\end{table}--><!--%--><!--%Из таблицы~\ref{tab:password-number} видно, что при доступном объёме вычислений в $2^{60 \ldots 70}$ операций, пароли вплоть до 12 символов, построенные на словах, слогах, изменениях слов, вставках цифр, небольшого изменения регистров и другой простейшей обфускации, могут быть найдены перебором на кластере (или ПК) в настоящее время.--><h4 data-command-name="subsubsection" id="Атака_для_подбора_паролей_и_ключей_шифрования">Атака для подбора паролей и ключей шифрования</h4><p>В схемах аутентификации по паролю иногда используется хеширование и хранение хеша пароля на сервере. В таких случаях применима словарная атака или атака с применением заранее вычисленных таблиц для ускорения поиска.</p><p>Для нахождения пароля, прообраза хеш-функции, или для нахождения ключа блочного шифрования по атаке с выбранным шифртекстом (для одного и того же известного открытого текста и соответствующего шифртекста) может быть применён метод перебора с балансом между памятью и временем вычислений. Самый быстрый метод радужных таблиц<a name="N109373"><!--радужные таблицы--></a> (англ. <span lang="en"><i>rainbow tables</i></span>, 2003<span class="nonbreaking-interword-space"> </span>г., <a href="Literatura.html#Oechslin:2003">[82]</a>) заранее вычисляет следующие цепочки и хранит результат в памяти.</p><p>Для нахождения пароля, прообраза хеш-функции <span class="mathjax">$H$</span>, цепочка строится как</p><div class="mathjax" style="text-align: center;">$$ M_0 \xrightarrow{H(M_0)} h_0 \xrightarrow{R_0(h_0)} M_1 \ldots M_t \xrightarrow{H(M_t)} h_t \xrightarrow{R_t(h_t)} M_{t+1}, $$</div><p>где <span class="mathjax">$R_i(h)$</span> &ndash; функция редуцирования, преобразования хеша в пароль для следующего хеширования.</p><p>Для нахождения ключа блочного шифрования для одного и того же известного открытого текста <span class="mathjax">$M$</span> таблица строится как</p><div class="mathjax" style="text-align: center;">$$ K_0 \xrightarrow{E_{K_0}(M)} c_0 \xrightarrow{R_0(c_0)} K_1 \ldots K_t \xrightarrow{E_{K_t}(M)} c_t \xrightarrow{R_t(c_t)} K_{t+1}, $$</div><p>где <span class="mathjax">$R_i(c)$</span> &ndash; функция редуцирования, преобразования шифртекста в новый ключ.</p><p>Функция редуцирования <span class="mathjax">$R_i$</span> зависит от номера итерации, чтобы избежать дублирующихся подцепочек, которые возникают в случае коллизий между значениями в разных цепочках в разных итерациях, если <span class="mathjax">$R$</span> постоянна. Радужная таблица размера <span class="mathjax">$(m \times 2)$</span> состоит из строк <span class="mathjax">$(M_{0,j}, M_{t+1,j})$</span> или <span class="mathjax">$(K_{0,j}, K_{t+1,j})$</span>, вычисленных для разных значений стартовых паролей <span class="mathjax">$M_{0,j}$</span> или <span class="mathjax">$K_{0,j}$</span> соответственно.</p><p>Опишем атаку на примере нахождения прообраза <span class="mathjax">$\overline{M}$</span> хеша <span class="mathjax">$\overline{h} = H(\overline{M})$</span>. На первой итерации исходный хеш <span class="mathjax">$\overline{h}$</span> редуцируется в сообщение <span class="mathjax">$\overline{h} \xrightarrow{R_t(\overline{h})} \overline{M}_{t+1} $</span> и сравнивается со всеми значениями последнего столбца <span class="mathjax">$M_{t+1,j}$</span> таблицы. Если нет совпадения, переходим ко второй итерации. Хеш <span class="mathjax">$\overline{h}$</span> дважды редуцируется в сообщение <span class="mathjax">$\overline{h} \xrightarrow{R_{t-1}(\overline{h})} \overline{M}_t \xrightarrow{H(\overline{M}_t)} \overline{h}_t \xrightarrow{R_t(\overline{h}_t)} \overline{M}_{t+1}$</span> и сравнивается со всеми значениями последнего столбца <span class="mathjax">$M_{t+1,j}$</span> таблицы. Если не совпало, то переходим к третьей итерации и<span class="nonbreaking-interword-space"> </span>т.&nbsp;д. Если для <span class="mathjax">$r$</span>-кратного редуцирования сообщение <span class="mathjax">$\overline{M}_{t+1}$</span> содержится в таблице во втором столбце, то из совпавшей строки берётся <span class="mathjax">$M_{0,j}$</span>, и вся цепочка пробегается заново для поиска искомого сообщения <span class="mathjax">$\overline{M}: ~ \overline{h} = H(\overline{M})$</span>.</p><p>Найдём вероятность нахождения пароля в таблице. Пусть мощность множества всех паролей равна <span class="mathjax">$N$</span>. Изначально в столбце <span class="mathjax">$M_{0,j}$</span> содержится <span class="mathjax">$m_0 = m$</span> различных паролей. Предполагая наличие случайного отображения с пересечениями паролей <span class="mathjax">$M_{0,j} \rightarrow M_{1,j}$</span>, в <span class="mathjax">$M_{1,j}$</span> будет <span class="mathjax">$m_1$</span> различных паролей. Согласно задаче о размещении,</p><div class="mathjax" style="text-align: center;">$$
    m_{i+1} = N \left( 1 - \left( 1 - \frac{1}{N} \right)^{m_i} \right) \approx N \left( 1 - e^{-\frac{m_i}{N}} \right).
$$</div><p>Вероятность нахождения пароля:</p><div class="mathjax" style="text-align: center;">$$
    P = 1 - \prod \limits_{i=1}^t \left( 1 - \frac{m_i}{N} \right).
$$</div><p>Чем больше таблица из <span class="mathjax">$m$</span> строк, тем больше шансов найти пароль или ключ, выполнив в наихудшем случае   <span class="mathjax">$O \left( m \frac{t(t+1)}{2} \right)$</span> операций.</p><p>Примеры применения атаки на хеш-функциях <span class="mathjax">$\textrm{MD5}$</span><a name="N109509"><!--хеш-функция!MD5--></a>, <span class="mathjax">$\textrm{LM}$</span> (т.<span class="nonbreaking-interword-space"> </span>е. <span class="mathjax">$\textrm{DES}_{\textrm{Password}} (\textrm{const})$</span>) приведены в таблице<span class="nonbreaking-interword-space"> </span><a href="#tab:rainbow-tables">[tab:rainbow-tables]</a>.</p><figure style="margin-left: auto; margin-right: auto; display: flex; flex-wrap: wrap; align-items: baseline; justify-content: center; width: fit-content; height: fit-content; "> <table style="border-collapse: collapse;"><colgroup><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"></colgroup><tr style="border-bottom: solid thin;border-top: solid thin;"><td rowspan="2" style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="parbox"><argument required="true">1cm</argument><argument required="true"><command name="centering"></command><command name="footnotesize"></command><command name="medskip"></command><command name="medskip"></command><command name="medskip"></command>Длина, биты</argument></command></td><td colspan="3" style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="footnotesize"></command>Пароль или ключ</td><td colspan="3" style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="footnotesize"></command>Радужная таблица</td></tr><tr style="border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="parbox"><argument required="true">1.0cm</argument><argument required="true"><command name="centering"></command><command name="footnotesize"></command>Длина,<line-break></line-break> симв.</argument></command></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="footnotesize"></command>Множество</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="footnotesize"></command>Мощность</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="footnotesize"></command>Объём</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="parbox"><argument required="true">1.7cm</argument><argument required="true"><command name="centering"></command><command name="footnotesize"></command><command name="medspace"></command>Время вычисления таблиц</argument></command></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="parbox"><argument required="true">1.1cm</argument><argument required="true"><command name="centering"></command><command name="footnotesize"></command>Время поиска</argument></command></td></tr><tr style="border-bottom: double;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">2ex</td></tr><tr style="border-bottom: solid thin;border-top: double;"><td colspan="7" style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="footnotesize"></command>Хеш LM</td></tr><tr style="border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">&nbsp;</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">A&ndash;Z</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{33}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">610 MB</td><td rowspan="3" style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="parbox"><argument required="true">1.7cm</argument><argument required="true"><command name="centering"></command>несколько лет</argument></command></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">6 с</td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2 \times 56$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">14</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">A&ndash;Z, 0-9</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{36}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3 GB</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">15 с</td></tr><tr style="border-bottom: double;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">&nbsp;</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">все</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{43}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">64 GB</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">7 мин</td></tr><tr style="border-bottom: solid thin;border-top: double;"><td colspan="7" style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="footnotesize"></command>Хеш MD5</td></tr><tr style="border-bottom: solid thin;border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="rule"><argument required="true">0pt</argument><argument required="true">2.5ex</argument></command> 128</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">8</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">A-Z, 0-9</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2^{41}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">36 GiB</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">-</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4 мин</td></tr></table> <figcaption style="flex-basis: 100%; text-align: center;">Таблица 14.3 &mdash; Атаки на радужных таблицах на <em>одном</em> ПК<a name="#tab:rainbow-tables"></a></figcaption></figure><nav aria-label="Page navigation example"><ul class="pagination justify-content-center"><li class="page-item"><a class="page-link" href="Glava_14_Autentifikatsija_polzovatelja.html">&#129080; Glava_14_Autentifikatsija_polzovatelja</a></li><li class="page-item"><a class="page-link" href="14_3_Autentifikatsija_po_parolju.html">14_3_Autentifikatsija_po_parolju &#129082;</a></li></ul></nav></div><script>
window.MathJax = {
  loader: {
    load: ['[tex]/tagformat'],
  },
  options: {
    processHtmlClass: 'mathjax'
  },
  tex: {
    packages: {
      '[+]': ['base', 'ams', 'physics', 'textcomp']
    },
    inlineMath: [['$', '$']],
  },
};
</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script async="yes" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></body></html>