<!DOCTYPE html SYSTEM "about:legacy-compat">
<html><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><style type="text/css"> 
div.toc-item-h2 {
  padding-left: 2em;
}
div.toc-item-h3 {
  padding-left: 4em;
}
div.toc-item-h4 {
  padding-left: 6em;
}
div.toc-item-h5 {
  padding-left: 8em;
}
div.toc-item-h6 {
  padding-left: 10em;
}
</style><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" rel="stylesheet"><style type="text/css"> 
span.small {
  font-size: 90%
}
span.tiny {
  font-size: 50%
}
</style><style type="text/css"> 
div.mathjax {
  padding-top: .5em;
  padding-bottom: .5em;
}
</style></head><body><div class="container"><h2 data-command-name="section" id="5_9_Некоторые_свойства_блочных_шифров">5.9. Некоторые свойства блочных шифров</h2><h3 data-command-name="subsection" id="5_9_1_Обратимость_схемы_Фейстеля">5.9.1. Обратимость схемы Фейстеля</h3><p>Покажем, что обратимость схемы Фейстеля не зависит от выбора функции <span class="mathjax">$F$</span>.</p><p>Напомним, что схема Фейстеля &ndash; это итеративное шифрование, в котором выход подаётся на вход следующей итерации по правилу:</p><div class="mathjax" style="text-align: center;">$$ \begin{array}{l}
    L_i = R_{i-1}, \\
    R_i = L_{i-1} \oplus F(R_{i-1}, K_i), \\
\end{array} $$</div><div class="mathjax" style="text-align: center;">$$
    (L_0,R_0) \rightarrow (L_1,R_1) \rightarrow \ldots \rightarrow (L_n,R_n).
$$</div><p>При расшифровании используется та же схема, только левая и правая части меняются местами перед началом итераций, а ключи раунда подаются в обратном порядке:</p><div class="mathjax" style="text-align: center;">$$ R_i = L_{i-1} \oplus F(R_{i-1}, K_{n+1-i}), $$</div><div class="mathjax" style="text-align: center;">$$ \begin{array}{l}
    L_0^* = R_n = L_{n-1} \oplus F(R_{n-1}, K_n), \\
    R_0^* = L_n = R_{n-1}, \\
    \\
    L_1^* = R_{n-1}, \\
    R_1^* = L_{n-1} \oplus F(R_{n-1}, K_n) \oplus F(R_{n-1}, K_n) = L_{n-1}, \\
    \dots.
\end{array} $$</div><h3 data-command-name="subsection" id="5_9_2_Схема_Фейстеля_без_s_блоков">5.9.2. Схема Фейстеля без s-блоков</h3><p>Пусть функция <span class="mathjax">$F$</span> является простой линейной комбинацией некоторых битов правой части и ключа раунда относительно операции XOR. Тогда можно записать систему линейных уравнений битов выхода <span class="mathjax">$y_i$</span> относительно битов входа <span class="mathjax">$x_i$</span> и ключа <span class="mathjax">$k_i$</span> после всех 16 раундов в виде</p><div class="mathjax" style="text-align: center;">$$ y_i = \left(\sum_{i=0}^{n_1} a_i x_i\right) \oplus \left(\sum_{i=0}^{n_2} b_i k_i\right), $$</div><p>где суммирование производится по модулю 2, коэффициенты <span class="mathjax">$a_i$</span> и <span class="mathjax">$b_i$</span> известны и равны 0 или 1, количество битов в блоке открытого текста равно <span class="mathjax">$n_1$</span>, количество битов ключа равно <span class="mathjax">$n_2$</span>.</p><p>Имея открытый текст и шифртекст, легко найти ключ. Без знания открытых текстов, выполняя XOR шифртекстов, можно найти XOR открытых текстов, что может привести к возникновению благоприятных для взлома шифра условий. Во-первых, это может позволить провести атаку на различение сообщений. Во-вторых, в широко распространенных случаях, когда известны форматы сообщений, отдельные поля или распределение символов открытого текста, появляется возможность осуществить атаку перебором с учётом множества уравнений, полученных XOR шифртекстов.</p><p>Для предотвращения подобных атак используются s-блоки замены для создания нелинейности в уравнениях выхода <span class="mathjax">$y_i$</span> относительно сообщения и ключа.</p><h4 data-command-name="subsubsection" id="Схема_Фейстеля_в_ГОСТ_28147_89_без_s_блоков">Схема Фейстеля в<span class="nonbreaking-interword-space"> </span>ГОСТ<span class="nonbreaking-interword-space"> </span>28147-89 без<span class="nonbreaking-interword-space"> </span>s-блоков</h4><p>В отличие от устаревшего алгоритма DES блочный шифр ГОСТ без s-блоков намного сложнее для взлома, так как для него нельзя записать систему линейных уравнений:</p><div class="mathjax" style="text-align: center;">$$
    \begin{array}{l}
        L_1 = R_0, \\
        R_1 = L_0 \oplus ((R_0 \boxplus K_1) \lll 11), \\
    \end{array}
$$</div><div class="mathjax" style="text-align: center;">$$
    \begin{array}{l}
        L_2 = R_1 = L_0 \oplus ((R_0 \boxplus K_1) \lll 11), \\
        R_2 = L_1 \oplus (R_1 \boxplus K_2)  = \\
        ~~~~~= R_0 \oplus (((L_0 \oplus ((R_0 \boxplus K_1) \lll 11)) \boxplus K_2) \lll 11). \\
    \end{array}
$$</div><p>Операция <span class="mathjax">$\boxplus$</span> нелинейна по XOR. Например, только на трёх операциях <span class="mathjax">$\oplus$</span>, <span class="mathjax">$\boxplus$</span> и <span class="mathjax">$\lll f(R_i)$</span> без использования s-блоков построен блочный шифр RC5, который по состоянию на 2010 г. не был взломан.</p><h3 data-command-name="subsection" id="5_9_3_Лавинный_эффект">5.9.3. Лавинный эффект</h3><h4 data-command-name="subsubsection" id="Лавинный_эффект_в_DES">Лавинный эффект в DES</h4><p>Оценим число раундов, за которое в DES достигается полный лавинный эффект<a name="N85332"><!--лавинный эффект--></a>, предполагая <em>случайное</em> расположение бит перед расширением, s-блоками (<span class="mathjax">$s$</span> &ndash; substitute, блоки замены) и XOR.</p><p>Пусть на входе правой части <span class="mathjax">$R_i$</span> содержится <span class="mathjax">$r$</span> бит, на которые уже распространилось влияние одного бита, выбранного вначале. После расширения получим</p><div class="mathjax" style="text-align: center;">$$ n_1 \approx \min(1.5 \cdot r, 32) $$</div><p>зависимых бит. Предполагая случайные попадания в 8 s-блоков, мы увидим, что, согласно задаче о размещении, биты попадут в</p><div class="mathjax" style="text-align: center;">$$ s_2 = 8 \left( 1 - \left( 1 - \frac{1}{{8}{n_1}} \right)^{n_1} \right) \approx 8 \left( 1 - e^{-\frac{n_1}{8}} \right) $$</div><p>s-блоков. Одно из требований NSA к s-блокам заключалось в том, чтобы изменение каждого бита входа <em>изменяло</em> 2 бита выхода. Мы предположим, что каждый бит входа s-блока <em>влияет</em> на все 4 бита выхода. Зависимыми станут</p><div class="mathjax" style="text-align: center;">$$ n_2 = 4 \cdot s_2 \approx 32 \left( 1 - e^{-\frac{n_1}{8}} \right) $$</div><p>бит. При дальнейшем XOR с величиной <span class="mathjax">$L_i$</span>, содержащей <span class="mathjax">$l$</span> зависимых бит, результатом будет</p><div class="mathjax" style="text-align: center;">$$ n_3 \approx n_2 + l  - \frac{n_2 l}{32} $$</div><p>зависимых бит.</p><figure style="margin-left: auto; margin-right: auto; display: flex; flex-wrap: wrap; align-items: baseline; justify-content: center; width: fit-content; height: fit-content; "><table style="border-collapse: collapse;"><colgroup><col style="border-left: double;border-right: double;"><col style="border-left: double;border-right: double;"><col style="border-left: double;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: double;"></colgroup><tr style="border-bottom: solid thin;border-top: solid thin;"><td rowspan="3" style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">Раунд</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$L_i$</span></td><td colspan="3" style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$R_i$</span></td></tr><tr style="border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">Расширение</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">s-блоки</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$R_{i+1} = f(R_i) \oplus L_i$</span></td></tr><tr style="border-bottom: double;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$l$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$r \rightarrow n_1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$n_1 \rightarrow n_2$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$(n_2, l) \rightarrow n_3$</span></td></tr><tr style="border-top: double;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">0</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">0</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">0</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">0</td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">0</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">0</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">0</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$(0,1) \rightarrow 1$</span></td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">2</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$1 \rightarrow 1.5$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$1.5 \rightarrow 5.5$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$(5.5, 0) \rightarrow 5.5$</span></td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">5.5</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$5.5 \rightarrow 8.2$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$8.2 \rightarrow 20.5$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$(20.5, 1) \rightarrow 20.9$</span></td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">20.9</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$20.9 \rightarrow 31.3$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$31.3 \rightarrow 32$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$(32, 20.9) \rightarrow 32$</span></td></tr><tr style="border-bottom: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">5</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">32</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">32</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">32</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">32</td></tr></table><figcaption style="flex-basis: 100%; text-align: center;">Таблица 5.1 &mdash; Распространение влияния 1 бита левой части в DES<a name="#tab-DES-avalance-effect"></a></figcaption></figure><p>В таблице<span class="nonbreaking-interword-space"> </span><a href="#tab-DES-avalance-effect">[tab-DES-avalance-effect]</a> приводится расчёт распространения одного бита левой части. Посчитано число зависимых битов по раундам в предположении об их случайном расположении и о том, что каждый бит на входе s-блока <em>влияет</em> на все биты выхода. Полная диффузия достигается за 5 раундов, что совпадает с экспериментальной проверкой. Для достижения максимального лавинного эффекта требуется аккуратно выбрать расширение, s-блоки, а также перестановку в функции <span class="mathjax">$F$</span>.</p><h4 data-command-name="subsubsection" id="Лавинный_эффект_в_ГОСТ_28147_89">Лавинный эффект в ГОСТ 28147-89</h4><p>Лавинный эффект<a name="N85574"><!--лавинный эффект--></a> по входу обеспечивается <span class="mathjax">$(4 \times 4)$</span> s-блоками и циклическим сдвигом влево на <span class="mathjax">$11 \neq 0 \mod 4$</span>.</p><figure style="margin-left: auto; margin-right: auto; display: flex; flex-wrap: wrap; align-items: baseline; justify-content: center; width: fit-content; height: fit-content; "> <table style="border-collapse: collapse;"><colgroup><col style="border-left: double;border-right: double;"><col style="border-left: double;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: double;"><col style="border-left: double;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: double;"></colgroup><tr style="border-bottom: solid thin;border-top: solid thin;"><td rowspan="2" style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">Раунд</td><td colspan="8" style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$L_i$</span></td><td colspan="8" style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$R_i$</span></td></tr><tr style="border-bottom: double;border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">2</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">5</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">6</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">7</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">8</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">2</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">5</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">6</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">7</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">8</td></tr><tr style="border-top: double;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">0</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">2</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">5</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">6</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">7</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td></tr><tr style="border-bottom: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">8</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td></tr></table> <figcaption style="flex-basis: 100%; text-align: center;">Таблица 5.2 &mdash; Распространение влияния 1 бита левой части в ГОСТ 28147-89<a name="#tab:GOST-avalance-effect"></a></figcaption></figure><p>Из таблицы<span class="nonbreaking-interword-space"> </span><a href="#tab:GOST-avalance-effect">[tab:GOST-avalance-effect]</a> видно, что на каждом раунде число зависимых битов увеличивается в среднем на 4 в результате сдвига и попадания выхода s-блока предыдущего раунда в два s-блока следующего раунда. Показано распространение зависимых битов в группах по 4 бита в левой и правой частях без учёта сложения с ключом раунда. Предполагается, что каждый бит на входе s-блока влияет на все биты выхода. Число раундов для достижения полного лавинного эффекта без учёта сложения с ключом &ndash; 8. Экспериментальная проверка для s-блоков, используемых Центробанком РФ, показывает, что требуется 8 раундов.</p><h4 data-command-name="subsubsection" id="Лавинный_эффект_в_AES">Лавинный эффект в AES</h4><p>В первом раунде один бит оказывает влияние на один байт в операции &laquo;замена байтов&raquo; и затем на столбец из четырёх байтов в операции &laquo;перемешивание столбцов&raquo;<a name="N86015"><!--лавинный эффект--></a>.</p><p>Во втором раунде операция &laquo;сдвиг строк&raquo; сдвигает байты изменённого столбца на разное число байтов по строкам, в результате получаем диагональное расположение изменённых байтов, то есть в каждой строке присутствует по изменённому байту. Далее, в результате операции &laquo;перемешивания столбцов&raquo; изменение распространяется от байта в столбце на весь столбец и, следовательно, на всю матрицу.</p><p>Диффузия по входу достигается за 2 раунда.</p><h3 data-command-name="subsection" id="5_9_4_Двойное_и_тройное_шифрования">5.9.4. Двойное и тройное шифрования</h3><p><a name="N86037"><!--шифрование!двойное--></a><a name="N86042"><!--шифрование!тройное--></a>
В конце XX-го века, когда ненадёжность существующего стандарта DES<a name="N86048"><!--шифр!DES--></a> уже была очевидна, а нового стандарта ещё не было, стали распространены техники двойного и тройного шифрования, когда к одному блоку текста последовательно применяется несколько преобразований на разных ключах.</p><p>Например, двойное шифрование<a name="N86054"><!--шифрование!двойное--></a> 2DES<a name="N86060"><!--шифр!2DES--></a> использует два разных ключа <span class="mathjax">$K_1$</span> и <span class="mathjax">$K_2$</span> для шифрования одного блока текста дважды:</p><div class="mathjax" style="text-align: center;">$$ E_{K1, K2} \left( M \right) \equiv E_{K1} \left( E_{K2} \left( M \right) \right). $$</div><p>Так как функция шифрования<a name="N86075"><!--функция!шифрования--></a> DES не образует группу<a name="N86081"><!--группа--></a> ([<a href="Literatura.html#Campbell:Wiener:1993">22</a>, <a href="Literatura.html#Kaliski:Rivest:Sherman:1988">50</a>]), то данное преобразование не эквивалентно однократному шифрованию на каком-нибудь третьем ключе. То есть для произвольных <span class="mathjax">$K_1$</span> и <span class="mathjax">$K_2$</span> нельзя подобрать такой <span class="mathjax">$K_3$</span>, что</p><div class="mathjax" style="text-align: center;">$$E_{K1} \left( E_{K2} \left( M \right) \right) \equiv E_{K3} \left( M \right).$$</div><p>Тем самым размер ключевого пространства (количество различных ключей шифрования, если считать за ключ пару <span class="mathjax">$K_1$</span> и <span class="mathjax">$K_2$</span>) увеличивается с <span class="mathjax">$2^{56}$</span> до <span class="mathjax">$2^{112}$</span> (без учёта проверочных бит). Однако из-за атаки &laquo;встреча посередине&raquo;<a name="N86117"><!--атака!встреча посередине--></a> (англ. <span lang="en"><i>meet in the middle</i></span>) фактическая криптостойкость увеличилась не более чем до <span class="mathjax">$2^{57}$</span>.</p><p>Тройной DES (англ. <span lang="en"><i>triple DES, 3DES</i></span>)<a name="N86152"><!--шифрование!тройное--></a><a name="N86157"><!--шифр!3DES--></a> использует тройное преобразование. Причём в качестве второй функции используется функция <em>расшифрования</em>:</p><div class="mathjax" style="text-align: center;">$$ E_{K1, K2, K3} \left( M \right) \equiv E_{K1} \left( D_{K2} \left( E_{K3} \left( M \right) \right) \right). $$</div><ul><li>Вариант <span class="mathjax">$K_1 \neq K_2 \neq K_3$</span> является наиболее защищённым, ключевое пространство увеличивается до <span class="mathjax">$2^{168}$</span>.</li><li>Вариант <span class="mathjax">$K_1 \neq K_2$</span>, <span class="mathjax">$K_1 = K_3$</span> увеличивает ключевое пространство до <span class="mathjax">$2^{112}$</span>, но защищён от атаки &laquo;встреча посередине&raquo;<a name="N86192"><!--атака!встреча посередине--></a>, в отличие от 2DES<a name="N86198"><!--шифр!2DES--></a>.</li><li>Вариант <span class="mathjax">$K_1 = K_2 = K_3$</span> эквивалентен однократному преобразованию DES<a name="N86209"><!--шифр!DES--></a>. Его можно использовать для обеспечения совместимости.</li></ul><p>Оценим сложность атак на 2DES<a name="N86216"><!--шифр!2DES--></a> и 3DES<a name="N86222"><!--шифр!3DES--></a>.</p><h4 data-command-name="subsubsection" id="Атака_на_двойное_шифрование">Атака на двойное шифрование</h4><!--%Для упрощения записи введём обозначение последовательного шифрования $E_{K_1}( E_{K_2}( \dots E_{K_n}(M) \dots)) \equiv E{K_1} \circ E_{K_2} (M)$ и назовём его суперпозицией функций $E_{K_i}$.--><p>Атака основана на предположении, что у криптоаналитика есть возможность получить либо шифртекст для любого открытого текста<a name="N86237"><!--атака!с известным шифртекстом--></a> (англ. <span lang="en"><i>Chosen Plaintext Attack, CPA</i></span>), либо открытый текст по шифртексту<a name="N86256"><!--атака!с известным открытым текстом--></a> (англ. <span lang="en"><i>Chosen Ciphertext Attack, CCA</i></span>), но неизвестен ключ шифрования, который и нужно найти.</p><p>Шифрование в 2DES<a name="N86275"><!--шифр!2DES--></a>:</p><div class="mathjax" style="text-align: center;">$$ C = E_{K_1}( E_{K_2}(M)). $$</div><p>Запишем <span class="mathjax">$D_{K_1}(C) = E_{K_2}(M)$</span>. Пусть время одного шифрования &ndash; <span class="mathjax">$T_E$</span>, время одного сравнения блоков <span class="mathjax">$T_{=} \approx 2^{-10} T_E$</span>.</p><p>Атака для нахождения ключей без использования памяти занимает время</p><div class="mathjax" style="text-align: center;">$$ T = 2^{56 + 56} (T_E + T_{=}) \approx 2^{112} T_E. $$</div><p>Можно заранее вычислить значения <span class="mathjax">$E_{K_2}(M)$</span> для всех ключей и построить таблицу: индекс &ndash; <span class="mathjax">$E_{K_2}(M)$</span>, значения поля &ndash; набор ключей <span class="mathjax">$K_2$</span>, которые соответствуют этому значению. Атака для нахождения ключей требует времени</p><div class="mathjax" style="text-align: center;">$$ T = 2 \cdot 2^{56} T_E + 2^{56} T_{=} \approx 2^{57} T_E $$</div><p>и памяти <span class="mathjax">$M = 56 \cdot 2^{56} \approx 2^{62}$</span> бит (<span class="mathjax">$\approx 504$</span> Пбайт), учитывая прямой доступ по значению к возможным ключам. При нахождении соответствия берётся другая пара (открытый текст, шифртекст) и проверяется равенство для определения, являются ли ключи правильными или нет.</p><p>По отношению к CCA и CPA криптостойкость 2DES<a name="N86314"><!--шифр!2DES--></a> эквивалентна обычному DES<a name="N86320"><!--шифр!DES--></a> с использованием 26 ГиБ памяти.</p><h4 data-command-name="subsubsection" id="Атака_на_тройное_шифрование">Атака на тройное шифрование</h4><p>Атака для нахождения ключей (CCA<a name="N86333"><!--атака!с известным шифртекстом--></a>, CPA<a name="N86339"><!--атака!с известным открытым текстом--></a>) на наиболее стойкий вариант 3DES<a name="N86345"><!--шифр!3DES--></a> (все три ключа <span class="mathjax">$K_1$</span>, <span class="mathjax">$K_2$</span> и <span class="mathjax">$K_3$</span> выбираются независимо) требует времени <span class="mathjax">$T \approx 2^{168} T_E$</span> без использования дополнительной памяти.</p><p>Для построения таблицы запишем</p><div class="mathjax" style="text-align: center;">$$ D_{K_2}( D_{K_1}( C)) = E_{K_3} (M). $$</div><p>Таблица строится аналогично 2DES<a name="N86366"><!--шифр!2DES--></a> для <span class="mathjax">$E_{K_3}(M)$</span>. С использованием памяти атака занимает время <span class="mathjax">$T = 2^{112} T_E$</span> и память <span class="mathjax">$M = 26$</span> GiB.</p><p><a name="N86382"><!--шифр!блочный|)--></a></p><nav aria-label="Page navigation example"><ul class="pagination justify-content-center"><li class="page-item"><a class="page-link" href="5_8_Rezhimi_raboti_blochnih_shifrov.html">&#129080; 5_8_Rezhimi_raboti_blochnih_shifrov</a></li><li class="page-item"><a class="page-link" href="Glava_6_Generatori_psevdosluchaynih_chisel.html">Glava_6_Generatori_psevdosluchaynih_chisel &#129082;</a></li></ul></nav></div><script>
window.MathJax = {
  loader: {
    load: ['[tex]/tagformat'],
  },
  options: {
    processHtmlClass: 'mathjax'
  },
  tex: {
    packages: {
      '[+]': ['base', 'ams', 'physics', 'textcomp']
    },
    inlineMath: [['$', '$']],
  },
};
</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script async="yes" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></body></html>