<!DOCTYPE html SYSTEM "about:legacy-compat">
<html><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><style type="text/css"> 
div.toc-item-h2 {
  padding-left: 2em;
}
div.toc-item-h3 {
  padding-left: 4em;
}
div.toc-item-h4 {
  padding-left: 6em;
}
div.toc-item-h5 {
  padding-left: 8em;
}
div.toc-item-h6 {
  padding-left: 10em;
}
</style><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" rel="stylesheet"><style type="text/css"> 
span.small {
  font-size: 90%
}
span.tiny {
  font-size: 50%
}
</style><style type="text/css"> 
div.mathjax {
  padding-top: .5em;
  padding-bottom: .5em;
}
</style></head><body><div class="container"><h2 data-command-name="section" id="7_1_Шифр_RC4">7.1. Шифр RC4</h2><p><a name="N87771"><!--шифр!RC4|(--></a>
Шифр RC4 был разработан Роном Ривестом (англ. <span lang="en"><i>Ronald Linn Rivest</i></span>) в 1987 году для компании RSA Data Security. Описание алгоритма было впервые анонимно опубликовано в телеконференции Usenet sci.crypt в 1994 году</p><command name="footnote"><argument required="true">См. раздел 17.1. &laquo;Алгоритм RC4&raquo; в<span class="nonbreaking-interword-space"> </span><a href="Literatura.html#Schneier:2002">[135]</a>.</argument></command><p>.</p><p>Генератор, используемый в шифре, хранит своё состояние в массиве из 256 ячеек <span class="mathjax">$S_0, S_1, \dots, S_{255}$</span>, заполненных значениями от 0 до 255 (каждое значение встречается только один раз), а также двух других переменных размером в 1 байт <span class="mathjax">$i$</span> и <span class="mathjax">$j$</span>. Таким образом, количество различных внутренних состояний генератора равно <span class="mathjax">$255! \times 255 \times 255 \approx 2.17 \times 10^{509} \approx 2^{1962}$</span>.</p><p>Процедура инициализации генератора.</p><ul><li>Для заполнения байтового массива из 256 ячеек <span class="mathjax">$K_0, K_1, \dots, K_{255}$</span> используется предоставленный ключ. При необходимости (если размер ключа менее 256 байтов) ключ используется несколько раз, пока массив <span class="mathjax">$K$</span> не будет заполнен целиком.</li><li>Начальное значение <span class="mathjax">$j$</span> равно <span class="mathjax">$0$</span>.</li><li>Далее для значений <span class="mathjax">$i$</span> от <span class="mathjax">$0$</span> до <span class="mathjax">$255$</span> выполняется:
	<ol><li><span class="mathjax">$j:= (j + S_i + K_i) \mod 256$</span>,</li><li>поменять местами <span class="mathjax">$S_i$</span> и <span class="mathjax">$S_j$</span>.</li></ol></li></ul><p>Процедура получения следующего псевдослучайного байта <span class="mathjax">$result$</span> (следующего байта гаммы):</p><ol><li><span class="mathjax">$ i := (i + 1) \mod 256$</span>,</li><li><span class="mathjax">$ j := (j + S_i) \mod 256$</span>,</li><li>поменять местами <span class="mathjax">$S_i$</span> и <span class="mathjax">$S_j$</span>,</li><li><span class="mathjax">$ t := ( S_i + S_j ) \mod 256$</span>,</li><li><span class="mathjax">$ result := S_t$</span>.</li></ol><p>По утверждению Брюса Шнайера, алгоритм настолько прост, что большинство программистов могут закодировать его по памяти. Шифр RC4 использовался во многих программных продуктах, в том числе в IBM Lotus Notes, Apple AOCE, Oracle Secure SQL и Microsoft Office, а также в стандарте сотовой передачи цифровых данных CDPD. В настоящий момент шифр не рекомендуется к использованию<span class="nonbreaking-interword-space"> </span><a href="Literatura.html#rfc7465">[85]</a>, в нём были найдены многочисленные, хотя и некритичные уязвимости<span class="nonbreaking-interword-space"> </span>[<a href="Literatura.html#Fluhrer:Mantin:Shamir:2001">40</a>, <a href="Literatura.html#Mantin:Shamir:2002">65</a>, <a href="Literatura.html#Paul:Maitra:2007">83</a>, <a href="Literatura.html#Sepehrdad:Vaudenay:Vuagnoux:2011">92</a>].</p><p><a name="N87900"><!--шифр!RC4|)--></a></p><nav aria-label="Page navigation example"><ul class="pagination justify-content-center"><li class="page-item"><a class="page-link" href="Glava_7_Potokovie_shifri.html">&#129080; Glava_7_Potokovie_shifri</a></li><li class="page-item"><a class="page-link" href="Glava_8_Kriptograficheskie_hesh_funktsii.html">Glava_8_Kriptograficheskie_hesh_funktsii &#129082;</a></li></ul></nav></div><script>
window.MathJax = {
  loader: {
    load: ['[tex]/tagformat'],
  },
  options: {
    processHtmlClass: 'mathjax'
  },
  tex: {
    packages: {
      '[+]': ['base', 'ams', 'physics', 'textcomp']
    },
    inlineMath: [['$', '$']],
  },
};
</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script async="yes" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></body></html>