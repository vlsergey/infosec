<!DOCTYPE html SYSTEM "about:legacy-compat">
<html><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><style type="text/css"> 
div.toc-item-h2 {
  padding-left: 2em;
}
div.toc-item-h3 {
  padding-left: 4em;
}
div.toc-item-h4 {
  padding-left: 6em;
}
div.toc-item-h5 {
  padding-left: 8em;
}
div.toc-item-h6 {
  padding-left: 10em;
}
</style><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" rel="stylesheet"><style type="text/css"> 
span.small {
  font-size: 90%
}
span.tiny {
  font-size: 50%
}
</style><style type="text/css"> 
div.mathjax {
  padding-top: .5em;
  padding-bottom: .5em;
}
</style></head><body><div class="container"><h2 data-command-name="section" id="16_7_Группы_точек_эллиптических_кривых">16.7. Группы точек<line-break></line-break>
	эллиптических кривых</h2><p><a name="N118018"><!--группа!точек эллиптической кривой|(--></a></p><h3 data-command-name="subsection" id="16_7_1_Группы_точек_эллиптических_кривых">16.7.1. Группы точек эллиптических кривых</h3><p>Эллиптическая кривая <span class="mathjax">$E$</span> над полем вещественных чисел записывается в виде уравнения, связывающего координаты <span class="mathjax">$x$</span> и <span class="mathjax">$y$</span> точек кривой:</p><command name="equation"><argument required="true">equation</argument><content>
    E: <span class="nonbreaking-interword-space"> </span> y^2 = x^3 + ax + b,
    <a name="#Wer"></a>
</content></command><p>где <span class="mathjax">$a,b \in {{\mathbb{R}}}$</span> &ndash; вещественные числа. Эта форма представления эллиптической кривой называется формой Вейерштрасса.</p><p>На кривой определён инвариант:</p><command name="equation"><argument required="true">equation</argument><content>
    J(E)=1728<command name="frac"><argument required="true">4a^3 </argument><argument required="true">4a^3 +27b^2 </argument></command>.
    <!--%\label{Inv}--></content></command><p>Пусть <span class="mathjax">$x_{1}$</span>, <span class="mathjax">$x_{2}$</span> и <span class="mathjax">$x_{3}$</span> &ndash; корни уравнения <span class="mathjax">$x^3 + a x + b = 0$</span>. Определим дискриминант <span class="mathjax">$D$</span> в виде:</p><div class="mathjax" style="text-align: center;">$$ D =(x_1 - x_2)^2 (x_1 - x_3)^2 (x_2 - x_3)^2 = - 16(4 a^3 + 27 b^2). $$</div><p>Рассмотрим различные значения дискриминанта <span class="mathjax">$D$</span> и соответствующие им кривые, которые представлены на рисунках <a href="16_7_Gruppi_tochek.html#fig:elliptic-curve-1">16.1a</a>, <a href="16_7_Gruppi_tochek.html#fig:elliptic-curve-2">16.1b</a>, <a href="16_7_Gruppi_tochek.html#fig:elliptic-curve-3">16.1c</a>.</p><figure style="margin-left: auto; margin-right: auto; display: flex; flex-wrap: wrap; align-items: baseline; justify-content: center; width: fit-content; height: fit-content; "><figure style="margin-left: 0; margin-right: 0; "><a name="fig:elliptic-curve-1" style="vertical-align: top; align-self: start;"></a><img src="images/488DCD4B06FF835D1B233B48DE78A366.png" style="width: 100%"><figcaption>(a) <span class="mathjax">$D&gt;0$</span></figcaption></figure><span class="nonbreaking-interword-space"> </span><span class="nonbreaking-interword-space"> </span><span class="nonbreaking-interword-space"> </span><span class="nonbreaking-interword-space"> </span><figure style="margin-left: 0; margin-right: 0; "><a name="fig:elliptic-curve-2" style="vertical-align: top; align-self: start;"></a><img src="images/B27EA019BB28782DB798B4CFBFB190B6.png" style="width: 100%"><figcaption>(b) <span class="mathjax">$D=0$</span></figcaption></figure><span class="nonbreaking-interword-space"> </span><span class="nonbreaking-interword-space"> </span><span class="nonbreaking-interword-space"> </span><span class="nonbreaking-interword-space"> </span><figure style="margin-left: 0; margin-right: 0; "><a name="fig:elliptic-curve-3" style="vertical-align: top; align-self: start;"></a><img src="images/B8721DF4144C3FB4028E943F9CBA5A15.png" style="width: 100%"><figcaption>(c) <span class="mathjax">$D&lt;0$</span></figcaption></figure><figcaption style="flex-basis: 100%; text-align: center;">Рис. 16.1 &mdash; Эллиптические кривые с различными дискриминантами</figcaption></figure><ol><li>При <span class="mathjax">$D&gt;0$</span> график эллиптической кривой состоит из двух частей (см. рис.<span class="nonbreaking-interword-space"> </span><a href="16_7_Gruppi_tochek.html#fig:elliptic-curve-1">16.1a</a>). Прямая, проходящая через точки <span class="mathjax">$P(x_1; y_1)$</span> и <span class="mathjax">$Q(x_2; y_2)$</span>, обязательно пересечёт вторую часть кривой в точке с координатами <span class="mathjax">$(x_3; \widetilde{y}_3)$</span>, отображением которой является точка <span class="mathjax">$R(x_3; y_3)$</span>, где <span class="mathjax">$y_3 = - \widetilde{y}_3$</span>. Любые точки на кривой при <span class="mathjax">$D&gt;0$</span> являются элементами группы по сложению.</li><li>Если <span class="mathjax">$D=0$</span>, то левая и правая части касаются в одной точке (см. рис.<span class="nonbreaking-interword-space"> </span><a href="16_7_Gruppi_tochek.html#fig:elliptic-curve-2">16.1b</a>). Эти кривые называются сингулярными и не рассматриваются.</li><li>Если <span class="mathjax">$D&lt;0$</span>, то записанное выше уравнение<span class="nonbreaking-interword-space"> </span><a href="#Wer">[Wer]</a> описывает одну кривую, представленную на рис.<span class="nonbreaking-interword-space"> </span><a href="16_7_Gruppi_tochek.html#fig:elliptic-curve-3">16.1c</a>.</li></ol><p>Рассмотрим операцию сложения точек на эллиптической кривой при <span class="mathjax">$D \ne 0$</span> (другие кривые не рассматриваются).</p><p>Пусть точки <span class="mathjax">$P(x_1; y_1)$</span> и <span class="mathjax">$Q(x_2; y_2)$</span> принадлежат эллиптической кривой (рис.<span class="nonbreaking-interword-space"> </span><a href="16_7_Gruppi_tochek.html#fig:elliptic-curve-1">16.1a</a>). Определим операцию сложения точек</p><div class="mathjax" style="text-align: center;">$$ P + Q = R. $$</div><ol><li>Eсли <span class="mathjax">$P \neq Q$</span>, то точка <span class="mathjax">$R$</span> определяется как отображение (инвертированная <span class="mathjax">$y$</span>-координата) точки, полученной пересечением эллиптической кривой и прямой <span class="mathjax">$PQ$</span>. Совместно решая уравнения кривой и прямой, можно найти координаты их точки пересечения. Зная координаты точки пересечения, можно вычислить и координаты искомой точки <span class="mathjax">$R = (x_3; y_3)$</span>, которые будут равны:
        <div class="mathjax" style="text-align: center;">$$ x_3 = \lambda^2 - x_1 - x_2, $$</div>
        <div class="mathjax" style="text-align: center;">$$ y_3 = - y_1 + \lambda (x_1 - x_3), $$</div>
где
        <div class="mathjax" style="text-align: center;">$$ \lambda = \frac{y_2 - y_1}{x_2 - x_1} $$</div>
есть тангенс угла наклона между прямой, проходящей через точки <span class="mathjax">$P$</span> и <span class="mathjax">$Q$</span>, и осью <span class="mathjax">$x$</span>.

	Теперь рассмотрим специальные случаи.</li><li>Пусть точки совпадают: <span class="mathjax">$P = Q$</span>. Прямая <span class="mathjax">$PQ$</span> превращается в касательную к кривой в точке <span class="mathjax">$P$</span>. Находим пересечение касательной с кривой, инвертируем <span class="mathjax">$y$</span>-координату полученной точки, это будет точка <span class="mathjax">$P + P = R$</span>. Тогда <span class="mathjax">$\lambda$</span> &ndash; тангенс угла между касательной, проведённой к эллиптической кривой в точке <span class="mathjax">$P$</span>, и осью <span class="mathjax">$x$</span>. Запишем уравнение касательной к эллиптической кривой в точке <span class="mathjax">$(x; y)$</span> в виде:
            <div class="mathjax" style="text-align: center;">$$ 2 y y' = 3 x^2 + a. $$</div>
        Производная равна
            <div class="mathjax" style="text-align: center;">$$ y' = \frac{3 x^2 + a}{2 y}, $$</div>
        и
            <div class="mathjax" style="text-align: center;">$$ \lambda = \frac{3 x_1^2 + a}{2 y_1}. $$</div>
        Координаты <span class="mathjax">$R$</span> имеют прежний вид:
            <div class="mathjax" style="text-align: center;">$$ x_3 = \lambda^2 - x_1 - x_2, $$</div>
            <div class="mathjax" style="text-align: center;">$$ y_3 = - y_1 + \lambda (x_1 - x_3), $$</div></li><li>Пусть <span class="mathjax">$P$</span> и <span class="mathjax">$Q$</span> &ndash; противоположные точки, то есть <span class="mathjax">$P=(x; y)$</span> и <span class="mathjax">$Q=(x; -y)$</span>. Введём ещё одну точку на бесконечности и обозначим её <span class="mathjax">$O$</span> (точка <span class="mathjax">$O$</span> или точка 0 &laquo;ноль&raquo;, или альтернативное обозначение <span class="mathjax">$\infty$</span>). Результатом сложения двух противоположных точек определим точку <span class="mathjax">$O$</span>. Точка <span class="mathjax">$Q$</span> в данном случае обозначается как <span class="mathjax">$-P$</span>:
        <div class="mathjax" style="text-align: center;">$$ P = (x; y), ~ -P = (x; -y), ~ P + (-P) = O. $$</div></li><li>Пусть <span class="mathjax">$P = (x; 0)$</span> лежит на оси <span class="mathjax">$x$</span>, тогда
        <div class="mathjax" style="text-align: center;">$$ -P = P, ~ P + P = O. $$</div></li></ol><p>Все точки эллиптической кривой, а также точка <span class="mathjax">$O$</span> образуют коммутативную группу<a name="N118412"><!--группа!коммутативная--></a> <span class="mathjax">${{\mathbb{E}}}({{\mathbb{R}}})$</span> относительно введённой операции сложения, то есть выполняются законы коммутативной группы:</p><ul><li>сумма точек <span class="mathjax">$P + Q$</span> лежит на эллиптической кривой;</li><li>существует нулевой элемент &ndash; это точка <span class="mathjax">$O$</span> на бесконечности:
        <div class="mathjax" style="text-align: center;">$$ \forall P \in {{\mathbb{E}}}({{\mathbb{R}}}): ~ O + P = P; $$</div></li><li>для любой точки <span class="mathjax">$P$</span> существует единственный обратный элемент <span class="mathjax">$-P$</span>:
        <div class="mathjax" style="text-align: center;">$$ P + (-P) = O; $$</div></li><li>выполняется ассоциативный закон:
        <div class="mathjax" style="text-align: center;">$$ (P + Q) + F = P + (Q + F) = P + Q + F; $$</div></li><li>выполняется коммутативный закон:
        <div class="mathjax" style="text-align: center;">$$ P + Q = Q + P. $$</div></li></ul><p>Сложение точки с самой собой <span class="mathjax">$d$</span> раз обозначим как умножение точки на число <span class="mathjax">$d$</span>:</p><div class="mathjax" style="text-align: center;">$$ \underbrace{P + P + \ldots + P}_{d \text{ раз}} = d P. $$</div><h3 data-command-name="subsection" id="16_7_2_Эллиптические_кривые_над_конечным_полем">16.7.2. Эллиптические кривые над конечным полем</h3><p>Эллиптические кривые можно строить не только над полем рациональных чисел, но и над другими полями. То есть координатами точек могут выступать не только числа, принадлежащие полю рациональных чисел <span class="mathjax">${{\mathbb{R}}}$</span>, но и элементы поля комплексных чисел <span class="mathjax">$\mathbb{C}$</span> или конечного поля <span class="mathjax">${{\mathbb{F}}}$</span>. В криптографии нашли своё применение эллиптические кривые именно над конечными полями.</p><p>Далее будем рассматривать эллиптические кривые над конечным полем, являющимся кольцом вычетов по модулю нечётного простого<a name="N118482"><!--число!простое--></a> числа <span class="mathjax">$p$</span> (дискриминант не равен 0):</p><command name="gather*"><argument required="true">gather*</argument><content>
    E: <span class="nonbreaking-interword-space"> </span> y^2 = x^3 + a x + b, <line-break></line-break>
    a, b, x, y <command name="in"></command><command name="mathbb"><argument required="true">Z</argument></command>_p, <line-break></line-break>
   <command name="mathbb"><argument required="true">Z</argument></command>_p = 0, 1, 2, <command name="ldots"></command>, p-1.
</content></command><p>Возможна также более компактная запись:</p><div class="mathjax" style="text-align: center;">$$ E: ~ y^2 = x^3 + a x + b \mod p.$$</div><p>Точкой эллиптической кривой является пара чисел</p><div class="mathjax" style="text-align: center;">$$ (x; y): x, y \in {{\mathbb{Z}}}_p, $$</div><p>удовлетворяющая уравнению эллиптической кривой, определённой над конечным полем <span class="mathjax">${{\mathbb{Z}}}_p$</span>.</p><p>Операцию сложения двух точек <span class="mathjax">$P = (x_1; y_1)$</span> и <span class="mathjax">$Q = (x_2; y_2)$</span> определим точно так же, как и в случае кривой над полем вещественных чисел, описанном выше.</p><ol><li>Две точки <span class="mathjax">$P = (x_1; y_1)$</span> и <span class="mathjax">$Q = (x_2; y_2)$</span> эллиптической кривой, определённой над конечным полем <span class="mathjax">${{\mathbb{Z}}}_p$</span>, складываются по правилу:
        <div class="mathjax" style="text-align: center;">$$
            P + Q = R \equiv (x_3; y_3),
        $$</div> <div class="mathjax" style="text-align: center;">$$
            \begin{cases}
                x_3 = \lambda^2 - x_1 - x_2 \mod p,\\
                y_3 = - y_1 + \lambda (x_1 - x_3) \mod p,\\
            \end{cases}
        $$</div>
        где
        <div class="mathjax" style="text-align: center;">$$
            \lambda = \begin{cases}
                \dfrac{y_2 - y_1}{x_2 - x_1} \mod p, &amp; \text{ если } P \ne Q, \\
                \\
                \dfrac{3 x_1^2 + a}{2 y_1} \mod p, &amp; \text{ если } P = Q. \\
            \end{cases}
        $$</div></li><li>Сложение точки <span class="mathjax">$P=(x; y)$</span> c противоположной <line-break></line-break>
        <span class="mathjax">$(-P) = (x; -y)$</span> даёт точку в бесконечности <span class="mathjax">$O$</span>:
        <command name="gather*"><argument required="true">gather*</argument><content>
          P + (-P) = O, <line-break></line-break>
         (x_1; y_1) + (x_1; -y_1) = O, <line-break></line-break>
         (x_1; 0) + (x_1; 0) = O. 
        </content></command></li></ol><p>Мы рассматриваем эллиптические кривые над конечным полем <span class="mathjax">${{\mathbb{Z}}}_p$</span>, где <span class="mathjax">$p &gt; 3$</span> &ndash; простое<a name="N118588"><!--число!простое--></a> число, элементы <span class="mathjax">${{\mathbb{Z}}}_p$</span> &ndash; целые числа <span class="mathjax">$\{0, 1, 2, \ldots, p-1\}$</span>, то есть исследуем следующее уравнение двух переменных <span class="mathjax">$x, y \in {{\mathbb{Z}}}_p$</span>:</p><div class="mathjax" style="text-align: center;">$$ y^2 = x^3 + a x + b \mod p, $$</div><p>где <span class="mathjax">$a, b \in {{\mathbb{Z}}}_p$</span> &ndash; некоторые константы.</p><p>Как и в случае выше, множество точек над конечным полем <span class="mathjax">${{\mathbb{Z}}}_p$</span>, удовлетворяющих уравнению эллиптической кривой, вместе с точкой в бесконечности <span class="mathjax">$O$</span> образуют конечную группу <span class="mathjax">${{\mathbb{E}}}({{\mathbb{Z}}}_p)$</span> относительно описанного закона сложения:<a name="N118618"><!--группа!точек эллиптической кривой--></a></p><div class="mathjax" style="text-align: center;">$$ {{\mathbb{E}}}({{\mathbb{Z}}}_p) ~ \equiv~  O ~ \bigcup ~
        \left\{ (x; y) \in {{\mathbb{Z}}}_p \times {{\mathbb{Z}}}_p ~\Big|~ y^2 = x^3 + a x + b \mod p \right\}. $$</div><p>По теореме Хассе<a name="N118627"><!--теорема!Хассе--></a> порядок группы точек <span class="mathjax">$|{{\mathbb{E}}}({{\mathbb{Z}}}_p)|$</span> оценивается как</p><div class="mathjax" style="text-align: center;">$$ (\sqrt{p}-1)^2 \leq |{{\mathbb{E}}}({{\mathbb{Z}}}_p)| \leq (\sqrt{p}+1)^2, $$</div><p>или, в другой записи,</p><div class="mathjax" style="text-align: center;">$$ \Big| |{{\mathbb{E}}}({{\mathbb{Z}}}_p)| - p - 1 \Big| \leq 2 \sqrt{p}. $$</div><h3 data-command-name="subsection" id="16_7_3_Примеры_группы_точек">16.7.3. Примеры группы точек</h3><h4 data-command-name="subsubsection" id="Пример_1">Пример 1</h4><p>Пусть эллиптическая кривая задана уравнением</p><div class="mathjax" style="text-align: center;">$$ E: ~ y^2 = x^3 + 1 \mod 7. $$</div><p>Найдём все решения этого уравнения, а также количество точек <span class="mathjax">$|{{\mathbb{E}}}({{\mathbb{Z}}}_p)|$</span> на этой эллиптической кривой. Для нахождения решений уравнения составим следующую таблицу:</p><div style="display: flex; align-items: center; justify-content: center;"> <table style="border-collapse: collapse;"><colgroup><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"></colgroup><tr style="border-bottom: solid thin;border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$x$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">0</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">2</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">5</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">6</td></tr><tr style="border-bottom: solid thin;border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$y^2$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">2</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">2</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">0</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">2</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">0</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">0</td></tr><tr style="border-bottom: solid thin;border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$y_1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">0</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">0</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">0</td></tr><tr style="border-bottom: solid thin;border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$y_2 = - y_1 \mod p$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">6</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td></tr></table> </div><p>Выпишем все точки, принадлежащие данной эллиптической кривой <span class="mathjax">${{\mathbb{E}}}({{\mathbb{Z}}}_p)$</span>:</p><div class="mathjax" style="text-align: center;">$$
    \begin{array}{cccc}
        P_1 = O, &amp; P_2 = (0; 1), &amp; P_3 = (0; 6), &amp; P_4 = (1; 3), \\
        P_5 = (1; 4), &amp; P_6 = (2; 3), &amp; P_7 = (2; 4), &amp; P_8 = (3; 0), \\
        P_9 = (4; 3), &amp; P_{10} = (4; 4), &amp; P_{11} = (5; 0), &amp; P_{12} = (6; 0). \\
    \end{array}
$$</div><p>Получили</p><div class="mathjax" style="text-align: center;">$$ |{{\mathbb{E}}}({{\mathbb{Z}}}_p)| = 12. $$</div><p>Проверим выполнение неравенства Хассе:</p><div class="mathjax" style="text-align: center;">$$ \left| 12 - 7 - 1 \right| = 4 &lt; 2 \sqrt{7}. $$</div><p>Следовательно, неравенство Хассе выполняется.</p><p>Минимальное натуральное число <span class="mathjax">$s$</span> такое, что</p><div class="mathjax" style="text-align: center;">$$ \underbrace{P + P + \ldots + P}_{s} \equiv s P = O, $$</div><p>будем называть <em>порядком точки <span class="mathjax">$P$</span></em>.</p><!--%Теорема Лагранжа определяет порядок подгруппы.--><h4 data-command-name="subsubsection" id="Пример_2">Пример 2</h4><p>Группа точек эллиптической кривой</p><div class="mathjax" style="text-align: center;">$$ y^2 = x^3 + 5 x + 6 \mod 17 $$</div><p>состоит из точек:</p><div class="mathjax" style="text-align: center;">$$ \begin{array}{ccccccc}
    {{\mathbb{E}}}({{\mathbb{Z}}}_p) &amp; =~ \Big\{ &amp; (-8; \pm 7), &amp; (-7; \pm 6), &amp; (-6; \pm 7), &amp;   &amp; \\
             &amp;           &amp; (-5; \pm 3), &amp; (-3; \pm 7), &amp; (-1; 0),     &amp; O &amp; \Big\}. \\
\end{array} $$</div><p>Порядок группы:</p><div class="mathjax" style="text-align: center;">$$ |{{\mathbb{E}}}({{\mathbb{Z}}}_p)| = 12. $$</div><p>Порядок группы точек по теореме Хассе:</p><div class="mathjax" style="text-align: center;">$$ (\sqrt{p}-1)^2 \leq |{{\mathbb{E}}}({{\mathbb{Z}}}_p)| \leq (\sqrt{p}+1)^2, $$</div><div class="mathjax" style="text-align: center;">$$ 10 \leq 12 \leq 26. $$</div><p>Порядки возможных подгрупп: 2, 3, 4, 6 (все возможные делители порядка группы 12).</p><p>Найдём порядок точки <span class="mathjax">$A = (-8; 7)$</span>. Так как возможные порядки подгрупп (и всех точек группы) известны, нужно проверить только их.</p><ul><li><span class="mathjax">$2A = A + A = (-5; 3)$</span>:
<div class="mathjax" style="text-align: center;">$$\begin{aligned}
&amp; R = P + P, P = (-8; 7), \\
&amp; \lambda = \frac{3 x_P^2 + a}{2y_P} = \frac{3 \cdot (-8)^2 + 5}{2 \cdot 7} = 8 \mod 17, \\
&amp; x_R = \lambda^2 - 2x_P = 8^2 - 2 \cdot (-8) = -5 \mod 17, \\
&amp; y_R = \lambda (x_P - x_R) - y_P = 8 \cdot ((-8) - (-5)) - 7 = 3 \mod 17, \\
&amp; R = (-5; 3). \\
\end{aligned}$$</div></li><li><span class="mathjax">$3A = 2A + A = (-6; 7)$</span>:
<div class="mathjax" style="text-align: center;">$$\begin{aligned}
&amp; R = P + Q, P = (-8; 7), Q = (-5; 3), \\
&amp; \lambda = \frac{y_Q - y_P}{x_Q - x_P} = \frac{3 - 7}{-5 - (-8)} = -7 \mod 17, \\
&amp; x_R = \lambda^2 - x_P - x_Q = (-7)^2 - (-8) - (-5) = -6 \mod 17, \\
&amp; y_R = \lambda (x_P - x_R) - y_P = -7 \cdot (-8 - (-6)) - 7 = 7 \mod 17, \\
&amp; R = (-6; 7). \\
\end{aligned}$$</div></li><li><span class="mathjax">$4A = 2A + 2A = (-5; 3) + (-5; 3) = (-3; 7)$</span>.</li><li><span class="mathjax">$6A = 3A + 3A = (-6; 7) + (-6; 7) = (-1; 0)$</span>.</li><li><span class="mathjax">$12A = 6A + 6A = (-1; 0) + (-1; 0) = 0$</span>.</li></ul><p>Найденный порядок точки <span class="mathjax">$A = (-8; 7)$</span> равен 12, следовательно, она является генератором всей группы.</p><p>В таблице<span class="nonbreaking-interword-space"> </span><a href="#tab:elliptic-group-sample">[tab:elliptic-group-sample]</a> найдены порядки точек и циклические подгруппы группы точек <span class="mathjax">${{\mathbb{E}}}({{\mathbb{Z}}}_p)$</span> такой же эллиптической кривой</p><div class="mathjax" style="text-align: center;">$$ y^2 = x^3 + 5 x + 6 \mod 17. $$</div><p>Группа циклическая, число генераторов:</p><div class="mathjax" style="text-align: center;">$$ \varphi(12) = 4. $$</div><p>Циклические подгруппы:</p><div class="mathjax" style="text-align: center;">$$ {{\mathbb{G}}}^{(2)}, ~ {{\mathbb{G}}}^{(3)}, ~ {{\mathbb{G}}}^{(4)}, ~ {{\mathbb{G}}}^{(6)}, $$</div><p>верхний индекс обозначает порядок подгруппы.</p><figure style="margin-left: auto; margin-right: auto; display: flex; flex-wrap: wrap; align-items: baseline; justify-content: center; width: fit-content; height: fit-content; ">
    <table style="border-collapse: collapse;"><colgroup><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"></colgroup><tr style="border-bottom: solid thin;border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">Элемент</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: left;white-space: nowrap;">Порождаемая группа или подгруппа</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">Порядок</td></tr><tr style="border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$(-8; \pm 7) $</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: left;white-space: nowrap;">Вся группа <span class="mathjax">${{\mathbb{E}}}({{\mathbb{Z}}}_p)$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">12, генератор</td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$(-7; \pm 6) $</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: left;white-space: nowrap;">Вся группа <span class="mathjax">${{\mathbb{E}}}({{\mathbb{Z}}}_p)$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">12, генератор</td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$(-6; \pm 7) $</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: left;white-space: nowrap;"><span class="mathjax">${{\mathbb{G}}}^{(4)} ~=~ \left\{ ~ (-6; \pm 7), ~ (-1; 0), ~ O ~ \right\}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">4</td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$(-5; \pm 3) $</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: left;white-space: nowrap;"><span class="mathjax">${{\mathbb{G}}}^{(6)} ~=~ \left\{ ~ (-5; \pm 3), ~ (-3; \pm 7), ~ (-1; 0), ~ O ~ \right\}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">6</td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$(-3; \pm 7) $</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: left;white-space: nowrap;"><span class="mathjax">${{\mathbb{G}}}^{(3)} ~=~ \left\{ ~ (-3; \pm 7), ~ O ~ \right\}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">3</td></tr><tr style="border-bottom: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$(-1; 0)     $</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: left;white-space: nowrap;"><span class="mathjax">${{\mathbb{G}}}^{(2)} ~=~ \left\{ ~ (-1; 0), ~ O ~ \right\}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">2</td></tr></table>
    <figcaption style="flex-basis: 100%; text-align: center;">Таблица 16.8 &mdash; Генераторы и циклические подгруппы группы точек эллиптической кривой<a name="#tab:elliptic-group-sample"></a></figcaption></figure><h3 data-command-name="subsection" id="16_7_4_Эллиптические_кривые_в_скрученной_форме_Эдвардса">16.7.4. Эллиптические кривые в скрученной форме Эдвардса</h3><p>Любую эллиптическую кривую с помощью замены координат можно представить в рассмотренной ранее форме Вейерштрасса. Используя данное представление мы ранее ввели операцию сложения точек, умножения точки на число, смогли описать группу точек и циклическую подгруппу. Однако в отдельных случаях эллиптические кривые можно записать в другой, более удобной для частных задач форме. Например, любые эллиптические кривые над алгебраически замкнутым полем можно задать с помощью следующего уравнения:</p><div class="mathjax" style="text-align: center;">$$ \begin{array}{l}
	ax^2+y^2=1+dx^2y^2.
\end{array} $$</div><p>Примеры кривых, заданных этим уравнениям при различных значениях <span class="mathjax">$d$</span>, приведены на рис.<span class="nonbreaking-interword-space"> </span><a href="16_7_Gruppi_tochek.html#pic:Edward-curves">16.2</a>. Данное кривые в указанном представлении называются эллиптическими кривыми в скрученной форме Эдвардса (англ. <span lang="en"><i>Twisted Edwards Curves</i></span>, <a href="Literatura.html#Bernstein:Birkner:Joye:Lange:Peters:2008">[102]</a>).</p><figure style="margin-left: auto; margin-right: auto; display: flex; flex-wrap: wrap; align-items: baseline; justify-content: center; width: fit-content; height: fit-content; width: 50%;"><a name="pic:Edward-curves" style="vertical-align: top; align-self: start;"></a><img src="images/EF4F14D48241AB57C5B12DAB3493634D.png" style="width: 100%"><figcaption style="flex-basis: 100%; text-align: center;">Рис. 16.2 &mdash; Эллиптические кривые в скрученной форме Эдвардса при значениях (от внешней фигуры ко внутренней) <span class="mathjax">$d = +0{,}9, -\sqrt{8}, -300$</span></figcaption></figure><p>Для данной формы формулы сложения точек задаются одним и тем же способом для любых случаев. В этом важное отличие от формы Вейерштрасса, для которой есть частный случай сложения точки самой с собой (с отдельной формулой вычисления угла наклона касательной). Формулы сложения выглядят так:</p><div class="mathjax" style="text-align: center;">$$ \begin{array}{ll}
	P + Q = R \equiv (x_3; y_3), \\
	
	\begin{cases}
		x_3 = \frac{x_1 y_2 + x_2 y_1}{ 1 + dx_1x_2y_1y_2},\\
		y_3 = \frac{ y_1 y_2 - x_1 x_2 }{1 - d x_1 x_2 y_1 y_2}.\\
	\end{cases}

\end{array} $$</div><p>При переходе к построению кривых над конечным полем, оказывается, что не все кривые, представимые в форме Вейерштрасса, могут быть представлены в скрученной форме Эдвардса. Для этого необходимо, чтобы порядок кривой <span class="mathjax">$\|E\|$</span> делился на <span class="mathjax">$4$</span>. Однако если такие кривые использовать для криптографических целей, это даёт значимые преимущества:</p><ul><li>меньшая трудоёмкость операций сложения точек;</li><li>отсутствие частных случаев для формул сложения (усложнение атак по сторонним каналам с различением времени);</li></ul><h3 data-command-name="subsection" id="16_7_5_Конвертация_из_скрученной_формы_Эдвардса_в_форму_Вейерштрасса">16.7.5. Конвертация из скрученной формы Эдвардса в форму Вейерштрасса</h3><p>Кривая в скрученной форме Эдвардса:</p><div class="mathjax" style="text-align: center;">$$eu^2+v^2=1+du^2v^2 \mod p.$$</div><line-break></line-break><p>Кривая в форме Вейерштрасса:</p><line-break></line-break><div class="mathjax" style="text-align: center;">$$ y^{2} = x^{3} + ax + b \mod p.$$</div><p>Зная коэффициенты <span class="mathjax">$d$</span> и <span class="mathjax">$e$</span> кривой в скрученной форме Эдвардса можно найти коэффициенты <span class="mathjax">$a$</span> и <span class="mathjax">$b$</span> эквивалентной кривой в форме Вейерштрасса:</p><div class="mathjax" style="text-align: center;">$$ \begin{array}{l}
	s = (e - d)/4, \\
    t = (e + d)/6, \\
	a = s^2 - 3t^2, \\
	b = 2t^3 - ts^2. \\
\end{array} $$</div><p>И определить правила преобразования координат <span class="mathjax">$(u, v)$</span> и <span class="mathjax">$(x, y)$</span> между двумя кривыми:</p><div class="mathjax" style="text-align: center;">$$ \begin{array}{l}
(u,v) \longrightarrow(x, y)= (\frac{s(1+v)}{1-v}+t,\frac{s(1+v)}{(1-v)u}), \\
(x,y) \longrightarrow(u, v)= (\frac{x-t}{y}, \frac{x-t-s}{x-t+s}). \\
\end{array} $$</div><p>Нахождение коэффициентов для кривой в скрученной форме Эдвардса по эквивалентной в форме Вейерштрасса является более сложной и нетривиальной задачей, включающей нахождение корней кубического уравнения <span class="mathjax">$x^{3} + ax + b = 0 \mod p$</span>. Кроме того, как было сказано ранее, не все кривые в форме Вейерштрасса имеют эквивалентную кривую в скрученной форме Эдвардса.</p><h3 data-command-name="subsection" id="16_7_6_Пример_группы_точек_кривой_в_скрученной_форме_Эдвардса">16.7.6. Пример группы точек кривой в скрученной форме Эдвардса</h3><p>Кривая <span class="mathjax">$x^2+y^2=1+6x^2y^2 \mod 11$</span>.</p><p>Все точки кривой:</p><div class="mathjax" style="text-align: center;">$$ \begin{array}{lll}
(0; 1), &amp; (2; 5), &amp; (5; 2), \\
(1; 0), &amp; (5; 9), &amp; (2; 6), \\
(0; 10), &amp; (9; 5), &amp; (6; 9), \\
(10; 0), &amp; (6; 2), &amp; (9; 5). \\
\end{array} $$</div><p>Нейтральным элементом является точка <span class="mathjax">$(0; 1)$</span>.</p><p>Данная группа точек является циклической группой, её генератором выступает точка <span class="mathjax">$(2; 5)$</span> (рис.<span class="nonbreaking-interword-space"> </span><a href="16_7_Gruppi_tochek.html#pic:Twisted-Edwards-Curve-Example">16.3</a>):</p><div class="mathjax" style="text-align: center;">$$ \begin{array}{lllllll}
(2; 5) &amp; \to (6; 9) &amp; \to (10; 0) &amp; \to (6; 2) &amp; \to (2; 6) &amp; \to (0; 10) &amp; \to \\
       &amp; \to (9; 6) &amp; \to (5; 2)  &amp; \to (1; 0) &amp; \to (5; 9) &amp; \to (9; 5)  &amp; \to (0; 1).
\end{array} $$</div><figure style="margin-left: auto; margin-right: auto; display: flex; flex-wrap: wrap; align-items: baseline; justify-content: center; width: fit-content; height: fit-content; width: 100%;"><a name="pic:Twisted-Edwards-Curve-Example" style="vertical-align: top; align-self: start;"></a><img src="images/D2074D131DCC18A27D242A857EEAFBF2.png" style="width: 100%"><figcaption style="flex-basis: 100%; text-align: center;">Рис. 16.3 &mdash; Группа точек эллиптической кривой в скрученной форме Эдвардса <span class="mathjax">$x^2+y^2=1+6x^2y^2 \mod 11$</span></figcaption></figure><p>Данная группа изоморфна группе вычетов по сложению <span class="mathjax">${{\mathbb{Z}}}_{12}$</span>. Можно удостовериться, что сложение двух точек <span class="mathjax">$P (6; 9)$</span> и <span class="mathjax">$Q(10; 0)$</span> будет соответствовать результату сложения элементов &laquo;2&raquo; и &laquo;3&raquo; в группе <span class="mathjax">${{\mathbb{Z}}}_{12}$</span>:</p><div class="mathjax" style="text-align: center;">$$ \begin{array}{l}
	R = P (6; 9) + Q (10; 0), \\
	x_R = \frac{x_1 y_2 + x_2 y_1}{1 + d x_1 x_2 y_1 y_2} = \frac{6 \times 0 + 10 \times 9}{1 + 6 \times 6 \times 10 \times 9 \times 0} = \frac{90}{1} = 2 \mod 11, \\
	y_R = \frac{y_1 y_2 - x_1 x_2}{1 - d x_1 x_2 y_1 y_2} = \frac{9 \times 0 - 6 \times 10}{1 - 6 \times 6 \times 10 \times 9 \times 0} = \frac{-60}{1} = 6 \mod 11, \\
	R (2; 6) \equiv \text{&lt;&lt;5&gt;&gt;}.
\end{array} $$</div><p>Группа не имеет эквивалентной группы точек эллиптической кривой в форме Вейерштрасса над конечным полем <span class="mathjax">${{\mathbb{F}}}_{11}$</span>. Группа точек соответствующей кривой <span class="mathjax">$y^2 = x^3 + 6 \bmod 11$</span> имеет только 11 элементов в группе.</p><p><a name="N119225"><!--группа!точек эллиптической кривой|)--></a></p><nav aria-label="Page navigation example"><ul class="pagination justify-content-center"><li class="page-item"><a class="page-link" href="16_6_Psevdoprostie_chisla.html">&#129080; 16_6_Psevdoprostie_chisla</a></li><li class="page-item"><a class="page-link" href="16_8_Klassi_slozhnosti_zadach.html">16_8_Klassi_slozhnosti_zadach &#129082;</a></li></ul></nav></div><script>
window.MathJax = {
  loader: {
    load: ['[tex]/tagformat'],
  },
  options: {
    processHtmlClass: 'mathjax'
  },
  tex: {
    packages: {
      '[+]': ['base', 'ams', 'physics', 'textcomp']
    },
    inlineMath: [['$', '$']],
  },
};
</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script async="yes" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></body></html>