<!DOCTYPE html SYSTEM "about:legacy-compat">
<html><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><style type="text/css"> 
div.toc-item-h2 {
  padding-left: 2em;
}
div.toc-item-h3 {
  padding-left: 4em;
}
div.toc-item-h4 {
  padding-left: 6em;
}
div.toc-item-h5 {
  padding-left: 8em;
}
div.toc-item-h6 {
  padding-left: 10em;
}
</style><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" rel="stylesheet"><style type="text/css"> 
span.small {
  font-size: 90%
}
span.tiny {
  font-size: 50%
}
</style><style type="text/css"> 
div.mathjax {
  padding-top: .5em;
  padding-bottom: .5em;
}
</style></head><body><div class="container"><h2 data-command-name="section" id="9_3_Эллиптические_кривые">9.3. Эллиптические кривые</h2><p>Существуют аналоги криптосистемы Эль-Гамаля, в которых вместо проблемы дискретного логарифма в мультипликативных полях используется проблема дискретного логарифма в группах точек эллиптических кривых над конечными полями (обычно <span class="mathjax">$GF(p)$</span> либо <span class="mathjax">$GF(2^n)$</span>). Математическое описание данных полей приведено в разделе<span class="nonbreaking-interword-space"> </span><a href="#section-math-ec-groups">16.7</a>. Нас же интересует следующий факт: для группы точек эллиптической кривой над конечным полем <span class="mathjax">${\mathbb{E}}$</span> существует быстро выполнимая операция &ndash; умножение целого числа <span class="mathjax">$x$</span> на точку <span class="mathjax">$A$</span> (суммирование точки самой с собой целое число раз):</p><div class="mathjax" style="text-align: center;">$$ \begin{array}{l}
	x \in {\mathbb{Z}}, \\
	A, B \in {\mathbb{E}}, \\
	B = x \times A. \\
\end{array} $$</div><p>И получение исходной точки <span class="mathjax">$A$</span> при известных <span class="mathjax">$B$</span> и <span class="mathjax">$x$</span> (&laquo;деление&raquo; точки на целое число), и получение целого числа <span class="mathjax">$x$</span> при известных <span class="mathjax">$A$</span> и <span class="mathjax">$B$</span> являются сложными задачами. На этом и основаны алгоритмы шифрования и электронной подписи с использованием эллиптических кривых над конечными полями.</p><h3 data-command-name="subsection" id="9_3_1_ECIES">9.3.1. ECIES</h3><p>Схема ECIES (англ. <span lang="en"><i>Elliptic Curve Integrated Encryption Scheme</i></span>) является частью сразу нескольких стандартов, в том числе ANSI X9.63, IEEE 1363a, ISO 18033-2 и SECG SEC 1. Эти стандарты по-разному описывают выбор параметров схемы<span class="nonbreaking-interword-space"> </span><a href="Literatura.html#Martinez:Encinas:Avila:2010">[66]</a>:</p><ul><li>ENC (англ. <span lang="en"><i>Encryption</i></span>) &ndash; блочный режим шифрования (в том числе простое гаммирование, 3DES<a name="N93673"><!--шифр!3DES--></a>, AES<a name="N93679"><!--шифр!AES--></a>, MISTY1<a name="N93685"><!--шифр!MISTY1--></a>, CAST-128<a name="N93691"><!--шифр!CAST-128--></a>, Camelia<a name="N93697"><!--шифр!Camelia--></a>, SEED<a name="N93703"><!--шифр!SEED--></a>);</li><li>KA (англ. <span lang="en"><i>Key Agreement</i></span>) &ndash; метод для генерации общего секрета двумя сторонами (оригинальный метод, описанный в протоколе Диффи<span class="nonbreaking-interword-space"> </span>&mdash;<span class="nonbreaking-interword-space"> </span>Хеллмана<a name="N93728"><!--протокол!Диффи—Хеллмана--></a><span class="nonbreaking-interword-space"> </span><a href="Literatura.html#Diffie:Hellman:1976">[30]</a> либо его модификации<span class="nonbreaking-interword-space"> </span><a href="Literatura.html#Miller:1986">[76]</a>);</li><li>KDF (англ. <span lang="en"><i>Key Derivation Function</i></span>) &ndash; метод получения ключей из основной и дополнительной информации;</li><li>HASH &ndash; криптографическая хеш-функция (SHA-1<a name="N93764"><!--хеш-функция!SHA-1--></a>, SHA-2<a name="N93770"><!--хеш-функция!SHA-2--></a>, RIPEMD<a name="N93776"><!--хеш-функция!RIPEMD--></a>, WHIRLPOOL<a name="N93782"><!--хеш-функция!WHIRLPOOL--></a>);</li><li>MAC (англ. <span lang="en"><i>Message Authentication Code</i></span>) &ndash; функция вычисления имитовставки<a name="N93803"><!--имитовставка--></a> (DEA, ANSI X9.71, MAC1, HMAC-SHA-1, HMAC-SHA-2, HMAC-RIPEMD, CMAC-AES).</li></ul><p>К параметрам относится выбор группы точек над эллиптической кривой <span class="mathjax">${\mathbb{E}}$</span>, а также некоторой большой циклической подгруппы <span class="mathjax">${\mathbb{G}}$</span> в группе <span class="mathjax">${\mathbb{E}}$</span>, задаваемой точкой-генератором <span class="mathjax">$G$</span>. Мощность циклической группы обозначается <span class="mathjax">$n$</span>.</p><div class="mathjax" style="text-align: center;">$$n = \left\| {\mathbb{G}} \right\|.$$</div><p>Предположим, что в нашем сценарии Алиса хочет послать сообщение Бобу. У Алисы есть открытый ключ Боба <span class="mathjax">$P_B$</span>, а у Боба &ndash; соответствующий ему закрытый ключ <span class="mathjax">$p_B$</span>. Для отправки сообщения Алиса также сгенерирует временную (англ. <span lang="en"><i>ephemeral</i></span>) пару из открытого (<span class="mathjax">$P_A$</span>) и закрытого (<span class="mathjax">$p_A$</span>) ключей. Закрытыми ключами являются некоторые натуральные числа, меньшие <span class="mathjax">$n$</span>, а открытыми ключами являются произведения закрытых на точку-генератор <span class="mathjax">$G$</span>:</p><div class="mathjax" style="text-align: center;">$$ \begin{array}{ll}
	p_A \in {{\mathbb{Z}}}, &amp; p_B \in {{\mathbb{Z}}}, \\
	1 &lt; p_A &lt; n, &amp; 1 &lt; p_B &lt; n, \\
	P_A = p_A \times G, &amp; P_B = p_B \times G, \\
	P_A \in {\mathbb{G}} \in {\mathbb{E}}, &amp; P_B \in {\mathbb{G}} \in {\mathbb{E}}.\\
\end{array} $$</div><ol><li>С помощью метода генерации общего секрета KA Алиса вычисляет общий секрет <span class="mathjax">$s$</span>. В случае использования оригинального протокола Диффи<span class="nonbreaking-interword-space"> </span>&mdash;<span class="nonbreaking-interword-space"> </span>Хеллмана<a name="N93872"><!--протокол!Диффи—Хеллмана--></a> общим секретом будет являться результат умножения закрытого ключа Алисы на открытый ключ Боба <span class="mathjax">$s = p_a \times P_B$</span>.</li><li>Используя полученный общий секрет <span class="mathjax">$s$</span> и метод получения ключей из ключевой и дополнительной информации KDF, Алиса получает ключ шифрования <span class="mathjax">$k_{ENC}$</span>, а также ключ для вычисления имитовставки <span class="mathjax">$k_{MAC}$</span>.</li><li>С помощью симметричного алгоритма шифрования ENC Алиса шифрует открытое сообщение <span class="mathjax">$m$</span> ключом <span class="mathjax">$k_{ENC}$</span> и получает шифртекст <span class="mathjax">$c$</span>.</li><li>Взяв ключ <span class="mathjax">$k_{MAC}$</span>, зашифрованное сообщение <span class="mathjax">$c$</span> и другие заранее обговорённые сторонами параметры, Алиса вычисляет тэг сообщения (англ. <span lang="en"><i>tag</i></span>) с помощью функции MAC.</li><li>Алиса отсылает Бобу <span class="mathjax">$\{P_A, tag, c\}$</span>.</li></ol><p>В процессе расшифрования Боб последовательно получает общий секрет <span class="mathjax">$s = p_b \times P_A$</span>, ключи шифрования <span class="mathjax">$k_{ENC}$</span> и имитовставки <span class="mathjax">$k_{MAC}$</span>, вычисляет тэг сообщения и сверяет его с полученным тэгом. В случае совпадения вычисленного и полученного тэгов Боб расшифровывает исходное сообщение <span class="mathjax">$m$</span> из шифртекста <span class="mathjax">$c$</span> с помощью ключа шифрования <span class="mathjax">$k_{ENC}$</span>.</p><h3 data-command-name="subsection" id="9_3_2_Российский_стандарт_ЭП_ГОСТ_Р_34_10_2001">9.3.2. Российский стандарт ЭП <command name="protect"></command><line-break></line-break> ГОСТ Р 34.10-2001</h3><p>Пусть имеются две стороны <span class="mathjax">$A$</span> и <span class="mathjax">$B$</span> и канал связи между ними. Сторона <span class="mathjax">$A$</span> желает передать сообщение <span class="mathjax">$M$</span> стороне <span class="mathjax">$B$</span> и подписать его. Сторона <span class="mathjax">$B$</span> должна проверить правильность подписи, то есть аутентифицировать сторону <span class="mathjax">$A$</span>.</p><p><span class="mathjax">$A$</span> формирует открытый ключ следующим образом.</p><ol><li>Выбирает простое<a name="N94003"><!--число!простое--></a> число <span class="mathjax">$p &gt; 2^{255}$</span>.</li><li>Записывает уравнение эллиптической кривой:
        <div class="mathjax" style="text-align: center;">$$ E: ~ y^2 = x^3 + a x + b \mod p, $$</div>
        которое определяет группу точек эллиптической кривой <span class="mathjax">${{\mathbb{E}}}({{\mathbb{Z}}}_p)$</span>.
        Выбирает группу, задавая либо случайные числа <span class="mathjax">$0 &lt; a, b &lt; p-1$</span>, либо инвариант <span class="mathjax">$J(E)$</span>:
        <div class="mathjax" style="text-align: center;">$$ J(E) = 1728 \frac{4 a^3}{4 a^3 + 27 b^2} \mod p. $$</div>
        Если кривая задаётся инвариантом <span class="mathjax">$J(E) \in {{\mathbb{Z}}}_p$</span>, то он выбирается случайно из интервала <span class="mathjax">$0 &lt; J(E) &lt; 1728$</span>. Для нахождения <span class="mathjax">$a,b$</span> вычисляется
        <div class="mathjax" style="text-align: center;">$$ K = \frac{J(E)}{1728 - J(E)}, $$</div>
        <div class="mathjax" style="text-align: center;">$$ \begin{array}{l}
            a = 3 K \mod p, \\
            b = 2 K \mod p. \\
        \end{array} $$</div></li><li>Пусть <span class="mathjax">$m$</span> &ndash; порядок группы точек эллиптической кривой <span class="mathjax">${{\mathbb{E}}}({{\mathbb{Z}}}_p)$</span>. <span class="nonbreaking-interword-space"> </span>Пользователь <span class="mathjax">$A$</span> подбирает число <span class="mathjax">$n$</span> и простое<a name="N94059"><!--число!простое--></a> число <span class="mathjax">$q$</span> такие, что
        <div class="mathjax" style="text-align: center;">$$ m = n q, ~ 2^{254} &lt; q &lt; 2^{256}, ~ n \geq 1, $$</div>
        где <span class="mathjax">$q$</span> &ndash; делитель порядка группы.

        В циклической подгруппе порядка <span class="mathjax">$q$</span> выбирается точка
        <div class="mathjax" style="text-align: center;">$$ P \in {{\mathbb{E}}}({{\mathbb{Z}}}_p): ~ q P \equiv 0. $$</div></li><li>Случайно выбирает число <span class="mathjax">$d$</span> и вычисляет точку <span class="mathjax">$Q = d P$</span>.</li><li>Формирует закрытый и открытый ключи:
        <div class="mathjax" style="text-align: center;">$$ {\textrm{SK}}= (d), ~ {\textrm{PK}}= (p, E, q, P, Q). $$</div></li></ol><p>Теперь сторона <span class="mathjax">$A$</span> создаёт свою цифровую подпись <span class="mathjax">$S(M)$</span> сообщения <span class="mathjax">$M$</span>, выполняя следующие действия.</p><ol><li>Вычисляет <span class="mathjax">$\alpha = h(M)$</span>, где <span class="mathjax">$h$</span> &ndash; криптографическая хеш-функ<wbr></wbr>ция, определённая стандартом ГОСТ Р 34.11-94. В российском стандарте длина <span class="mathjax">$h(M)$</span> равна 256 бит.</li><li>Вычисляет <span class="mathjax">$e = \alpha \mod q$</span>.</li><li>Случайно выбирает число <span class="mathjax">$k$</span> и вычисляет точку
        <div class="mathjax" style="text-align: center;">$$ C = k P = (x_c, y_c). $$</div></li><li>Вычисляет <span class="mathjax">$r = x_c \mod q$</span>.
	Если <span class="mathjax">$r = 0$</span>, то выбирает другое <span class="mathjax">$k$</span>.</li><li>Вычисляет <span class="mathjax">$s = k e + r d \mod q$</span>.</li><li>Формирует подпись
        <div class="mathjax" style="text-align: center;">$$ S(M) = (r, s). $$</div></li></ol><p>Сторона <span class="mathjax">$A$</span> передаёт стороне <span class="mathjax">$B$</span> сообщение с подписью</p><div class="mathjax" style="text-align: center;">$$ (M, ~ S(M)). $$</div><p>Сторона <span class="mathjax">$B$</span> проверяет подпись <span class="mathjax">$(r,s)$</span>, выполняя процедуру проверки подписи.</p><ol><li>Вычисляет <span class="mathjax">$\alpha = h(M)$</span> и <span class="mathjax">$e = \alpha \mod q$</span>. Если <span class="mathjax">$e = 0$</span>, то определяет <span class="mathjax">$e = 1$</span>.</li><li>Вычисляет <span class="mathjax">$e^{-1} \mod q$</span>.</li><li>Проверяет условия <span class="mathjax">$r &lt; q, ~ r &lt; s$</span>. Если эти условия не выполняются, то подпись отвергается. Если условия выполняются, то процедура продолжается.</li><li>Вычисляет переменные:
        <div class="mathjax" style="text-align: center;">$$ \begin{array}{l}
            a = s e^{-1} \mod q, \\
            b = -r e^{-1} \mod q. \\
        \end{array} $$</div></li><li>Вычисляет точку:
        <div class="mathjax" style="text-align: center;">$$ \tilde{C} = a P + b Q = (\tilde{x}_c, \tilde{y}_c). $$</div>
        Если подпись верна, то должны получить исходную точку <span class="mathjax">$C$</span>.</li><li>Проверяет условие <span class="mathjax">$\tilde{x}_{c} \mod q = r$</span>. Если условие выполняется, то подпись принимается, в противном случае &ndash; отвергается.</li></ol><p>Рассмотрим вычислительную сложность вскрытия подписи. Предположим, что криптоаналитик ставит своей задачей определение закрытого ключа <span class="mathjax">$d$</span>. Как известно, эта задача является трудной. Для подтверждения этого можно привести такой факт. Был поставлен следующий эксперимент: выбрали число <span class="mathjax">$p = 2^{97}$</span> и 1200 персональных компьютеров, которые работали над этой задачей в 16 странах мира, используя процессоры с тактовой частотой 200 МГц. Задача была решена за 53 дня круглосуточной работы. Если взять <span class="mathjax">$p = 2^{256}$</span>, то на решение такой задачи при наличии одного компьютера с частотой процессора 2 ГГц потребуется <span class="mathjax">$10^{22}$</span> лет.</p><h3 data-command-name="subsection" id="9_3_3_EdDSA_и_Ed25519">9.3.3. EdDSA и Ed25519</h3><p>Схема цифровой подписи EdDSA использует эллиптическую кривую, представленную в скрученной форме Эдвардса (см. раздел<span class="nonbreaking-interword-space"> </span><a href="#sec:twisted-edward-curves">16.7.4</a>). В данной схеме используются следующие параметры:</p><ul><li>конечное поле <span class="mathjax">${{\mathbb{F}}}_{p}$</span>, где <span class="mathjax">$p$</span> &ndash; большое простое число;</li><li>группа точек эллиптической кривой в скрученной форме Эдвардса <span class="mathjax">$E$</span> над полем <span class="mathjax">${{\mathbb{F}}}_{p}$</span> порядка <span class="mathjax">$Ord(E) = 2^c l$</span>, где <span class="mathjax">$l$</span> &ndash; большое простое число, <span class="mathjax">$c$</span> &ndash; целое;</li><li>точка, генератор <span class="mathjax">$G$</span> циклической подгруппы порядка <span class="mathjax">$l$</span>;</li><li>криптографическая хеш-функция <span class="mathjax">$H$</span>, имеющая выход <span class="mathjax">$2b$</span> бит, <span class="mathjax">$b &gt; 1 + log_2 p$</span>, чтобы элементы поля <span class="mathjax">${{\mathbb{F}}}_{p}$</span> и координаты точек <span class="mathjax">$E$</span> могли быть представлены в виде <span class="mathjax">$b$</span>-битовых строк.</li></ul><p>Параметр <span class="mathjax">$l$</span> должен быть достаточно большим, чтобы <span class="mathjax">$\rho$</span>-метод Полларда для дискретного логарифмирования требовал большого количества операций для вычисления &laquo;логарифма&raquo; &ndash; не менее <span class="mathjax">$\sqrt{l \pi / 4}$</span> сложений точек в группе. Рекомендуется, чтобы значение <span class="mathjax">$l$</span> превышало <span class="mathjax">$2^{200}$</span> &ndash; для получения не менее <span class="mathjax">$\approx 2^{99{,}8}$</span> сложений точек в <span class="mathjax">$\rho$</span>-методе Полларда.</p><p>В качестве закрытого ключа каждый участник выбирает некоторую <span class="mathjax">$b$</span>-битовую строку <span class="mathjax">$k$</span>. Данная строка хешируется выбранной криптографической хеш-функцией <span class="mathjax">$H$</span>, после чего последние <span class="mathjax">$b$</span>-бит трактуются как целое число в кодировке <span lang="en"><i>little endian</i></span> <span class="mathjax">$s$</span> и формируется открытый ключ <span class="mathjax">$A \in E$</span>:</p><div class="mathjax" style="text-align: center;">$$ \begin{array}{l}
	s = H_{0, \dots, b-1}(k),\\
	A = s \times G.
\end{array} $$</div><p>Электронная цифровая подпись <span class="mathjax">$(R, S)$</span> вычисляется следующим образом:</p><ol><li><span class="mathjax">$r = H( H_{b,\dots,2b-1}(k) \| M )$</span> &ndash; аналог случайного параметра <span class="mathjax">$k$</span> из схемы электронной цифровой подписи Эль-Гамаля;</li><li><span class="mathjax">$R = r \times G$</span>;</li><li><span class="mathjax">$S = r + H( R \| A \| M ) \times s \bmod l$</span>;</li></ol><p>Для валидации подписи получатель, знающий параметры схемы и открытый ключ отправителя <span class="mathjax">$A$</span>, проверяет выполнение равенства:</p><div class="mathjax" style="text-align: center;">$$
	2^c S \times G = 2^c \times R + 2^c H( R \| A \| M ) \times A.
$$</div><p>Корректность схемы можно проверить через раскрытие значения <span class="mathjax">$S$</span>:</p><div class="mathjax" style="text-align: center;">$$ \begin{array}{ll}
2^c S \times G &amp; = 2^c ( r + H( R \| A \| M ) \times s ) \times G = \\
               &amp; = 2^c r \times G + 2^c H( R \| A \| M ) s \times G = \\
               &amp; = 2^c R + 2^c H( R \| A \| M ) \times A.
\end{array} $$</div><p>Ed25519 задаёт конкретные параметры схемы EdDSA следующим образом (<a href="Literatura.html#Bernstein:Duif:Lange:Schwabe:Yang:2011">[45]</a>):</p><ul><li>порядок конечного поля является простым числом <span class="mathjax">$p = 2^{255}-19$</span>;</li><li>коэффициенты эллиптической кривой в скрученной форме Эдвардса <span class="mathjax">$e = -1$</span> и <span class="mathjax">$d = \frac{121665}{121666}$</span>:
<div class="mathjax" style="text-align: center;">$$
-x^2 + y^2 = 1 - \frac{121665}{121666}x^2y^2 \mod p;
$$</div></li><li>базовая точка <span class="mathjax">$G$</span> имеет координату <span class="mathjax">$y = 4/5 \bmod q$</span>, координата <span class="mathjax">$x$</span> &ndash; положительная;</li><li>порядок базовой точки <span class="mathjax">$G$</span> является большим простым числом и равен <span class="mathjax">$l = 2^{252} + 27742317777372353535851937790883648493$</span>;</li><li>криптографическая хеш-функция SHA-256<a name="N94426"><!--хеш-функция!SHA-256--></a> (<span class="mathjax">$b = 256$</span>).</li></ul><p>Выбранная группа точек бирационально эквивалентна группе точек над эллиптической кривой в форме Монтгомери Curve25519 (<a href="Literatura.html#Bernstein:2006">[12]</a>). Выбранная базовая точка также соответствует базовой точке, предложенной для Curve25519. Так как сложения в скрученной форме Эдвардса выполняются быстрее, чем в форме Вейерштрасса и в форме Монтгомери, группу Ed25519 можно использовать для ускорения вычислений в тех случаях, когда в качестве параметров выбрана группа точек кривой Curve25519.</p><p>Схема EdDSA с параметрами Ed25519 используется (<a href="Literatura.html#IANIX:Ed25519:2021">[101]</a>) в защищённых сетевых протоколах (SSH<a name="N94444"><!--протокол!SSH--></a>, I2P<a name="N94450"><!--протокол!I2P--></a>, IPSec<a name="N94456"><!--протокол!IPSec--></a>, Tor<a name="N94462"><!--протокол!Tor--></a>), криптографических библиотеках (GnuPG, Java 15 JCE, OpenSSH 6.5) и стандартах (S/MIME 4.0).</p><nav aria-label="Page navigation example"><ul class="pagination justify-content-center"><li class="page-item"><a class="page-link" href="9_2_Kriptosistema_El_Gamalja.html">&#129080; 9_2_Kriptosistema_El_Gamalja</a></li><li class="page-item"><a class="page-link" href="9_4_Dlini_kljuchey.html">9_4_Dlini_kljuchey &#129082;</a></li></ul></nav></div><script>
window.MathJax = {
  loader: {
    load: ['[tex]/tagformat'],
  },
  options: {
    processHtmlClass: 'mathjax'
  },
  tex: {
    packages: {
      '[+]': ['base', 'ams', 'physics', 'textcomp']
    },
    inlineMath: [['$', '$']],
  },
};
</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script async="yes" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></body></html>