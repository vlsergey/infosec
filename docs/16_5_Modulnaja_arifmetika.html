<!DOCTYPE html SYSTEM "about:legacy-compat">
<html><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><style type="text/css"> 
div.toc-item-h2 {
  padding-left: 2em;
}
div.toc-item-h3 {
  padding-left: 4em;
}
div.toc-item-h4 {
  padding-left: 6em;
}
div.toc-item-h5 {
  padding-left: 8em;
}
div.toc-item-h6 {
  padding-left: 10em;
}
</style><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" rel="stylesheet"><style type="text/css"> 
span.small {
  font-size: 90%
}
span.tiny {
  font-size: 50%
}
</style><style type="text/css"> 
div.mathjax {
  padding-top: .5em;
  padding-bottom: .5em;
}
</style></head><body><div class="container"><h2 data-command-name="section" id="16_5_Модульная_арифметика">16.5. Модульная арифметика</h2><h3 data-command-name="subsection" id="16_5_1_Сложность_модульных_операций">16.5.1. Сложность модульных операций</h3><p>Криптосистемы с открытым ключом, как правило, построены в модульной арифметике с длиной модуля от сотни до нескольких тысяч разрядов. Сложность алгоритмов оценивают как количество битовых операций в зависимости от длины. В таблице<span class="nonbreaking-interword-space"> </span><a href="#tab:mod-binary-complexity">[tab:mod-binary-complexity]</a> приведены оценки (с точностью до порядка) сложности модульных операций<a name="N114604"><!--битовая сложность--></a> для простых (или &laquo;школьных&raquo;) алгоритмов вычислений. На самом деле для реализации арифметики длинных чисел (сотни или тысячи двоичных разрядов) следует применять существенно более эффективные (более &laquo;хитрые&raquo;) алгоритмы вычислений, использующие, например, специальный вид быстрого преобразования Фурье и другие приёмы.</p><figure style="margin-left: auto; margin-right: auto; display: flex; flex-wrap: wrap; align-items: baseline; justify-content: center; width: fit-content; height: fit-content; "><table style="border-collapse: collapse;"><colgroup></colgroup></table><figcaption style="flex-basis: 100%; text-align: center;">Таблица 16.5 &mdash; Битовая сложность операций по модулю <span class="mathjax">$n$</span> длиной <span class="mathjax">$k= \log n$</span> бит<a name="#tab:mod-binary-complexity"></a></figcaption></figure><h3 data-command-name="subsection" id="16_5_2_Возведение_в_степень_по_модулю">16.5.2. Возведение в степень по модулю</h3><p>Рассмотрим два алгоритма возведения числа <span class="mathjax">$a$</span> в степень <span class="mathjax">$b$</span> по модулю <span class="mathjax">$n$</span> (см.<span class="nonbreaking-interword-space"> </span><a href="Literatura.html#Crandall:Pomerance:2011">[127]</a>). Оба этих алгоритма основываются на разложении показателя <span class="mathjax">$b$</span> в двоичное представление:</p><command name="equation"><argument required="true">equation</argument><content>
	<command name="array"><argument required="true">array</argument><argument required="true">l</argument><content>
		b = <command name="sum"></command><command name="limits"></command>_i=1^k b_i 2^i, <line-break></line-break>
		b_i <command name="in"></command>0, 1.
	</content></command>
	<a name="#eq:power-mod-b"></a>
</content></command><h4 data-command-name="subsubsection" id="Схема_слева_направо_">Схема &laquo;слева направо&raquo;</h4><p>Алгоритм<span class="nonbreaking-interword-space"> </span><a href="#alg:power-mod-left-to-right">[alg:power-mod-left-to-right]</a> сводится к вычислению следующей формулы:</p><div class="mathjax" style="text-align: center;">$$ c = \left( \left( \left( \left( \left( 1 \cdot a^{b_k} \right)^2 \cdot a^{b_{k-1}} \right)^2 \cdot a^{b_{k-2}} \right)^2 \dots \right)^2 \cdot a^{b_2} \right)^2 \cdot a^{b_1} \mod n.$$</div><command name="algorithm"><argument required="true">algorithm</argument><argument required="false">ht</argument><content>
	<command name="caption"><argument required="true">Простая двоичная схема возведения в степень типа &laquo;слева направо&raquo;<a name="#alg:power-mod-left-to-right"></a></argument></command>
	<command name="algorithmic"><argument required="true">algorithmic</argument><content>
		<command name="STATE"></command><span class="mathjax">$c := a$</span>;
		<command name="FOR"><argument required="true"> <span class="mathjax">$i := k-1$</span> <command name="TO"></command><span class="mathjax">$1$</span></argument></command>
			<command name="STATE"></command><span class="mathjax">$c := c^2 \mod n$</span>;
			<command name="IF"><argument required="true"> <span class="mathjax">$\left( b_i == 1 \right)$</span> </argument></command>
				<command name="STATE"></command><span class="mathjax">$c := c \cdot a \mod n$</span>;
			<command name="ENDIF"></command>
		<command name="ENDFOR"></command>
		<command name="RETURN"></command><span class="mathjax">$c$</span>;
	</content></command>
</content></command><p>Алгоритм требует <span class="mathjax">$k-1$</span> возведений в квадрат и <span class="mathjax">$t-1$</span> умножений, где <span class="mathjax">$t$</span> &ndash; количество единиц в двоичном представлении показателя степени. Так как возведение в квадрат можно сделать примерно в два раза быстрее, чем умножение на произвольное число, то, например, в криптосистеме RSA<a name="N114818"><!--криптосистема!RSA--></a> показатель степени стараются выбрать таким образом, чтобы в его двоичной записи было мало бит, отличных от нуля: <span class="mathjax">$3_{10} = 11_{2}$</span> или <span class="mathjax">$65537_{10} = 10000000000000001_{2}$</span>.</p><p><span style="font-variant: small-caps;"><b>Пример.</b></span> Посчитаем с помощью простой двоичной схемы возведения в степень типа &laquo;слева направо&raquo; значение <span class="mathjax">$175^{235} \mod 257$</span>. Представим число <span class="mathjax">$235$</span> в двоичном виде:</p><div class="mathjax" style="text-align: center;">$$ 235_{10} = 11101011_{2}.$$</div><p>Полное выражение для вычисления имеет вид:</p><div class="mathjax" style="text-align: center;">$$ c = (((((((1 \cdot a^1)^2 \cdot a^1)^2 \cdot a^1)^2 \cdot a^0)^2 \cdot a^1)^2 \cdot a^0)^2 \cdot a^1)^2 \cdot a^1 \mod 257.$$</div><ol><li><span class="mathjax">$c := 175$</span>;</li><li><span class="mathjax">$c := 175^2 \mod 257 = 42, $</span><line-break></line-break>
		<span class="mathjax">$c := 42 \times 175 \mod 257 = 154;$</span></li><li><span class="mathjax">$c := 154^2 \mod 257 = 72, $</span><line-break></line-break>
		<span class="mathjax">$c := 72 \times 175 \mod 257 = 7;$</span></li><li><span class="mathjax">$c := 7^2 \mod 257 = 49; $</span></li><li><span class="mathjax">$c := 49^2 \mod 257 = 88, $</span><line-break></line-break>
		<span class="mathjax">$c := 88 \times 175 \mod 257 = 237;$</span></li><li><span class="mathjax">$c := 237^2 \mod 257 = 143; $</span></li><li><span class="mathjax">$c := 143^2 \mod 257 = 146, $</span><line-break></line-break>
		<span class="mathjax">$c := 146 \times 175 \mod 257 = 107;$</span></li><li><span class="mathjax">$c := 107^2 \mod 257 = 141, $</span><line-break></line-break>
		<span class="mathjax">$c := 141 \times 175 \mod 257 = 3;$</span></li><li>Ответ: 3. Потребовалось 7 возведений в квадрат и 5 умножений.</li></ol><p>Алгоритм можно обобщить на использование произвольного основания разложения степени. Например, использование основания, представляющего собой степень двойки, будет являться методом улучшения описанной выше схемы под названием &laquo;просматривание&raquo; (англ. <span lang="en"><i>windowing</i></span>, см.<span class="nonbreaking-interword-space"> </span><a href="Literatura.html#Crandall:Pomerance:2011">[127]</a>). Если в качестве основания выбрать <span class="mathjax">$s = 4$</span>, то формула из примера выше для вычисления <span class="mathjax">$175^{235} \mod 257$</span> принимает вид:</p><div class="mathjax" style="text-align: center;">$$\begin{array}{l}
	235_{10} = 3223_{4}; \\
	c = \left(\left(\left( 1 \cdot 175^3 \right)^4 \cdot 175^2 \right)^4 \cdot 175^2 \right)^4 \cdot 175^3 \mod 257.
\end{array}$$</div><p>Для вычисления уже потребуется <span class="mathjax">$3 \times 2 = 6$</span> возведений в квадрат и <span class="mathjax">$3$</span> умножения. Но сначала потребуется вычислить значения <span class="mathjax">$175^2 \mod 257$</span> и <span class="mathjax">$175^3 \mod 257$</span>. Для больших показателей степени <span class="mathjax">$n$</span> выгода в количестве умножений будет очевидна.</p><h4 data-command-name="subsubsection" id="Схема_справа_налево_">Схема &laquo;справа налево&raquo;</h4><p>Другим вариантом является схема типа &laquo;справа налево&raquo; (см. алгоритм<span class="nonbreaking-interword-space"> </span><a href="#alg:power-mod-right-to-left">[alg:power-mod-right-to-left]</a>). Она также основывается на разложении показателя степени по степеням двойки<span class="nonbreaking-interword-space"> </span><a href="#eq:power-mod-b">[eq:power-mod-b]</a>. Её можно представить следующей формулой:</p><div class="mathjax" style="text-align: center;">$$\begin{array}{ll}
c &amp; = a^b = \\
  &amp; = a^{\sum b_i 2^{i-1}} = \\
  &amp; = a^{b_1} \times a^{(b_2 2)} \times a^{(b_3 2^2)} \times a^{(b_4 2^3)} \times \dots \times a^{(b_k 2^{k-1})} = \\
  &amp; = a^{b_1} \times \left(a^2\right)^{b_2} \times \left(a^4\right)^{b_3} \times \left(a^8\right)^{b_4} \times \dots \times \left(a^{2^{k-1}}\right)^{b_k} = \\
  &amp; = \prod\limits_{i=1}^{k} \left(a^{2^{i-1}}\right)^{b_i}.
\end{array}$$</div><command name="algorithm"><argument required="true">algorithm</argument><argument required="false">ht</argument><content>
	<command name="caption"><argument required="true">Простая двоичная схема возведения в степень типа &laquo;справа налево&raquo;<a name="#alg:power-mod-right-to-left"></a></argument></command>
	<command name="algorithmic"><argument required="true">algorithmic</argument><content>
		<command name="STATE"></command><span class="mathjax">$c := 1$</span>;
		<command name="STATE"></command><span class="mathjax">$t := a$</span>;
		<command name="FOR"><argument required="true"> <span class="mathjax">$i := 1$</span> <command name="TO"></command><span class="mathjax">$k$</span> </argument></command>
			<command name="IF"><argument required="true"> <span class="mathjax">$\left( b_i == 1 \right)$</span> </argument></command>
				<command name="STATE"></command><span class="mathjax">$c := c \cdot t \mod n$</span>;
			<command name="ENDIF"></command>
			<command name="STATE"></command><span class="mathjax">$t := t^2 \mod n$</span>;
		<command name="ENDFOR"></command>
		<command name="RETURN"></command><span class="mathjax">$c$</span>.
	</content></command>
</content></command><p><span style="font-variant: small-caps;"><b>Пример.</b></span> Посчитаем с помощью простой двоичной схемы возведения в степень типа &laquo;справа налево&raquo; значение <span class="mathjax">$175^{235} \mod 257$</span>. Представим число <span class="mathjax">$235$</span> в двоичном виде:</p><div class="mathjax" style="text-align: center;">$$ 235_{10} = 11101011_{2}.$$</div><ol><li><span class="mathjax">$ c := 1 \times 175 \mod 257 = 175$</span>, <line-break></line-break>
		<span class="mathjax">$ t:= 175^2 \mod 257 = 42$</span>;</li><li><span class="mathjax">$ c := 175 \times 42 \mod 257 = 154$</span>, <line-break></line-break>
		<span class="mathjax">$ t:= 42^2 \mod 257 = 222$</span>;</li><li><span class="mathjax">$ t:= 222^2 \mod 257 = 197$</span>;</li><li><span class="mathjax">$ c := 154 \times 197 \mod 257 = 12$</span>, <line-break></line-break>
		<span class="mathjax">$ t:= 197^2 \mod 257 = 2$</span>;</li><li><span class="mathjax">$ t:= 2^2 \mod 257 = 4$</span>;</li><li><span class="mathjax">$ c := 12 \times 4 \mod 257 = 48$</span>, <line-break></line-break>
		<span class="mathjax">$ t:= 4^2 \mod 257 = 16$</span>;</li><li><span class="mathjax">$ c := 48 \times 16 \mod 257 = 254$</span>, <line-break></line-break>
		<span class="mathjax">$ t:= 16^2 \mod 257 = 256$</span>;</li><li><span class="mathjax">$ c := 254 \times 256 \mod 257 = 3$</span>.</li><li>Ответ: 3. Потребовалось 7 возведений в квадрат и 5 умножений.</li></ol><h3 data-command-name="subsection" id="16_5_3_Алгоритм_Евклида">16.5.3. Алгоритм Евклида</h3><p><a name="N115147"><!--алгоритм!Евклида|(--></a>
Рекурсивная форма алгоритма Евклида вычисления <span class="mathjax">$\gcd(a,b)$</span> имеет следующий вид:</p><div class="mathjax" style="text-align: center;">$${\mathbb{}}(a,b): a&gt;b;  \gcd(a,b) = \gcd(b, a \mod b). $$</div><p>Редуцирование чисел продолжается, пока не получим</p><div class="mathjax" style="text-align: center;">$$ a \mod b = 0, $$</div><p>тогда <span class="mathjax">$b$</span> и будет искомым НОД.</p><p><span style="font-variant: small-caps;"><b>Пример.</b></span> 
Вычислим <span class="mathjax">$\gcd(56, 35)$</span>:</p><div class="mathjax" style="text-align: center;">$$ \begin{array}{ll}
    \gcd(56, 35) &amp; =~ \gcd(35, ~ 56 \mod 35 = 21) ~= \\
    &amp; =~ \gcd(21, ~ 35 \mod 21 = 14) ~= \\
    &amp; =~ \gcd(14, ~ 21 \mod 14 = 7) ~= \\
    &amp; =~ \gcd(7, ~ 14 \mod 7 = 0) ~= \\
    &amp; =~ 7. \\
\end{array} $$</div><p><a name="N115181"><!--алгоритм!Евклида|)--></a></p><h3 data-command-name="subsection" id="16_5_4_Расширенный_алгоритм_Евклида">16.5.4. Расширенный алгоритм Евклида</h3><p><a name="N115197"><!--алгоритм!Евклида!расширенный|(--></a><em>Расширенный алгоритм Евклида</em> для целых <span class="mathjax">$a, b: a &gt; b$</span> находит</p><command name="footnote"><argument required="true">См., например,<span class="nonbreaking-interword-space"> </span><a href="Literatura.html#Aho:1979">[112]</a>.</argument></command><div class="mathjax" style="text-align: center;">$$ x, y, d = \gcd(a,b): ax + by = d. $$</div><p>Введём обозначения: <span class="mathjax">$g_i$</span> &ndash; частное от деления, <span class="mathjax">$r_i$</span> &ndash; остаток от деления на <span class="mathjax">$i$</span>-м шаге. Алгоритм:</p><div class="mathjax" style="text-align: center;">$$\begin{array}{ll}
	r_{-1} &amp; := a, \\
	r_0 &amp; := b, \\
	y_0 &amp; := x_{-1} := 1, \\
	y_{-1} &amp; := x_0 := 0. \\
\end{array}$$</div><div class="mathjax" style="text-align: center;">$$\begin{array}{ll}
	g_i &amp; := \left\lfloor r_{i-2} / r_{i-1} \right\rfloor, \\
	r_i &amp; := r_{i-2} - g_i \cdot r_{i-1}, \\
	y_i &amp; := y_{i-2} - g_i \cdot y_{i-1} , \\
	x_i &amp; := x_{i-2} - g_i \cdot x_{i-1} . \\
\end{array}$$</div><p>Алгоритм останавливается, когда <span class="mathjax">$r_i = 0$</span>.</p><!--%Вычисление осуществляется точно так же, как и в обычном алгоритме Евклида, только на каждой итерации дополнительно находится частное и остаток от деления.--><p><span style="font-variant: small-caps;"><b>Пример.</b></span> 
В таблице<span class="nonbreaking-interword-space"> </span><a href="#tab:extended-euclid">[tab:extended-euclid]</a> приведён числовой пример алгоритма для <span class="mathjax">$a=136, b=36$</span>.</p><figure style="margin-left: auto; margin-right: auto; display: flex; flex-wrap: wrap; align-items: baseline; justify-content: center; width: fit-content; height: fit-content; "><table style="border-collapse: collapse;"><colgroup><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;"><col style=""><col style="border-right: solid thin;"></colgroup><tr style="border-bottom: solid thin;border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$i$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$g_i$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$r_i$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$x_i$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$y_i$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"></td></tr><tr style="border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$-1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;">&mdash;</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$136$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$0$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$136 =$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$ 1 \cdot 136$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$ + 0 \cdot 36$</span></td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$0$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;">&mdash;</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$36$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$0$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$36 =$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$ 0 \cdot 136$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$ + 1 \cdot 36$</span></td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$3$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$28$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$+1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$-3$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$28 =$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$+1 \cdot 136$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$ - 3 \cdot 36$</span></td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$2$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$8$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$-1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$+4$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$8 =$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$-1 \cdot 136$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$ + 4 \cdot 36$</span></td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$3$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$3$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$4$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$+4$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$-15$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$4 =$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$+4 \cdot 136$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$ -15 \cdot 36$</span></td></tr><tr style="border-bottom: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$4$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$2$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$0$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;">&mdash;</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;">&mdash;</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;">&mdash;</td></tr></table><figcaption style="flex-basis: 100%; text-align: center;">Таблица 16.6 &mdash; Пример расширенного алгоритма Евклида для <line-break></line-break> <span class="mathjax">$a=136, b=36$</span><a name="#tab:extended-euclid"></a></figcaption></figure><p>Найдено <span class="mathjax">$x = 4, ~ y = -15, ~ d = 4$</span>.</p><h3 data-command-name="subsection" id="16_5_5_Нахождение_мультипликативного_обратного_по_модулю">16.5.5. Нахождение мультипликативного <command name="protect"></command><line-break></line-break> обратного по модулю</h3><p>Расширенный алгоритм Евклида можно использовать для вычисления обратного элемента<a name="N115515"><!--обратный элемент--></a>: для заданных <span class="mathjax">$a$</span> и <span class="mathjax">$n$</span> найти <span class="mathjax">$x, y, d = \gcd(a,n): ax + ny = d$</span>. Пусть <span class="mathjax">$a,n$</span> &ndash; взаимно простые, тогда:</p><div class="mathjax" style="text-align: center;">$$\begin{array}{l}
	ax + ny = 1, \\
	ax \equiv 1 \mod n, \\
	x \equiv a^{-1} \mod n. \\
\end{array}$$</div><p><span style="font-variant: small-caps;"><b>Пример.</b></span> 
В таблице<span class="nonbreaking-interword-space"> </span><a href="#tab:extended-euclid-inverse">[tab:extended-euclid-inverse]</a> приведён числовой пример вычисления расширенным алгоритмом Евклида для <span class="mathjax">$a=142, b=33$</span> обратных элементов <span class="mathjax">$33^{-1} \equiv -43 \mod 142$</span> и <span class="mathjax">$142^{-1} \equiv 10 \mod 33$</span>.</p><figure style="margin-left: auto; margin-right: auto; display: flex; flex-wrap: wrap; align-items: baseline; justify-content: center; width: fit-content; height: fit-content; "><table style="border-collapse: collapse;"><colgroup><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;"><col style=""><col style="border-right: solid thin;"></colgroup><tr style="border-bottom: solid thin;border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$i$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$g_i$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$r_i$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$x_i$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$y_i$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"></td></tr><tr style="border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$-1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;">&mdash;</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$142$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$0$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$142 =$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$  1 \cdot 142$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$ + 0 \cdot 33$</span></td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$0$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;">&mdash;</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$33$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$0$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$33 =$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$  0 \cdot 142$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$ + 1 \cdot 33$</span></td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$4$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$10$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$+1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$-4$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$10 =$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$ +1 \cdot 142$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$ - 4 \cdot 33$</span></td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$2$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$3$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$3$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$-3$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$+13$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$3 =$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$ -3 \cdot 142$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$+ 13 \cdot 33$</span></td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$3$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$3$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$+10$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$-43$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$1 =$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$+10 \cdot 142$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$- 43 \cdot 33$</span></td></tr><tr style="border-bottom: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$4$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$3$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"><span class="mathjax">$0$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;">&mdash;</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;">&mdash;</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: right;white-space: nowrap;">&mdash;</td></tr></table><figcaption style="flex-basis: 100%; text-align: center;">Таблица 16.7 &mdash; Пример вычисления обратных элементов <span class="mathjax">$33^{-1} \equiv -43 \mod 142$</span> и <span class="mathjax">$142^{-1} \equiv 10 \mod 33$</span> из уравнения <span class="mathjax">$142 x + 33 y = 1$</span> расширенным алгоритмом Евклида<a name="#tab:extended-euclid-inverse"></a></figcaption></figure><p>Для <span class="mathjax">$k$</span>-битового числа <span class="mathjax">$n$</span>-битовая сложность вычисления обратного элемента имеет порядок <span class="mathjax">$O(k^2)$</span>. Если известно разложение числа <span class="mathjax">$n$</span> на множители, то по теореме Эйлера<a name="N115807"><!--теорема!Эйлера--></a></p><div class="mathjax" style="text-align: center;">$$ a^{-1} = a^{\varphi(n) - 1} \mod n, $$</div><p>и вычисление обратного элемента реализуется с битовой сложностью <span class="mathjax">$O(k^3),~ k = \lceil \log_2 n \rceil$</span>. Сложность вычислений по этому алгоритму можно уменьшить, если известно разложение на сомножители числа <span class="mathjax">$\varphi(n) - 1$</span>.</p><p><a name="N115822"><!--алгоритм!Евклида!расширенный|)--></a></p><h3 data-command-name="subsection" id="16_5_6_Китайская_теорема_об_остатках">16.5.6. Китайская теорема об остатках</h3><p><a name="N115844"><!--теорема!китайская об остатках--></a>
Китайская теорема об остатках (англ. <span lang="en"><i>Chinese Remainder Theorem, CRT</i></span>), приписываемая китайскому математику Сунь Цзы (пиньинь: S</p><command name=""></command><p>=un Z</p><command name="v"><argument required="true">i</argument></command><p>, примерно III<span class="nonbreaking-interword-space"> </span>век<span class="nonbreaking-interword-space"> </span>до<span class="nonbreaking-interword-space"> </span>н.<span class="nonbreaking-interword-space"> </span>э.), утверждает о существовании и единственности (с точностью до некоторого модуля) числа <span class="mathjax">$x$</span>, заданного по множеству остатков от деления на попарно взаимно простые числа <span class="mathjax">$n_1, n_2, n_3, \dots, n_k$</span>.</p><command name="theorem"><argument required="true">theorem</argument><content> Если натуральные числа <span class="mathjax">$n_1, n_2, n_3, \dots, n_k$</span> попарно взаимно просты, то для любых целых <span class="mathjax">$r_1, r_2, r_3, \dots, r_k$</span> таких, что <span class="mathjax">$0 \leq r_i &lt; n_i$</span>, найдётся число <span class="mathjax">$x$</span>, которое при делении на <span class="mathjax">$n_i$</span> даёт остаток <span class="mathjax">$r_i$</span> для всех <span class="mathjax">$1 \leq i \leq k$</span>. Более того, любые два таких числа <span class="mathjax">$x_1$</span> и <span class="mathjax">$x_2$</span>, имеющие одинаковые остатки <span class="mathjax">$r_1, r_2, \dots, r_k$</span>, удовлетворяют сравнению:
<div class="mathjax" style="text-align: center;">$$ \begin{array}{l}
	x_1 \equiv x_2 \mod n, \\
	n = n_1 \times n_2 \times \dots \times n_k.
\end{array} $$</div>
</content></command><p>Формула, приведённая в труде другого китайского математика Циня Цзюшао (пиньинь: Q́in Ji</p><command name="v"><argument required="true">u</argument></command><p>sh́ao, XIII<span class="nonbreaking-interword-space"> </span>век<span class="nonbreaking-interword-space"> </span>н.<span class="nonbreaking-interword-space"> </span>э.), позволяет найти искомое число:</p><div class="mathjax" style="text-align: center;">$$ \begin{array}{l}
	x = \sum\limits_{i=1}^k r_i \cdot e_i, \\
	e_i = \frac{n}{n_i} \cdot \left( \left(\frac{n}{n_i}\right)^{-1} \mod n_i \right), i = 1, \dots, k.
\end{array} $$</div><p>Китайская теорема об остатках позволяет рассматривать набор попарно взаимно простых чисел <span class="mathjax">$n_1, n_2, n_3, \dots, n_k$</span> как некоторый &laquo;базис&raquo;, в котором число <span class="mathjax">$0 \leq x &lt; n$</span> можно задать с помощью &laquo;координат&raquo; <span class="mathjax">$r_1, r_2, r_3, \dots, r_k$</span>. При этом операции сложения и умножения чисел можно выразить через операции сложения и умножения соответствующих остатков:</p><div class="mathjax" style="text-align: center;">$$ \begin{array}{l}
	\forall a, b, c, \begin{array}{l}
		a_i = a \mod n_i, \\
		b_i = b \mod n_i, \\
		c_i = c \mod n_i
	\end{array} \Rightarrow \\
	\left( c \equiv a + b \mod n \right) \Leftrightarrow \left( c_i \equiv a_i + b_i \mod n_i, i = 1, \dots, k \right), \\
	\left( c \equiv a \times b \mod n \right) \Leftrightarrow \left( c_i \equiv a_i \times b_i \mod n_i, i = 1, \dots, k \right).
\end{array} $$</div><p>Сложность перехода в векторную форму имеет порядок</p><div class="mathjax" style="text-align: center;">$$ O( \lceil \log_2 n \rceil ^2). $$</div><p>Теорема используется для решения систем линейных модульных уравнений и для ускорения вычислений.</p><p>Пусть битовая длина <span class="mathjax">$n$</span> равна <span class="mathjax">$l$</span>, и пусть все <span class="mathjax">$n_i$</span> имеют одинаковую битовую длину <span class="mathjax">$k / r$</span>. Тогда операция умножения в векторном виде будет в</p><div class="mathjax" style="text-align: center;">$$ \frac{l^2}{r \left( l \middle/ r \right)^2 } = r $$</div><p>раз быстрее.</p><p>Операция <span class="mathjax">$c = m^e \mod n$</span> занимает <span class="mathjax">$O(l^3)$</span> битовых операций. Если перейти к вычислениям по модулям <span class="mathjax">$n_i$</span>, то возведение в степень можно вычислить в</p><div class="mathjax" style="text-align: center;">$$ \frac{l^3}{r \left( l \middle/ r \right)^3 } = r^2 $$</div><p>раз быстрее, коэффициенты результирующего вектора равны</p><div class="mathjax" style="text-align: center;">$$ c_i ~=~ \left( m \mod n_i \right)^{e \mod \varphi(n_i)} \mod n_i, ~ i = 1, \dots, k. $$</div><h3 data-command-name="subsection" id="16_5_7_Решение_систем_линейных_уравнений">16.5.7. Решение систем линейных уравнений</h3><p><span style="font-variant: small-caps;"><b>Пример.</b></span> 
Решим, для примера, систему линейных уравнений. Применим CRT и а) для разложения одного уравнения по составному модулю на систему по взаимно простым модулям, и б) для нахождения конечного решения системы уравнений:</p><div class="mathjax" style="text-align: center;">$$
    \begin{cases}
        9 x \equiv 8 \mod 11, \\
        5 x \equiv 7 \mod 12, \\
        x \equiv 5 \mod 6, \\
        122 x \equiv 118 \mod 240; \\
    \end{cases}
    \Rightarrow ~~
    \begin{cases}
        x \equiv 8 \cdot 9^{-1} \mod 11, \\
        x \equiv 7 \cdot 5^{-1} \mod 12, \\
        x \equiv 5 \mod 6, \\
        x \equiv 59 \cdot 61^{-1} \mod 120; \\
    \end{cases}
    \Rightarrow
$$</div><div class="mathjax" style="text-align: center;">$$
    \Rightarrow ~~
    \begin{cases}
        x \equiv -4 \mod 11, \\
        x \equiv -1 \mod 12, \\
        x \equiv -1 \mod 6, \\
        x \equiv -1 \mod 120; \\
    \end{cases}
    \Rightarrow ~~
    \begin{cases}
        x \equiv -4 \mod 11, \\
        \begin{cases}
            x \equiv -1 \mod 3, \\
            x \equiv -1 \mod 4, \\
        \end{cases} \\
        \begin{cases}
            x \equiv -1 \mod 3, \\
            x \equiv -1 \mod 2, \\
        \end{cases} \\
        \begin{cases}
            x \equiv -1 \mod 8, \\
            x \equiv -1 \mod 3, \\
            x \equiv -1 \mod 5; \\
        \end{cases} \\
    \end{cases}
    \Rightarrow
$$</div><div class="mathjax" style="text-align: center;">$$
    \Rightarrow ~~
    \begin{cases}
        x \equiv -4 \mod 11, \\
        x \equiv -1 \mod 3, \\
        x \equiv -1 \mod 8, \\
        x \equiv -1 \mod 5. \\
    \end{cases}
$$</div><p>Все модули попарно взаимно простые, поэтому применима китайская теорема об остатках<a name="N116017"><!--теорема!китайская об остатках--></a>:</p><div class="mathjax" style="text-align: center;">$$\begin{array}{l}
	n_1 = 11, ~ n_2 = 3, ~ n_3 = 8, ~ n_4 = 5, \\
	n = n_1 \cdot n_2 \cdot n_3 \cdot n_4 = 1320, \\
	n / n_i  = \left\{ 120, 440, 165, 264 \right\}, \\
	\left( n / n_i \right)^{-1} \mod n_i = \left\{ 10, 2, 5, 4 \right\}, \\
	e_i = \left\{ 1200, 880, 825, 1056 \right\}, \\
	x = -4 \cdot 1200 - 1 \cdot 880 - 1 \cdot 825 - 1 \cdot 1056 = -7561, \\
	x \equiv 359 \mod 1320.
\end{array}$$</div><p>Аналогично, если переписать последнюю систему с положительными остатками:</p><div class="mathjax" style="text-align: center;">$$\begin{array}{l}
	\begin{cases}
		x \equiv 7 \mod 11, \\
		x \equiv 2 \mod 3, \\
		x \equiv 7 \mod 8, \\
		x \equiv 4 \mod 5. \\
	\end{cases} \\
	x \equiv 7 \cdot 1200 + 2 \cdot 880 + 7 \cdot 825 + 4 \cdot 1056 = 20159, \\
	x \equiv 359 \mod 1320.
\end{array}$$</div><p>Ответ: <span class="mathjax">$x \equiv 359 \mod 1320$</span>.</p><nav aria-label="Page navigation example"><ul class="pagination justify-content-center"><li class="page-item"><a class="page-link" href="16_4_Konechnie_polja_i_operatsii_v_algoritme_AES.html">&#129080; 16_4_Konechnie_polja_i_operatsii_v_algoritme_AES</a></li><li class="page-item"><a class="page-link" href="16_6_Psevdoprostie_chisla.html">16_6_Psevdoprostie_chisla &#129082;</a></li></ul></nav></div><script>
window.MathJax = {
  loader: {
    load: ['[tex]/tagformat'],
  },
  options: {
    processHtmlClass: 'mathjax'
  },
  tex: {
    packages: {
      '[+]': ['base', 'ams', 'physics', 'textcomp']
    },
    inlineMath: [['$', '$']],
  },
};
</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script async="yes" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></body></html>