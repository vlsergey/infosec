<!DOCTYPE html SYSTEM "about:legacy-compat">
<html><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><style type="text/css"> 
div.toc-item-h2 {
  padding-left: 2em;
}
div.toc-item-h3 {
  padding-left: 4em;
}
div.toc-item-h4 {
  padding-left: 6em;
}
div.toc-item-h5 {
  padding-left: 8em;
}
div.toc-item-h6 {
  padding-left: 10em;
}
</style><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" rel="stylesheet"><style type="text/css"> 
span.small {
  font-size: 90%
}
span.tiny {
  font-size: 50%
}
</style><style type="text/css"> 
div.mathjax {
  padding-top: .5em;
  padding-bottom: .5em;
}
</style></head><body><div class="container"><h1 data-command-name="chapter" id="Глава_12_Разделение_секрета" lang="ru">Глава 12. Разделение секрета</h1><p><a name="N105034"><!--схема!разделения секрета|(--></a></p><h2 data-command-name="section" id="12_1_Пороговые_схемы">12.1. Пороговые схемы</h2><p>Идея <em>пороговой</em> <span class="mathjax">$(K, N)$</span>-схемы<a name="N105059"><!--разделение секрета!пороговое--></a> разделения общего секрета среди <span class="mathjax">$N$</span> пользователей состоит в следующем. Доверенная сторона хочет распределить некий секрет <span class="mathjax">$K_0$</span> между <span class="mathjax">$N$</span> пользователями таким образом, что:</p><ul><li>любые <span class="mathjax">$m_1: K \leq m_1 \leq N$</span>, легальных пользователей могут получить секрет (или доступ к секрету), если предъявят свои секретные ключи;</li><li>любые <span class="mathjax">$m_2: m_2 &lt; K$</span>, легальных пользователей не могут получить секрет и не могут определить (вычислить) этот секрет, даже решив трудную в вычислительном смысле задачу.</li></ul><p>Далее рассмотрены три случая: <span class="mathjax">$(K, N)$</span>-схема Блэкли, <span class="mathjax">$(K, N)$</span>-схема Шамира и простая <span class="mathjax">$(N,N)$</span>-схема.</p><h3 data-command-name="subsection" id="12_1_1_Схема_разделения_секрета_Блэкли">12.1.1. Схема разделения секрета Блэкли</h3><p><a name="N105113"><!--схема разделения секрета!Блэкли|(--></a><a name="N105118"><!--схема разделения секрета!векторная|(--></a>
Схема разделения секрета Блэкли (англ. <span lang="en"><i>George Robert Blakley</i></span>,<span class="nonbreaking-interword-space"> </span><a href="Literatura.html#Blackley:1979">[15]</a>, рис.<span class="nonbreaking-interword-space"> </span><a href="Glava_12_Razdelenie_sekreta.html#fig:blakley">12.1</a>), также называемая векторной схемой, основывается на том, что для восстановления всех координат точки в <span class="mathjax">$K$</span>-мерном пространстве, принадлежащей нескольким неколлинеарным гиперплоскостям, необходимо и достаточно знать уравнения <span class="mathjax">$K$</span> таких плоскостей. То есть в двумерном пространстве нужны две пересекающиеся прямые, в трёхмерном &ndash; три пересекающиеся в нужной точке плоскости и так далее.</p><figure style="margin-left: auto; margin-right: auto; display: flex; flex-wrap: wrap; align-items: baseline; justify-content: center; width: fit-content; height: fit-content; "><a name="fig:blakley" style="vertical-align: top; align-self: start;"></a><figure style="margin-left: 0; margin-right: 0; width: 45%;"><img src="images/8A3CD42225E4C6BA58A781EC1C5200DF.png" style="width: 100%"><figcaption>(a) </figcaption></figure><span class="nonbreaking-interword-space"> </span><span class="nonbreaking-interword-space"> </span><span class="nonbreaking-interword-space"> </span><span class="nonbreaking-interword-space"> </span><figure style="margin-left: 0; margin-right: 0; width: 45%;"><img src="images/3E53419A781E3017F297CEA4612C6926.png" style="width: 100%"><figcaption>(b) </figcaption></figure><figcaption style="flex-basis: 100%; text-align: center;">Рис. 12.1 &mdash; Для восстановления координат точки пересечения плоскостей в трёхмерном пространстве необходимо и достаточно знать уравнения трёх таких плоскостей. Данные изображения приведены только для иллюстрации идеи: в схеме Блэкли используется конечное поле, плоскости в котором сложно представить на графике. Рисунок участника English Wikipedia stib, доступно по <a href="https://creativecommons.org/licenses/by-sa/3.0/deed.ru">лицензии CC-BY-SA 3.0</a></figcaption></figure><p>Для разделения секрета <span class="mathjax">$M$</span> между <span class="mathjax">$N$</span> сторонами таким образом, чтобы любые <span class="mathjax">$K$</span> сторон могли восстановить секрет, доверенный центр выполняет следующие операции:</p><ul><li>выбирает несекретное большое простое число <span class="mathjax">$p$</span> (<span class="mathjax">$p &gt; M$</span>);</li><li>выбирает случайную точку, одна из координат которой (например, первая) будет равна разделяемому секрету <span class="mathjax">$M$</span>: <span class="mathjax">$(x_1 = M, x_2, \dots, x_K)$</span>;</li><li>для каждого участника <span class="mathjax">$i$</span> выбирает <span class="mathjax">$K$</span> случайных коэффициентов гиперплоскости <span class="mathjax">$C^i_1, C^i_2, \dots, C^i_{K}$</span> (<span class="mathjax">$\ne 0$</span>), а последний коэффициент <span class="mathjax">$C^i_{K+1}$</span> вычисляется таким образом, чтобы гиперплоскость проходила через выбранную точку:
		<div class="mathjax" style="text-align: center;">$$ \begin{array}{l}
			C^i_1 x_1 + C^i_2 x_2 + \dots + C^i_K x_K + C^i_{K+1} = 0 \mod p, \\
			C^i_{K+1} = - ( C^i_1 x_1 + C^i_2 x_2 + \dots + C^i_K x_K ) \mod p; \\
		\end{array} $$</div></li><li>раздаёт каждой стороне по следу в виде коэффициентов общего уравнения гиперплоскости <span class="mathjax">$C^i_1, C^i_2, \dots, C^i_{K}, C^i_{K+1}$</span> и общему модулю <span class="mathjax">$p$</span>.</li></ul><p>Если стороны могут собраться вместе и получить не менее чем <span class="mathjax">$K$</span> различных гиперплоскостей, то, составив и решив систему уравнений с <span class="mathjax">$K$</span> неизвестными, они смогут получить все координаты точки <span class="mathjax">$x_1, x_2, \dots, x_k$</span>:</p><div class="mathjax" style="text-align: center;">$$ \left\{ \begin{array}{l}
    C^1_1 x_1 + C^1_2 x_2 + \dots + C^1_K x_K + C^1_{K+1} = 0 \mod p, \\
    \dots, \\
    C^K_1 x_1 + C^K_2 x_2 + \dots + C^K_K x_K + C^K_{K+1} = 0 \mod p. \\
\end{array} \right. $$</div><p>Если собрано меньшее количество следов (уравнений гиперплоскостей), то их будет недостаточно для решения системы уравнений.</p><p><span style="font-variant: small-caps;"><b>Пример.</b></span> 
Приведём пример разделения секрета по схеме Блэкли в <span class="mathjax">${{\mathbb{GF}}(11)}$</span>. При разделении секрета <span class="mathjax">$M$</span>, используя <span class="mathjax">$(3,N)$</span>-по<wbr></wbr>ро<wbr></wbr>го<wbr></wbr>вую схему Блэкли, участники получили следы: <span class="mathjax">$(4, 8, 2, 6)$</span>, <span class="mathjax">$(2, 6, 8, 3)$</span>, <span class="mathjax">$(6, 8, 4, 1)$</span>. Зная, что следы представляют собой коэффициенты в уравнении плоскости общего вида, а исходный секрет &ndash; первую координату точки пересечения плоскостей, составляем систему уравнений для нахождения координаты этой точки:</p><div class="mathjax" style="text-align: center;">$$ \left\{\begin{aligned}
   \left( 4\cdot x_1 + 8\cdot x_2 + 2\cdot x_3 + 6 \right) &amp;= 0 &amp;\mod 11,  \\
   \left( 2\cdot x_1 + 6\cdot x_2 + 8\cdot x_3 + 3 \right) &amp;= 0 &amp;\mod 11,  \\
   \left( 6\cdot x_1 + 8\cdot x_2 + 4\cdot x_3 + 1 \right) &amp;= 0 &amp;\mod 11.  \\
\end{aligned} \right. $$</div><p>Решением данной системы будет являться точка (6, 4, 2), а её первая координата &ndash; разделяемый секрет.</p><p><a name="N105317"><!--схема разделения секрета!векторная|)--></a><a name="N105322"><!--схема разделения секрета!Блэкли|)--></a></p><h3 data-command-name="subsection" id="12_1_2_Схема_разделения_секрета_Шамира">12.1.2. Схема разделения секрета Шамира</h3><p><a name="N105347"><!--схема разделения секрета!Шамира|(--></a><a name="N105352"><!--схема разделения секрета!интерполяционных полиномов Лагранжа|(--></a>
Схема разделения секрета Шамира (англ. <span lang="en"><i>Adi Shamir</i></span>,<span class="nonbreaking-interword-space"> </span><a href="Literatura.html#Shamir:1979">[93]</a>), также называемая схемой интерполяционных полиномов Лагранжа, основывается на том, что для восстановления всех коэффициентов полинома <span class="mathjax">$P(x) = a_{K-1}x^{K-1} + \dots + a_1 x + a_0$</span> степени <span class="mathjax">$K-1$</span> требуется <span class="mathjax">$K$</span> координат различных точек, принадлежащих кривой <span class="mathjax">$y=P(x)$</span>. Все операции проводятся в конечном поле <span class="mathjax">$GF(p)$</span>.</p><figure style="margin-left: auto; margin-right: auto; display: flex; flex-wrap: wrap; align-items: baseline; justify-content: center; width: fit-content; height: fit-content; width: 50%;"><a name="fig:shamir" style="vertical-align: top; align-self: start;"></a><img src="images/E9FAA7044C6C60EDCB17559DFC41749C.png" style="width: 100%"><figcaption style="flex-basis: 100%; text-align: center;">Рис. 12.2 &mdash; Через две точки можно провести неограниченное число графиков, заданных полиномами степени 2. Для выбора единственного из них нужна третья точка. Данные графики приведены только для иллюстрации идеи: в схеме Шамира используется конечное поле, полиномы над которым сложно представить на графике.</figcaption></figure><p>Для разделения секрета <span class="mathjax">$M$</span> между <span class="mathjax">$N$</span> сторонами таким образом, чтобы любые <span class="mathjax">$K$</span> сторон могли восстановить секрет, доверенный центр выполняет следующие операции:</p><ul><li>выбирает несекретное большое простое число <span class="mathjax">$p$</span> (<span class="mathjax">$p &gt; M$</span>);</li><li>в качестве свободного члена секретного многочлена полагает разделяемый секрет <span class="mathjax">$a_0 = M$</span>;</li><li>выбирает остальные секретные коэффициенты многочлена <span class="mathjax">$a_1, \dots, a_{k-1}$</span>, меньшие, чем <span class="mathjax">$p$</span>;</li><li>выбирает <span class="mathjax">$N$</span> различных <span class="mathjax">$x$</span>, таких, что <span class="mathjax">$0 &lt; x_i &lt; p$</span>;</li><li>для каждого выбранного <span class="mathjax">$x_i$</span> вычисляет соответствующий <span class="mathjax">$y_i$</span>, подставляя значения в формулу многочлена
		<div class="mathjax" style="text-align: center;">$$ y_i = P( x_i ) = a_{K-1}x_i^{K-1} + \dots + a_1 x_i + a_0 \mod p ;$$</div></li><li>раздаёт каждой стороне по следу вида <span class="mathjax">$(x_i, y_i)$</span> и общему модулю <span class="mathjax">$p$</span>.</li></ul><p>Если стороны могут собраться вместе и получить не менее чем <span class="mathjax">$K$</span> различных следов, то, составив и решив систему уравнений с <span class="mathjax">$K$</span> неизвестными, они смогут получить все коэффициенты <span class="mathjax">$a_0, a_1, \dots, a_{k-1}$</span> секретного многочлена:</p><div class="mathjax" style="text-align: center;">$$ \left\{ \begin{array}{l}
    y_1 = a_{K-1}x_1^{K-1} + \dots + a_1 x_1 + a_0 \mod p, \\
    \dots, \\
    y_k = a_{K-1}x_k^{K-1} + \dots + a_1 x_k + a_0 \mod p. \\
\end{array} \right. $$</div><p>Если собрано меньшее количество следов, то их будет недостаточно для решения системы уравнений.</p><p>Существует также способ вычисления коэффициентов многочлена, основанный на методе интерполяционных полиномов Лагранжа (откуда и берётся второе название метода разделения секрета). Идея способа состоит в вычислении набора специальных полиномов <span class="mathjax">$l_i \left( x \right)$</span>, которые принимают значение <span class="mathjax">$1$</span> в точке <span class="mathjax">$x_i$</span>, а во всех остальных точках-следах их значение равно нулю:</p><div class="mathjax" style="text-align: center;">$$ \begin{cases}
	l_i \left( x_j \right) = 1, &amp;x_j = x_i, \\
	l_i \left( x_j \right) = 0, &amp;x_j \ne x_i. \\
\end{cases} $$</div><p>Далее эти многочлены умножаются на значения <span class="mathjax">$y_i$</span> и в сумме дают исходный многочлен:</p><div class="mathjax" style="text-align: center;">$$\begin{array}{llll}
  l_i \left( x \right) &amp;=&amp; \prod\limits_{j \ne i} {\frac{{x - x_j }}{{x_i  - x_j }}} &amp;\mod p, \\
  F\left( x \right) &amp;=&amp; \sum\limits_i {l_i \left( x \right)y_i } &amp;\mod p. \\
\end{array}$$</div><p>Строго говоря, для восстановления самого секрета, которым является свободный член многочлена, не обязательно восстанавливать весь многочлен, а можно использовать упрощённую формулу для восстановления только свободного члена <span class="mathjax">$a_0 = M$</span>:</p><div class="mathjax" style="text-align: center;">$$ M = \sum\limits_{i=0}^{k-1} y_i \prod\limits_{j=0, j \neq i}^{k-1} \frac{x_j}{x_j - x_i}. $$</div><p><span style="font-variant: small-caps;"><b>Пример.</b></span> 
Приведём схему Шамира в поле <span class="mathjax">${{\mathbb{GF}}(p)}$</span>. Для разделения секрета <span class="mathjax">$M$</span> в <span class="mathjax">$(3,n)$</span>-пороговой схеме используется многочлен степени <span class="mathjax">$3-1=2$</span>.</p><div class="mathjax" style="text-align: center;">$$ f(x) = a x^2 + b x + M \mod p, $$</div><p>где <span class="mathjax">$p$</span> &ndash; простое<a name="N105542"><!--число!простое--></a> число. Пусть <span class="mathjax">$p=23$</span>. Восстановим секрет <span class="mathjax">$M$</span> по <em>теням</em></p><div class="mathjax" style="text-align: center;">$$ (1,14), (4,21), (15,6). $$</div><p>Последовательно вычисляем</p><div class="mathjax" style="text-align: center;">$$\begin{array}{llc}
M &amp;\displaystyle = \sum\limits_{i=0}^{k-1} y_i \prod\limits_{j=0, j \neq i}^{k-1} \frac{x_j}{x_j - x_i} \mod p = &amp; \\
	\\
	&amp;= 14 {\cdot} \frac{4}{4-1} {\cdot} \frac{15}{15-1} + 21 {\cdot} \frac{1}{1-4} {\cdot} \frac{15}{15-4} + 6 {\cdot} \frac{1}{1-15} {\cdot} \frac{4}{4-15} &amp; \mod 23 = \\
	\\
	&amp;\displaystyle = 14 {\cdot} \frac{4}{3} {\cdot} \frac{15}{14} + 21 {\cdot} \frac{1}{-3} {\cdot} \frac{15}{11} + 6 {\cdot} \frac{1}{-14} {\cdot} \frac{4}{-11} &amp; \mod 23 = \\
	\\
	&amp;\displaystyle = 20 - 7 \cdot 15 \cdot 11^{-1} + 12 \cdot 7^{-1} \cdot 11^{-1} &amp; \mod 23 = \\
	\\
	&amp;= 13 \mod 23.
\end{array}$$</div><p><a name="N105566"><!--схема разделения секрета!интерполяционных полиномов Лагранжа|)--></a><a name="N105571"><!--схема разделения секрета!Шамира|)--></a></p><h3 data-command-name="subsection" id="12_1_3_N_N_схема_разделения_секрета">12.1.3. <span class="mathjax">$(N, N)$</span>-схема разделения секрета</h3><p>Рассмотрим пороговую схему распределения одного секрета между двумя легальными пользователями. Она обозначается как <span class="mathjax">$(2, 2)$</span>-схема &ndash; это означает, что оба и только оба пользователя могут получить секрет. Предположим, что секрет <span class="mathjax">$K_{0}$</span> &ndash; это двоичная последовательность длины <span class="mathjax">$M$</span>, <span class="mathjax">$K_{0} \in {{\mathbb{Z}}}_{M}$</span>.</p><p>Разделение секрета <span class="mathjax">$K_{0}$</span> состоит в следующем.</p><ul><li>Первый пользователь в качестве секрета получает случайную двоичную последовательность <span class="mathjax">$A_{1}$</span> длины <span class="mathjax">$M$</span>.</li><li>Второй пользователь в качестве секрета получает случайную двоичную последовательность <span class="mathjax">$A_{2} =K_{0} \oplus A_{1}$</span> длины <span class="mathjax">$M$</span>.</li><li>Для получения секрета <span class="mathjax">$K_{0}$</span> оба пользователя должны сложить по модулю 2 свои секретные ключи (последовательности)  <span class="mathjax">$K_{0} = A_{2} \oplus A_{1}$</span>.</li></ul><p>Теперь рассмотрим пороговую <span class="mathjax">$(N,N)$</span>-схему.</p><p>Имеются общий секрет <span class="mathjax">$K_{0} \in {{\mathbb{Z}}}_{M}$</span> и <span class="mathjax">$N$</span> легальных пользователей, которые могут получить секрет только в случае, если одновременно предъявят свои секретные ключи. Распределение секрета <span class="mathjax">$K_{0}$</span> происходит следующим образом.</p><ul><li>Первый пользователь в качестве секрета получает случайную двоичную последовательность <span class="mathjax">$A_{1} \in {{\mathbb{Z}}}_{M}$</span>.</li><li>Второй пользователь в качестве секрета получает случайную двоичную последовательность <span class="mathjax">$A_{2} \in {{\mathbb{Z}}}_{M}$</span> и<span class="nonbreaking-interword-space"> </span>т.&nbsp;д.</li><li><span class="mathjax">$(N-1)$</span>-й пользователь в качестве секрета получает случайную двоичную последовательность <span class="mathjax">$A_{N-1} \in {{\mathbb{Z}}}_{M}$</span>.</li><li><span class="mathjax">$N$</span>-й пользователь в качестве секрета получает двоичную последовательность
        <div class="mathjax" style="text-align: center;">$$ K_0 \oplus A_1 \oplus A_2 \oplus \dots \oplus A_{N-1}. $$</div></li><li>Для получения секрета <span class="mathjax">$K_0$</span> все пользователи должны сложить по модулю 2 свои последовательности:
        <div class="mathjax" style="text-align: center;">$$ A_1 \oplus A_2 \oplus \dots \oplus A_{N-1} \oplus (K_0 \oplus A_1 \oplus A_2 \dots \oplus A_{N-1}) = K_0. $$</div></li></ul><p>Предположим, что собравшихся вместе пользователей меньше общего числа <span class="mathjax">$N$</span>, например, всего <span class="mathjax">$N-1$</span> пользователей. Тогда суммирование <span class="mathjax">$N-1$</span> последовательностей не определяет секрета, а перебор невозможен, так как данная схема разделения секрета аналогична криптосистеме Вернама и обладает совершенной криптостойкостью.</p><nav aria-label="Page navigation example"><ul class="pagination justify-content-center"><li class="page-item"><a class="page-link" href="11_6_Kvantovie_protokoli.html">&#129080; 11_6_Kvantovie_protokoli</a></li><li class="page-item"><a class="page-link" href="12_2_Raspredelenie_po_koalitsijam.html">12_2_Raspredelenie_po_koalitsijam &#129082;</a></li></ul></nav></div><script>
window.MathJax = {
  loader: {
    load: ['[tex]/tagformat'],
  },
  options: {
    processHtmlClass: 'mathjax'
  },
  tex: {
    packages: {
      '[+]': ['base', 'ams', 'physics', 'textcomp']
    },
    inlineMath: [['$', '$']],
  },
};
</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script async="yes" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></body></html>