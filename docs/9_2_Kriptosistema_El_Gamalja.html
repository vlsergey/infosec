<!DOCTYPE html SYSTEM "about:legacy-compat">
<html><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><style type="text/css"> 
div.toc-item-h2 {
  padding-left: 2em;
}
div.toc-item-h3 {
  padding-left: 4em;
}
div.toc-item-h4 {
  padding-left: 6em;
}
div.toc-item-h5 {
  padding-left: 8em;
}
div.toc-item-h6 {
  padding-left: 10em;
}
</style><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" rel="stylesheet"><style type="text/css"> 
span.small {
  font-size: 90%
}
span.tiny {
  font-size: 50%
}
</style><style type="text/css"> 
div.mathjax {
  padding-top: .5em;
  padding-bottom: .5em;
}
</style></head><body><div class="container"><h2 data-command-name="section" id="9_2_Криптосистема_Эль_Гамаля">9.2. Криптосистема Эль-Гамаля</h2><p><a name="N92379"><!--криптосистема!Эль-Гамаля|(--></a>
Эта система шифрования с открытым ключом опубликована в 1985 году Эль-Гамалем (англ. <span lang="en"><i>Taher El Gamal</i></span>, [<a href="Literatura.html#ElGamal:1984">35</a>, <a href="Literatura.html#ElGamal:1985">36</a>]). Рассмотрим принципы её построения.</p><p>Пусть имеется мультипликативная группа <span class="mathjax">${{\mathbb{Z}}}_p^* = \{1, 2, \dots, p-1\}$</span>, где <span class="mathjax">$p$</span> &ndash; большое простое<a name="N92410"><!--число!простое--></a> число</p><command name="footnote"><argument required="true">В оригинальной статье автор требует, чтобы число <span class="mathjax">$p$</span> содержало как минимум один достаточно большой простой множитель.</argument></command><p>, содержащее не менее 1024 двоичных разрядов. В группе <span class="mathjax">${{\mathbb{Z}}}_p^*$</span> существует <span class="mathjax">$\varphi( \varphi( p ) ) = \varphi( p - 1 )$</span> элементов, которые порождают все элементы группы. Такие элементы называются генераторами</p><command name="footnote"><argument required="true">Подробнее см. раздел<span class="nonbreaking-interword-space"> </span><a href="#section-groups">16.3</a> в приложении.</argument></command><p>.</p><p>Выберем один из таких генераторов <span class="mathjax">$g$</span> и целое число <span class="mathjax">$x$</span> в интервале <span class="mathjax">$1 &lt; x &lt; p-1$</span>. Вычислим:</p><div class="mathjax" style="text-align: center;">$$ y = g^x \mod p. $$</div><p>Хотя элементы <span class="mathjax">$x$</span> и <span class="mathjax">$y$</span> группы <span class="mathjax">${{\mathbb{Z}}}_p^*$</span> задают друг друга однозначно, найти <span class="mathjax">$y$</span>, зная <span class="mathjax">$x$</span>, просто, а вот эффективный алгоритм для получения <span class="mathjax">$x$</span> по заданному <span class="mathjax">$y$</span> неизвестен. Говорят, что задача вычисления дискретного логарифма</p><div class="mathjax" style="text-align: center;">$$ x = \log_g y \mod p $$</div><p>является вычислительно сложной. На сложности вычисления дискретного логарифма для больших простых <span class="mathjax">$p$</span> основывается криптосистема Эль-Гамаля.</p><h3 data-command-name="subsection" id="9_2_1_Шифрование">9.2.1. Шифрование</h3><p><a name="N92493"><!--шифр!Эль-Гамаля|(--></a>Процедура шифрования в криптосистеме Эль-Гамаля состоит из следующих операций.</p><ol><li><b>Создание пары из закрытого и открытого ключей стороной <span class="mathjax">$A$</span>.</b>
        <ol><li><span class="mathjax">$A$</span> выбирает простое<a name="N92515"><!--число!простое--></a> случайное число <span class="mathjax">$p$</span>.</li><li>Выбирает генератор <span class="mathjax">$g$</span> (в программных реализациях алгоритма генератор часто выбирается малым числом, например, <span class="mathjax">$g = 2 \mod p$</span>).</li><li>Выбирает <span class="mathjax">$x \in (1, p - 1)$</span> с помощью генератора случайных чисел.</li><li>Вычисляет <span class="mathjax">$y=g^{x}\mod p$</span>.</li><li>Создаёт закрытый и открытый ключи <span class="mathjax">${\textrm{SK}}$</span> и <span class="mathjax">${\textrm{PK}}$</span>:
                <div class="mathjax" style="text-align: center;">$$ {\textrm{SK}}= (p, g, x), ~ {\textrm{PK}}= (p, g, y). $$</div>
                Криптостойкость задаётся битовой длиной параметра <span class="mathjax">$p$</span>.</li></ol></li><li><b>Шифрование на открытом ключе стороной <span class="mathjax">$B$</span>.</b>
        <ol><li>Стороне <span class="mathjax">$B$</span> известен открытый ключ <span class="mathjax">$\text{PK} = (p, g, y)$</span> стороны <span class="mathjax">$A$</span>.</li><li>Сообщение представляется числом <span class="mathjax">$m \in [0, p-1]$</span>.</li><li>Сторона <span class="mathjax">$B$</span> выбирает случайное число <span class="mathjax">$r \in (1, p-1)$</span> и вычисляет:
                <div class="mathjax" style="text-align: center;">$$ \begin{array}{l}
                    a = g^r \mod p, \\
                    b = m \cdot y^r \mod p.
                \end{array} $$</div></li><li>Создаёт шифрованное сообщение в виде
                <div class="mathjax" style="text-align: center;">$$ c = (a, b) $$</div>
                и посылает стороне <span class="mathjax">$A$</span>.</li></ol></li><li><b>Расшифрование на закрытом ключе стороной <span class="mathjax">$A$</span>.</b>

	Получив сообщение <span class="mathjax">$(a, b)$</span> и владея закрытым ключом <span class="mathjax">$\text{SK} = (p, g, x)$</span>, <span class="mathjax">$A$</span> вычисляет:
                <div class="mathjax" style="text-align: center;">$$ m = \frac{b}{a^x} \mod p. $$</div></li></ol><p>Шифрование корректно, так как</p><div class="mathjax" style="text-align: center;">$$ \begin{array}{l}
    m' = \frac{b}{a^x} = \frac{m y^r}{g^{rx}} = m \mod p, \\
    m' \equiv m \mod p.
\end{array} $$</div><p>Чтобы криптоаналитику получить исходное сообщение <span class="mathjax">$m$</span> из шифртекста <span class="mathjax">$(a, b)$</span>, зная только открытый ключ получателя <span class="mathjax">$\text{PK} = (p, g, y)$</span>, нужно вычислить значение <span class="mathjax">$m = b \cdot y^{-r} \mod p$</span>. Для этого криптоаналитику нужно найти случайный параметр <span class="mathjax">$r = \log_g a \mod p$</span>, то есть вычислить дискретный логарифм. Такая задача является вычислительно сложной.</p><p><span style="font-variant: small-caps;"><b>Пример.</b></span> Создание ключей, шифрование и расшифрование в криптосистеме Эль-Гамаля.</p><ol><li>Генерация параметров.
        <ol><li>Выберем <span class="mathjax">$p=41$</span>.</li><li>Группа <span class="mathjax">${{\mathbb{Z}}}_p^*$</span> циклическая, найдём генератор (примитивный элемент). Порядок группы
                <div class="mathjax" style="text-align: center;">$$ |{{\mathbb{Z}}}_p^*| = \varphi(p) = p-1 = 40. $$</div>
                Делители 40: 1, 2, 4, 5, 8, 10, 20. Элемент группы является примитивным, если все его степени, соответствующие делителям порядка группы, не сравнимы с 1. Из таблицы<span class="nonbreaking-interword-space"> </span><a href="#tab:elgamal-generator-search">[tab:elgamal-generator-search]</a> видно, что число <span class="mathjax">$g = 6$</span> является генератором всей группы.
                <figure style="margin-left: auto; margin-right: auto; display: flex; flex-wrap: wrap; align-items: baseline; justify-content: center; width: fit-content; height: fit-content; "> <table style="border-collapse: collapse;"><colgroup><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"></colgroup><tr style="border-bottom: solid thin;border-top: solid thin;"><td rowspan="2" style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">Элемент</td><td colspan="7" style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">Степени</td><td rowspan="2" style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">Порядок элемента</td></tr><tr style="border-bottom: solid thin;border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$2$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$5$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$8$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$10$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$20$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$40$</span></td></tr><tr style="border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="rule"><argument required="true">0pt</argument><argument required="true">2.5ex</argument></command><span class="mathjax">$2$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$4$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$16$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$-9$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$10$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$-1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$20$</span></td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$3 $</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$9$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$-1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$-3$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$8$</span></td></tr><tr style=""><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$5 $</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$-16$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$10$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$9$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$18$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$-1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$20$</span></td></tr><tr style="border-bottom: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$ 6 $</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$-5$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$-16$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$-14$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$10$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$-9$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$-1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$40$</span></td></tr></table> <figcaption style="flex-basis: 100%; text-align: center;">Таблица 9.2 &mdash; Поиск генератора в циклической группе <span class="mathjax">${{\mathbb{Z}}}_{41}^*$</span>. Элемент 6 &ndash; генератор<a name="#tab:elgamal-generator-search"></a></figcaption></figure></li><li>Выберем случайное <span class="mathjax">$x = 19 \in [0, p-1]$</span>.</li><li>Вычислим
                <div class="mathjax" style="text-align: center;">$$ \begin{array}{ll}
                    y &amp; = g^x \mod p = \\
                    &amp; = 6^{19} \mod 41 = \\
                    &amp; = 6^{1 + 2 + 4 \cdot 0 + 8 \cdot 0 + 16} \mod 41 = \\
                    &amp; = 6^1 \cdot 6^2 \cdot 6^{4 \cdot 0} \cdot 6^{8 \cdot 0} \cdot 6^{16} \mod 41 = \\
                    &amp; = 6 \cdot (-5) \cdot (-16)^0 \cdot 10^0 \cdot 18 \mod 41 = \\
                    &amp; = -7 \mod 41.
                \end{array} $$</div></li><li>Открытый и закрытый ключи:
                <div class="mathjax" style="text-align: center;">$$ {\textrm{PK}}= (p:41, g:6, y:-7), ~ {\textrm{SK}}= (p:41, g:6, x:19). $$</div></li></ol></li><li>Шифрование.
        <ol><li>Пусть сообщением является число <span class="mathjax">$m = 3 \in {{\mathbb{Z}}}_p^*$</span>.</li><li>Выберем случайное число <span class="mathjax">$r = 25 \in (1, p-1)$</span>.</li><li>Вычислим
                <div class="mathjax" style="text-align: center;">$$ \begin{array}{l}
                    a = g^r \mod p = 6^{25} \mod 41 = 14 \mod 41, \\
                    b = m y^r \mod p = 3 \cdot (-7)^{25} \mod 41 = -9 \mod 41.
                \end{array} $$</div></li><li>Шифртекстом является пара чисел
                <div class="mathjax" style="text-align: center;">$$ c = (a:14, ~ b:-9). $$</div></li></ol></li><li>Расшифрование.
        <ol><li>Пусть получен шифртекст
                <div class="mathjax" style="text-align: center;">$$ c = (a:14, ~ b:-9). $$</div></li><li>Вычислим открытый текст как
                <div class="mathjax" style="text-align: center;">$$ \begin{array}{ll}
                    m &amp; = \frac{b}{a^x} \mod p = \\
                    &amp; = -9 \cdot (14^{-1})^{19} \mod 41 = \\
                    &amp; = -9 \cdot 3^{19} \mod 41 = \\
                    &amp; = -9 \cdot (-14) \mod 41 = \\
                    &amp; = 3 \mod 41. \\
                \end{array} $$</div></li></ol></li></ol><p><a name="N92953"><!--шифр!Эль-Гамаля|)--></a></p><h3 data-command-name="subsection" id="9_2_2_Электронная_подпись">9.2.2. Электронная подпись</h3><p><a name="N92969"><!--электронная подпись!Эль-Гамаля|(--></a>Криптосистема Эль-Гамаля, как и криптосистема RSA<a name="N92975"><!--криптосистема!RSA--></a>, может быть использована для создания электронной подписи.</p><p>По-прежнему имеются два пользователя <span class="mathjax">$A$</span> и <span class="mathjax">$B$</span> и незащищённый канал связи между ними. Пользователь <span class="mathjax">$A$</span> хочет подписать своё открытое сообщение <span class="mathjax">$m$</span> для того, чтобы пользователь <span class="mathjax">$B$</span> мог убедиться, что именно <span class="mathjax">$A$</span> подписал сообщение.</p><p>Пусть <span class="mathjax">$A$</span> имеет закрытый ключ <span class="mathjax">${\textrm{SK}}= (p, g, x)$</span>, открытый ключ <span class="mathjax">${\textrm{PK}}= (p, g, y)$</span> (полученные так же, как и в системе шифрования Эль-Гамаля) и хочет подписать открытое сообщение. Обозначим подпись <span class="mathjax">$S(m)$</span>.</p><p>Для создания подписи <span class="mathjax">$S(m)$</span> пользователь <span class="mathjax">$A$</span> выполняет следующие операции:</p><ul><li>вычисляет значение криптографической хеш-функции <span class="mathjax">$h(m) \in [0,p-2]$</span> от своего открытого сообщения <span class="mathjax">$m$</span>;</li><li>выбирает случайное число <span class="mathjax">$r: ~ \gcd(r, p-1)=1$</span>;</li><li>используя закрытый ключ, вычисляет:
        <div class="mathjax" style="text-align: center;">$$ \begin{array}{l}
            a = g^r \mod p, \\
            b = \frac{h(m) - xa}{r} \mod (p-1); \\
        \end{array} $$</div></li><li>создаёт подпись в виде двух чисел
        <div class="mathjax" style="text-align: center;">$$ S(m) = (a, b) $$</div>
        и посылает сообщение с подписью <span class="mathjax">$(m, S(m))$</span>.</li></ul><p>Получив сообщение, <span class="mathjax">$B$</span> осуществляет проверку подписи, выполняя следующие операции:</p><ul><li>по известному сообщению <span class="mathjax">$m$</span> вычисляет значение хеш-функции <span class="mathjax">$h(m)$</span>;</li><li>вычисляет:
        <div class="mathjax" style="text-align: center;">$$ \begin{array}{l}
            f_1 = g^{h(m)} \mod p, \\
            f_2 = y^a a^b \mod p; \\
        \end{array} $$</div></li><li>сравнивает значения <span class="mathjax">$f_1$</span> и <span class="mathjax">$f_2$</span>; если
        <div class="mathjax" style="text-align: center;">$$ f_1 = f_2, $$</div>
        то подпись подлинная, в противном случае &ndash; фальсифицированная (или случайно испорченная).</li></ul><p>Покажем, что проверка подписи корректна. По малой теореме Ферма<a name="N93072"><!--теорема!Ферма малая--></a> получаем</p><div class="mathjax" style="text-align: center;">$$ \begin{array}{ll}
    f_1 &amp; = g^{h(m)} \mod p = \\
    &amp; \\
    &amp; = g^{h(m) \mod (p-1)} \mod p; \\
\end{array} $$</div><div class="mathjax" style="text-align: center;">$$ \begin{array}{ll}
    f_2 &amp; = y^a a^b \mod p = \\
    &amp; = \underbrace{\left( g^x \right)^a}_{y^a} \cdot
        \underbrace{\left( g^r \mod p \right)^{\frac{h(m) - xa}{r} \mod (p-1)}}_{a^b} \mod p = \\
    &amp; \\
    &amp; = g^{xa \mod (p-1)} ~\cdot~ g^{h(m) - xa \mod (p-1)} \mod p = \\
    &amp; = g^{h(m) \mod (p-1)} \mod p = \\
    &amp; = f_1.
\end{array} $$</div><p><span style="font-variant: small-caps;"><b>Пример.</b></span> Создание и валидация электронной подписи в криптосистеме Эль-Гамаля.</p><ol><li>Генерирование параметров.
        <ol><li>Выберем <span class="mathjax">$p=41$</span>.</li><li>Выберем генератор <span class="mathjax">$g=6$</span> в группе <span class="mathjax">${{\mathbb{Z}}}_{41}^*$</span>.</li><li>Выберем случайное <span class="mathjax">$x = 19 \in (1, p-1)$</span>.<!--%, ~ \gcd(x, p-1) = 1$.--></li><li>Вычислим
                <div class="mathjax" style="text-align: center;">$$ \begin{array}{ll}
                    y &amp; = g^x \mod p = \\
                    &amp; = 6^{19} \mod 41 = \\
                    &amp; = 6^{1 + 2 + 4 \cdot 0 + 8 \cdot 0 + 16} \mod 41 = \\
                    &amp; = 6 \cdot (-5) \cdot (-16)^0 \cdot 10^0 \cdot 18 \mod 41 = \\
                    &amp; = -7 \mod 41. \\
                \end{array} $$</div></li><li>Открытый и закрытый ключи:
                <div class="mathjax" style="text-align: center;">$$ {\textrm{PK}}= (p:41, g:6, y:-7), ~ {\textrm{SK}}= (p:41, g:6, x:19). $$</div></li></ol></li><li>Подписание.
        <ol><li>От сообщения <span class="mathjax">$m$</span> вычисляется хеш <span class="mathjax">$h = H(m)$</span>. Пусть хеш <span class="mathjax">$h  = 3 \in [0, p-2]$</span>.</li><li>Выберем случайное <span class="mathjax">$r = 9 \in [1, p-2]$</span>: <line-break></line-break>
                <span class="mathjax">$\gcd(r=9, p-1 = 40) = 1$</span>.</li><li>Вычислим
                <div class="mathjax" style="text-align: center;">$$ \begin{array}{ll}
                    a &amp; = g^r \mod p = \\
                      &amp; = 6^9 \mod 41 = 19 \mod 41, \\
                    b &amp; = \frac{h - xa}{r} \mod (p-1) = \\
                      &amp; = (3 - 19 \cdot 19) \cdot 9^{-1} \mod 40 = \\
                      &amp; = 2 \cdot 9 \mod 40 = 18 \mod 40. \\
                \end{array} $$</div></li><li>Подпись
                <div class="mathjax" style="text-align: center;">$$ s = (a:19, b:18). $$</div></li></ol></li><li>Проверка подписи.
        <ol><li>Для полученного сообщения находится хеш <span class="mathjax">$h = H(m) = 3$</span>. Пусть полученная подпись к нему имеет вид
                <div class="mathjax" style="text-align: center;">$$ s = (a:19, b:18). $$</div></li><li>Вычислим
                <div class="mathjax" style="text-align: center;">$$ \begin{array}{ll}
                    f_1 &amp; = g^h \mod p = \\
                        &amp; = 6^3 \mod 41 = 11 \mod 41, \\
                    f_2 &amp; = y^a a^b \mod p = \\
                        &amp; = (-7)^{19} \cdot 19^{18} \mod 41 = 11 \mod 41. \\
                \end{array} $$</div></li><li>Проверим равенство <span class="mathjax">$f_1$</span> и <span class="mathjax">$f_2$</span>. Подпись верна, так как
                <div class="mathjax" style="text-align: center;">$$ f_1 = f_2 = 11. $$</div></li></ol></li></ol><p><a name="N93182"><!--электронная подпись!Эль-Гамаля|)--></a></p><h3 data-command-name="subsection" id="9_2_3_Криптостойкость">9.2.3. Криптостойкость</h3><p>Пусть дано уравнение <span class="mathjax">$y=g^{x} \mod p$</span>, требуется определить <span class="mathjax">$x$</span> в интервале <span class="mathjax">$0 &lt; x &lt; p-1$</span>. Задача называется <em>дискретным логарифмированием</em><a name="N93213"><!--задача!дискретного логарифмирования--></a>.</p><p>Рассмотрим возможные способы нахождения неизвестного числа <span class="mathjax">$x$</span>. Начнём с перебора различных значений <span class="mathjax">$x$</span> из интервала <span class="mathjax">$0&lt;x&lt;p-1$</span> и проверки равенства <span class="mathjax">$y=g^{x} \mod p$</span>. Число попыток в среднем равно <span class="mathjax">$\frac{p}{2}$</span>, при <span class="mathjax">$p=2^{1024}$</span> это число равно <span class="mathjax">$2^{1023}$</span>, что на практике неосуществимо.</p><p><a name="N93240"><!--алгоритм!Гельфонда—Шенкса|(--></a>Другой подход предложен советским математиком Гельфондом в 1962 году безотносительно к криптографии. Он состоит в следующем.
Вычислим <span class="mathjax">$S=\left\lceil\sqrt{p-1}\right\rceil $</span>, где скобки означают наименьшее целое, которое не меньше <span class="mathjax">$\sqrt{p-1} $</span>.</p><p>Представим искомое число <span class="mathjax">$x$</span> в следующем виде:</p><command name="equation"><argument required="true">equation</argument><content>
    x=x_1 S+x_2,
    <a name="#S"></a>
</content></command><p>где <span class="mathjax">$x_{1}$</span> и <span class="mathjax">$x_{2}$</span> &ndash; целые неотрицательные числа,</p><div class="mathjax" style="text-align: center;">$$ x_{1} \leq S-1, ~ x_{2} \leq S-1. $$</div><p>Такое представление является однозначным.</p><p>Вычислим и занесём в таблицу следующие <span class="mathjax">$S$</span> чисел:</p><div class="mathjax" style="text-align: center;">$$ g^{0} \mod p, ~~ g^{1} \mod p, ~~ g^{2} \mod p, ~~ \dots, ~~ g^{S-1} \mod p. $$</div><p>Вычислим <span class="mathjax">$g^{-S} \mod p$</span> и также занесём в таблицу.</p><div style="display: flex; align-items: center; justify-content: center;"> <table style="border-collapse: collapse;"><colgroup><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"><col style="border-left: solid thin;border-right: solid thin;"></colgroup><tr style="border-bottom: solid thin;border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: left;white-space: nowrap;"><span class="mathjax">$\lambda $</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">0</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">1</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;">2</td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="dots"></command></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$S-1$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$-S$</span></td></tr><tr style="border-bottom: solid thin;border-top: solid thin;"><td style="padding-left: 6pt;padding-right: 6pt;text-align: left;white-space: nowrap;"><span class="mathjax">$g^{\lambda} \mod p$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$g^{0}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$g^{1}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$g^{2}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><command name="dots"></command></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$g^{S-1}$</span></td><td style="padding-left: 6pt;padding-right: 6pt;text-align: center;white-space: nowrap;"><span class="mathjax">$g^{-S}$</span></td></tr></table> </div><p>Для решения уравнения<span class="nonbreaking-interword-space"> </span><a href="#S">[S]</a> используем перебор значений <span class="mathjax">$x_{1}$</span>.</p><ol><li>Предположим, что <span class="mathjax">$x_{1} = 0$</span>. Тогда <span class="mathjax">$x = x_{2}$</span>. Если число <span class="mathjax">$y = g^{x_{2}} \mod p$</span> содержится в таблице, то находим его и выдаём результат: <span class="mathjax">$x=x_{2} $</span>. Задача решена. В противном случае переходим к пункту 2.</li><li>Предположим, что <span class="mathjax">$x_{1} =1$</span>. Тогда <span class="mathjax">$x=S+x_{2} $</span> и <span class="mathjax">$y=g^{S+x_{2}} \mod p$</span>. Вычисляем <span class="mathjax">$yg^{-S} \mod p=g^{x_{2}} \mod p$</span>. Задача сведена к предыдущей: если <span class="mathjax">$g^{x_{2} } \mod p$</span> содержится в таблице, то в таблице находим число <span class="mathjax">$x_{2} $</span> и выдаём результат <span class="mathjax">$x$</span>: <span class="mathjax">$x=S+x_{2} $</span>.</li><li>Предположим, что <span class="mathjax">$x_{1} =2$</span>. Тогда <span class="mathjax">$x=2S+x_{2} $</span> и <span class="mathjax">$y=g^{2S+x_{2} } \mod p$</span>. Если число <span class="mathjax">$yg^{-2S} \mod p=g^{x_{2} } \mod p$</span> содержится в таблице, то находим число <span class="mathjax">$x_{2}$</span> и выдаём результат: <span class="mathjax">$x = 2S + x_{2}$</span>.</li><li>Пробегая все возможные значения, доберёмся в худшем случае до <span class="mathjax">$x_{1} =S-1$</span>. Тогда <span class="mathjax">$x=(S-1)S+x_{2} $</span> и <span class="mathjax">$y = g^{(S-1)S+x_{2} } \mod p$</span>. Если число <span class="mathjax">$yg^{-(S-1)S} \mod p=g^{x_{2}} \mod p$</span> содержится в таблице, то находим его и выдаём результат: <span class="mathjax">$x=(S-1)S+x_{2}$</span>.</li></ol><p>Легко убедиться в том, что с помощью построенной таблицы мы проверили все возможные значения <span class="mathjax">$x$</span>. Максимальное число умножений равно <span class="mathjax">$2S \approx 2\sqrt{p-1} =2\times 2^{512} $</span>, что для практики очень велико. Тем самым проблему достаточной криптостойкости этой системы можно было бы считать решённой. Однако это неверно, так как числа <span class="mathjax">$p-1$</span> являются составными. Если <span class="mathjax">$p-1$</span> можно разложить на маленькие множители, то криптоаналитик может применить процедуру, подобную процедуре Гельфонда, по взаимно простым делителям <span class="mathjax">$p-1$</span> и найти секрет. Пусть <span class="mathjax">$p-1=st$</span>. Тогда элемент <span class="mathjax">$g^s$</span> образует подгруппу порядка <span class="mathjax">$t$</span> и наоборот. Теперь, решая уравнение <span class="mathjax">$y^s=(g^s)^a\mod p$</span>, находим вычет <span class="mathjax">$x=a\mod t$</span>. Поступая аналогично, находим <span class="mathjax">$x=b\mod s$</span> и по китайской теореме об остатках<a name="N93498"><!--теорема!китайская об остатках--></a> находим <span class="mathjax">$x$</span>.</p><p>Несколько позже подобный метод ускоренного решения уравнения<span class="nonbreaking-interword-space"> </span><a href="#S">[S]</a> был предложен американским математиком Шенксом (англ. <span lang="en"><i>Daniel Shanks</i></span>, <a href="Literatura.html#Shanks:1971">[94]</a>). Оба алгоритма в литературе можно встретить под названиями: алгоритм Гельфонда, алгоритм Шенкса или алгоритм Гельфонда<span class="nonbreaking-interword-space"> </span>&mdash;<span class="nonbreaking-interword-space"> </span>Шенкса.</p><p>Пусть <span class="mathjax">$k = \lceil \log_2 p \rceil$</span> &ndash; битовая длина числа <span class="mathjax">$p$</span>. Алгоритм Гельфонда имеет экспоненциальную сложность (число двоичных операций):</p><div class="mathjax" style="text-align: center;">$$ O\left(\sqrt{p}\right) = O\left(e^{\frac{1}{2} \frac{1}{\log_2 e} k}\right). $$</div><p><a name="N93544"><!--алгоритм!Гельфонда—Шенкса|)--></a>Наилучшие из известных алгоритмов решения задачи дискретного логарифмирования имеют экспоненциальную сложность порядка</p><div class="mathjax" style="text-align: center;">$$ O\left(e^{\sqrt{k}}\right). $$</div><p><a name="N93557"><!--криптосистема!Эль-Гамаля|)--></a></p><nav aria-label="Page navigation example"><ul class="pagination justify-content-center"><li class="page-item"><a class="page-link" href="9_1_Kriptosistema_RSA.html">&#129080; 9_1_Kriptosistema_RSA</a></li><li class="page-item"><a class="page-link" href="9_3_Ellipticheskie_krivie.html">9_3_Ellipticheskie_krivie &#129082;</a></li></ul></nav></div><script>
window.MathJax = {
  loader: {
    load: ['[tex]/tagformat'],
  },
  options: {
    processHtmlClass: 'mathjax'
  },
  tex: {
    packages: {
      '[+]': ['base', 'ams', 'physics', 'textcomp']
    },
    inlineMath: [['$', '$']],
  },
};
</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script async="yes" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></body></html>