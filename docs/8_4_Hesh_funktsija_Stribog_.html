<!DOCTYPE html SYSTEM "about:legacy-compat">
<html><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><style type="text/css"> 
div.toc-item-h2 {
  padding-left: 2em;
}
div.toc-item-h3 {
  padding-left: 4em;
}
div.toc-item-h4 {
  padding-left: 6em;
}
div.toc-item-h5 {
  padding-left: 8em;
}
div.toc-item-h6 {
  padding-left: 10em;
}
</style><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" rel="stylesheet"><style type="text/css"> 
span.small {
  font-size: 90%
}
span.tiny {
  font-size: 50%
}
</style><style type="text/css"> 
div.mathjax {
  padding-top: .5em;
  padding-bottom: .5em;
}
</style></head><body><div class="container"><h2 data-command-name="section" id="8_4_Хеш_функция_Стрибог_">8.4. Хеш-функция &laquo;Стрибог&raquo;</h2><p><a name="N88945"><!--хеш-функция!Стрибог|(--></a>
С 1 января 2013 года в России введён в действие обновлённый стандарт на криптографическую хеш-функцию ГОСТ<span class="nonbreaking-interword-space"> </span>Р<span class="nonbreaking-interword-space"> </span>34.11-2012 <a href="Literatura.html#GOST-R:34.11-2012">[120]</a>. Неофициально новый алгоритм получил название &laquo;Стрибог&raquo;. При разработке хеш-функции авторы основывались на нескольких требованиях:</p><ul><li>отсутствие уязвимостей к известным атакам;</li><li>использование только хорошо изученных конструкций и преобразований;</li><li>отсутствие лишних действий (каждое преобразование должно гарантировать выполнение определённых криптографических свойств);</li><li>при наличии нескольких вариантов реализации требуемого свойства &ndash; использование наиболее простого для анализа и реализации;</li><li>максимальная производительность <em>программной</em> реализации (процессоры архитектуры <tt>x64</tt>).</li></ul><p>В соответствии с данными требованиями алгоритм новой хеш-функции основывается на хорошо изученных конструкциях Меркла<span class="nonbreaking-interword-space"> </span>&mdash;<span class="nonbreaking-interword-space"> </span>Дамгора<a name="N88987"><!--структура!Меркла—Дамгора--></a> (см. раздел<span class="nonbreaking-interword-space"> </span><a href="#sec:merkle-damgard">8.1</a>) и Миагучи<span class="nonbreaking-interword-space"> </span>&mdash;<span class="nonbreaking-interword-space"> </span>Пренеля<a name="N89008"><!--структура!Миагучи—Пренеля--></a><span class="nonbreaking-interword-space"> </span>[<a href="Literatura.html#Miyaguchi:Ohta:Iwata:1990:03">77</a>, <a href="Literatura.html#Miyaguchi:Ohta:Iwata:1990:11">78</a>, <a href="Literatura.html#Espen:Mieghem:1989">105</a>], во внешней своей структуре практически полностью повторяя режим HAIFA<a name="N89026"><!--HAIFA--></a> (англ. <span lang="en"><i>HAsh Iterative FrAmework</i></span>,<span class="nonbreaking-interword-space"> </span><a href="Literatura.html#Biham:Dunkelman:2007">[13]</a>), использовавшийся в хеш-функциях SHAvite-3<a name="N89050"><!--хеш-функция!SHAvite-3--></a> и BLAKE<a name="N89056"><!--хеш-функция!BLAKE--></a>.</p><figure style="margin-left: auto; margin-right: auto; display: flex; flex-wrap: wrap; align-items: baseline; justify-content: center; width: fit-content; height: fit-content; width: 95%;"><a name="fig:stribog-md" style="vertical-align: top; align-self: start;"></a><img src="images/14D00E3E402EE80D316AE713B509C43B.png" style="width: 100%"><figcaption style="flex-basis: 100%; text-align: center;">Рис. 8.8 &mdash; Использование структуры Меркла<span class="nonbreaking-interword-space"> </span>&mdash;<span class="nonbreaking-interword-space"> </span>Дамгора в хеш-функции &laquo;Стрибог&raquo;</figcaption></figure><p>Как показано на рис.<span class="nonbreaking-interword-space"> </span><a href="8_4_Hesh_funktsija_Stribog_.html#fig:stribog-md">8.8</a>, входное сообщение разбивается на блоки по 512 бит (64 байта). Последний блок <em>слева</em> дополняется последовательностью из нулей и  одной единицы до 512 бит (длина дополнения не учитывается в дальнейшем, когда длина сообщения используется как аргумент функций). Для каждой части сообщения вычисляется значение функции <span class="mathjax">$g_N(h, m)$</span>, которая в качестве аргумента использует текущий номер блока (умноженный на 512), результат вычисления для предыдущего блока и очередной блок сообщения. Также есть два завершающих преобразования. Первое вместо блока сообщения использует количество обработанных бит N (то есть длину сообщения), а второе &ndash; арифметическую сумму значений всех блоков сообщения. В предположении, что функция <span class="mathjax">$g_N(h, m)$</span> является надёжной для создания криптографически стойких хеш-функций, известно, что конструкция Меркла<span class="nonbreaking-interword-space"> </span>&mdash;<span class="nonbreaking-interword-space"> </span>Дамгора позволяет получить хеш-функцию со следующими параметрами:</p><ul><li>сложность построения прообраза: <span class="mathjax">$2^n$</span> операций;</li><li>сложность построения второго прообраза: <span class="mathjax">$2^n / \left|M\right|$</span> операций;</li><li>сложность построения коллизии: <span class="mathjax">$2^{n/2}$</span> операций;</li><li>сложность удлинения прообраза: <span class="mathjax">$2^n$</span> операций.</li></ul><p>Все параметры совпадают с аналогичными для идеальной хеш-функции, кроме сложности построения второго прообраза, который равен <span class="mathjax">$2^n$</span> для идеального алгоритма.</p><p>В качестве функции <span class="mathjax">$g_N(h, m)$</span> используется конструкция Миагучи<span class="nonbreaking-interword-space"> </span>&mdash;<span class="nonbreaking-interword-space"> </span>Пренеля<a name="N89150"><!--структура!Миагучи—Пренеля--></a> (см. рис.<span class="nonbreaking-interword-space"> </span><a href="8_4_Hesh_funktsija_Stribog_.html#fig:stribog-mp">8.9</a>), которая является стойкой ко всем атакам, известным для схем однонаправленных хеш-функций на базе симметричных алгоритмов, в том числе к атаке с &laquo;фиксированной точкой&raquo;<span class="nonbreaking-interword-space"> </span><a href="Literatura.html#Schneier:2002">[135]</a>. <em>Фиксированной точкой</em><a name="N89177"><!--точка!фиксированная--></a> называется пара чисел <span class="mathjax">$(h, m)$</span>, для которой у заданной функции <span class="mathjax">$g$</span> выполняется <span class="mathjax">$g(h, m) = h$</span>.</p><figure style="margin-left: auto; margin-right: auto; display: flex; flex-wrap: wrap; align-items: baseline; justify-content: center; width: fit-content; height: fit-content; width: 66%;"><a name="fig:stribog-mp" style="vertical-align: top; align-self: start;"></a><img src="images/DE1504B4F2BDD34F3FC921D8E2CF91E6.png" style="width: 100%"><figcaption style="flex-basis: 100%; text-align: center;">Рис. 8.9 &mdash; Использование структуры Миагучи<span class="nonbreaking-interword-space"> </span>&mdash;<span class="nonbreaking-interword-space"> </span>Пренеля в хеш-функции &laquo;Стрибог&raquo;</figcaption></figure><p><a name="N89225"><!--шифр!XSPL|(--></a>В качестве блочного шифра используется новый XSPL-шифр, изображённый на рис.<span class="nonbreaking-interword-space"> </span><a href="8_4_Hesh_funktsija_Stribog_.html#fig:stribog-xspl">8.10</a>, отдельные элементы и идеи которого позже войдут в новый стандарт &laquo;Кузнечик&raquo;<a name="N89238"><!--шифр!Кузнечик--></a> (см. раздел<span class="nonbreaking-interword-space"> </span><a href="#section-grig">5.7</a>). Шифр является примером шифра на основе SP-сети<a name="N89251"><!--SP-сеть--></a> (сети замен и перестановок), каждый раунд которого является набором обратимых преобразований над входным блоком.</p><figure style="margin-left: auto; margin-right: auto; display: flex; flex-wrap: wrap; align-items: baseline; justify-content: center; width: fit-content; height: fit-content; width: 75%;"><a name="fig:stribog-xspl" style="vertical-align: top; align-self: start;"></a><img src="images/76038BB4EBBC7498FDCB8A1787477FAF.png" style="width: 100%"><figcaption style="flex-basis: 100%; text-align: center;">Рис. 8.10 &mdash; XSPL-шифр в хеш-функции &laquo;Стрибог&raquo;</figcaption></figure><p>Каждый раунд XSPL-шифра, кроме последнего, состоит из следующих обратимых преобразований:</p><ul><li><span class="mathjax">$X\left[C\right]$</span> &ndash; побитовое сложение по модулю 2 с дополнительным аргументом <span class="mathjax">$C$</span>;</li><li><span class="mathjax">$S$</span> &ndash; нелинейная обратимая замена байтов;</li><li><span class="mathjax">$P$</span> &ndash; перестановка байтов внутри блока данных (транспонирование матрицы размером <span class="mathjax">$8 \times 8$</span> из ячеек по одному байту каждая);</li><li><span class="mathjax">$L$</span> &ndash; обратимое линейное преобразование (умножение векторов на фиксированную матрицу).</li></ul><p>Особенностью предложенного шифра является полная аналогия между алгоритмом развёртывания ключа и алгоритмом, собственно, преобразования открытого текста. В качестве &laquo;раундовых ключей&raquo; для алгоритма развёртывания ключа на первом раунде используется общее число уже обработанных бит хеш-функцией N, а на остальных раундах &ndash; 512-битные константы, заданные в стандарте.<a name="N89310"><!--шифр!XSPL|)--></a>Новый алгоритм, согласно отдельным исследованиям, до полутора раз быстрее предыдущего стандарта ГОСТ Р 34.11-94<a name="N89316"><!--хеш-функция!ГОСТ Р 34.11-94--></a> за счет использоавния 27 тактов на один байт входного сообщения (94<span class="nonbreaking-interword-space"> </span>МиБ/с) против 40 для старого стандарта (64<span class="nonbreaking-interword-space"> </span>МиБ/с)</p><command name="footnote"></command><p>Реализации тестировались на процессоре Intel Core i7-920 CPU  2,67<span class="nonbreaking-interword-space"> </span>GHz и видеокарте NVIDIA GTX 580. См.<span class="nonbreaking-interword-space"> </span><a href="Literatura.html#Lebedev:2013">[58]</a>..</p><p>В 2014 году группа исследователей (<a href="Literatura.html#Guo:Jean:Leurent:Peyrin:Wang:2014">[100]</a>) обнаружила недостаток в реализации конструкции HAIFA в хеш-функции &laquo;Стрибог&raquo;, который ведёт к уменьшению сложности атаки по поиску второго прообраза до <span class="mathjax">$n \times 2^{n/2}$</span>, то есть до <span class="mathjax">$2^{266}$</span>. Авторы работы получили первую премию в размере пятисот тысяч рублей на конкурсе по исследованию хеш-функции &laquo;Стрибог&raquo;, проводившемся Российским Техническим комитетом по стандартизации &laquo;Криптографическая защита информации&raquo; (ТК<span class="nonbreaking-interword-space"> </span>26) при участии Академии криптографии Российской Федерации и при организационной и финансовой поддержке ОАО &laquo;ИнфоТеКС&raquo;.</p><p><a name="N89348"><!--хеш-функция!Стрибог|)--></a></p><nav aria-label="Page navigation example"><ul class="pagination justify-content-center"><li class="page-item"><a class="page-link" href="8_3_GOST_R_34_11_94.html">&#129080; 8_3_GOST_R_34_11_94</a></li><li class="page-item"><a class="page-link" href="8_5_Imitovstavka_MAC_.html">8_5_Imitovstavka_MAC_ &#129082;</a></li></ul></nav></div><script>
window.MathJax = {
  loader: {
    load: ['[tex]/tagformat'],
  },
  options: {
    processHtmlClass: 'mathjax'
  },
  tex: {
    packages: {
      '[+]': ['base', 'ams', 'physics', 'textcomp']
    },
    inlineMath: [['$', '$']],
  },
};
</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script async="yes" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></body></html>