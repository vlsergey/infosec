\section{russian}{Биграммные шифры замены}

Если при шифровании преобразуются по две буквы открытого текста, то такой шифр называется \textbf{биграммным} шифром замены. Первый биграммный шифр был изобретен аббатом Иоганном Трисемусом и опубликован в  1508 году. Другой биграммный шифр изобретен в 1854 году Чарльзом Витстоном.  Лорд Лайон Плейфер внедрил этот шифр в государственных службах Великобритании, и шифр был назван шифром Плейфера. Еще одним известным примером биграммного шифра замены является шифр  \textbf{Плейфера--Витстона}, который также был предназначен для дипломатической переписки.

Опишем процедуру шифрования Плейфера--Витстона. Заготавливается таблица для английского алфавита (буквы I, J отождествляются), в которую заносятся буквы перемешанного алфавита, например в виде таблицы, представленной ниже. Часто перемешивание алфавита реализуется с помощью начального слова. В нашем примере начальное слово $playfir$. Таблица имеет вид

\begin{center}
    \begin{tabular}{ccccc}
        p & l & a & y & f  \\
        i & r & b & c & d  \\
        e & g & h & k & m  \\
        n & o & q & s & t  \\
        u & v & w & x & z  \\
    \end{tabular}
\end{center}

Буквы открытого текста разбиваются на пары. Правила шифрования каждой пары состоят в следующем.

\begin{itemize}
    \item Если буквы пары не лежат в одной строке или в одном столбце таблицы, то они заменяются буквами, образующими с исходными буквами вершины прямоугольника. Первой букве пары соответствует буква таблицы, находящаяся в том же столбце. Пара букв открытого текста $we$ заменяется двумя буквами таблицы $hu$. Пара букв открытого текста $ew$ заменяется двумя буквами таблицы $uh$.
    \item Если буквы пары открытого текста расположены в одной строке таблицы, то каждая буква заменяется  соседней справа буквой таблицы. Например, пара $gk$  заменяется двумя буквами $hm$. Если одна из этих букв -- крайняя правая в таблице, то ее <<правым соседом>> считается крайняя левая в этой строке. Так, пара $to$ заменяется буквами $nq$.
    \item Если буквы пары лежат в одном столбце, то каждая буква заменяется  соседней буквой снизу. Например, пара $lo$ заменяется парой $rv$. Если одна из этих букв крайняя нижняя, то ее <<нижним соседом>> считается крайняя верхняя буква в этом столбце таблицы. Например, пара $kx$ заменяется буквами $sy$.
    \item Если буквы в паре одинаковые, то между ними вставляется определенная буква, называемая <<буквой-пустышкой>>. После этого разбиение на пары производится заново.
\end{itemize}

\example
Используем этот шифр и зашифруем сообщение <<Wheatstone was the inventor>> в первой строке таблицы. Получаем после разбиения этой фразы на пары шифрованный текст во второй строке:
\begin{center} \begin{tabular}{|cccccccccccc|}
    \hline
    wh & ea & ts & to & ne & wa & st & he & in & ve & nt & or \\
    \hline
    aq & ph & nt & nq & un & ab & tn & kg & eu & gu & on & vg \\
    \hline
\end{tabular} \end{center}
\exampleend

Шифр Плейфера--Витстона может быть  взломан. Несложно найти ключ, если известны как шифрованный, так и открытый тексты. Если известен только шифрованный текст, то криптоаналитик анализирует соответствие между частотой появления биграмм в шифрованном тексте и известной частотой появления биграмм в языке, на котором написано сообщение. Такой частотный анализ помогает дешифрованию.
